import{F as Li,d as ke,r as ie,x as ht,A as Ai,a as ae,c as pe,b as P,B as Dt,E as Ae,o as Ct,n as tt,G as wi,w as dt,y as ft,C as Tt,t as Ue,p as Mt,f as It,H as je,l as it,k as Pt,T as Bt,J as Ft,I as Ri,D as kt}from"./vendor.b393d787.js";import{U as Ut,R as Oi,_ as jt,L as Di}from"./index.800d8c56.js";var Nt={exports:{}};(function(y,s){(function(f,A){y.exports=A()})(self,function(){return function(){var _={"./node_modules/es6-promise/dist/es6-promise.js":function(x,g,m){/*!
 * @overview es6-promise - a tiny implementation of Promises/A+.
 * @copyright Copyright (c) 2014 Yehuda Katz, Tom Dale, Stefan Penner and contributors (Conversion to ES6 API by Jake Archibald)
 * @license   Licensed under MIT license
 *            See https://raw.githubusercontent.com/stefanpenner/es6-promise/master/LICENSE
 * @version   v4.2.8+1e68dce6
 */(function(E,l){x.exports=l()})(this,function(){function E(T){var B=typeof T;return T!==null&&(B==="object"||B==="function")}function l(T){return typeof T=="function"}var e=void 0;Array.isArray?e=Array.isArray:e=function(T){return Object.prototype.toString.call(T)==="[object Array]"};var t=e,p=0,n=void 0,d=void 0,c=function(B,F){R[p]=B,R[p+1]=F,p+=2,p===2&&(d?d(C):M())};function a(T){d=T}function r(T){c=T}var h=typeof window!="undefined"?window:void 0,u=h||{},i=u.MutationObserver||u.WebKitMutationObserver,o=typeof self=="undefined"&&typeof process!="undefined"&&{}.toString.call(process)==="[object process]",v=typeof Uint8ClampedArray!="undefined"&&typeof importScripts!="undefined"&&typeof MessageChannel!="undefined";function b(){return function(){return process.nextTick(C)}}function w(){return typeof n!="undefined"?function(){n(C)}:L()}function D(){var T=0,B=new i(C),F=document.createTextNode("");return B.observe(F,{characterData:!0}),function(){F.data=T=++T%2}}function O(){var T=new MessageChannel;return T.port1.onmessage=C,function(){return T.port2.postMessage(0)}}function L(){var T=setTimeout;return function(){return T(C,1)}}var R=new Array(1e3);function C(){for(var T=0;T<p;T+=2){var B=R[T],F=R[T+1];B(F),R[T]=void 0,R[T+1]=void 0}p=0}function I(){try{var T=Function("return this")().require("vertx");return n=T.runOnLoop||T.runOnContext,w()}catch{return L()}}var M=void 0;o?M=b():i?M=D():v?M=O():h===void 0?M=I():M=L();function k(T,B){var F=this,U=new this.constructor(N);U[G]===void 0&&Be(U);var K=F._state;if(K){var z=arguments[K-1];c(function(){return De(K,U,z,F._result)})}else de(F,U,T,B);return U}function V(T){var B=this;if(T&&typeof T=="object"&&T.constructor===B)return T;var F=new B(N);return he(F,T),F}var G=Math.random().toString(36).substring(2);function N(){}var H=void 0,$=1,j=2;function Y(){return new TypeError("You cannot resolve a promise with itself")}function fe(){return new TypeError("A promises callback cannot return that same promise.")}function Q(T,B,F,U){try{T.call(B,F,U)}catch(K){return K}}function Z(T,B,F){c(function(U){var K=!1,z=Q(F,B,function(re){K||(K=!0,B!==re?he(U,re):J(U,re))},function(re){K||(K=!0,W(U,re))},"Settle: "+(U._label||" unknown promise"));!K&&z&&(K=!0,W(U,z))},T)}function ce(T,B){B._state===$?J(T,B._result):B._state===j?W(T,B._result):de(B,void 0,function(F){return he(T,F)},function(F){return W(T,F)})}function se(T,B,F){B.constructor===T.constructor&&F===k&&B.constructor.resolve===V?ce(T,B):F===void 0?J(T,B):l(F)?Z(T,B,F):J(T,B)}function he(T,B){if(T===B)W(T,Y());else if(E(B)){var F=void 0;try{F=B.then}catch(U){W(T,U);return}se(T,B,F)}else J(T,B)}function be(T){T._onerror&&T._onerror(T._result),ge(T)}function J(T,B){T._state===H&&(T._result=B,T._state=$,T._subscribers.length!==0&&c(ge,T))}function W(T,B){T._state===H&&(T._state=j,T._result=B,c(be,T))}function de(T,B,F,U){var K=T._subscribers,z=K.length;T._onerror=null,K[z]=B,K[z+$]=F,K[z+j]=U,z===0&&T._state&&c(ge,T)}function ge(T){var B=T._subscribers,F=T._state;if(B.length!==0){for(var U=void 0,K=void 0,z=T._result,re=0;re<B.length;re+=3)U=B[re],K=B[re+F],U?De(F,U,K,z):K(z);T._subscribers.length=0}}function De(T,B,F,U){var K=l(F),z=void 0,re=void 0,Fe=!0;if(K){try{z=F(U)}catch(et){Fe=!1,re=et}if(B===z){W(B,fe());return}}else z=U;B._state!==H||(K&&Fe?he(B,z):Fe===!1?W(B,re):T===$?J(B,z):T===j&&W(B,z))}function Se(T,B){try{B(function(U){he(T,U)},function(U){W(T,U)})}catch(F){W(T,F)}}var Le=0;function Pe(){return Le++}function Be(T){T[G]=Le++,T._state=void 0,T._result=void 0,T._subscribers=[]}function xe(){return new Error("Array Methods must be provided an Array")}var _e=function(){function T(B,F){this._instanceConstructor=B,this.promise=new B(N),this.promise[G]||Be(this.promise),t(F)?(this.length=F.length,this._remaining=F.length,this._result=new Array(this.length),this.length===0?J(this.promise,this._result):(this.length=this.length||0,this._enumerate(F),this._remaining===0&&J(this.promise,this._result))):W(this.promise,xe())}return T.prototype._enumerate=function(F){for(var U=0;this._state===H&&U<F.length;U++)this._eachEntry(F[U],U)},T.prototype._eachEntry=function(F,U){var K=this._instanceConstructor,z=K.resolve;if(z===V){var re=void 0,Fe=void 0,et=!1;try{re=F.then}catch(ut){et=!0,Fe=ut}if(re===k&&F._state!==H)this._settledAt(F._state,U,F._result);else if(typeof re!="function")this._remaining--,this._result[U]=F;else if(K===oe){var lt=new K(N);et?W(lt,Fe):se(lt,F,re),this._willSettleAt(lt,U)}else this._willSettleAt(new K(function(ut){return ut(F)}),U)}else this._willSettleAt(z(F),U)},T.prototype._settledAt=function(F,U,K){var z=this.promise;z._state===H&&(this._remaining--,F===j?W(z,K):this._result[U]=K),this._remaining===0&&J(z,this._result)},T.prototype._willSettleAt=function(F,U){var K=this;de(F,void 0,function(z){return K._settledAt($,U,z)},function(z){return K._settledAt(j,U,z)})},T}();function ze(T){return new _e(this,T).promise}function qe(T){var B=this;return t(T)?new B(function(F,U){for(var K=T.length,z=0;z<K;z++)B.resolve(T[z]).then(F,U)}):new B(function(F,U){return U(new TypeError("You must pass an array to race."))})}function Ei(T){var B=this,F=new B(N);return W(F,T),F}function yi(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function bi(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}var oe=function(){function T(B){this[G]=Pe(),this._result=this._state=void 0,this._subscribers=[],N!==B&&(typeof B!="function"&&yi(),this instanceof T?Se(this,B):bi())}return T.prototype.catch=function(F){return this.then(null,F)},T.prototype.finally=function(F){var U=this,K=U.constructor;return l(F)?U.then(function(z){return K.resolve(F()).then(function(){return z})},function(z){return K.resolve(F()).then(function(){throw z})}):U.then(F,F)},T}();oe.prototype.then=k,oe.all=ze,oe.race=qe,oe.resolve=V,oe.reject=Ei,oe._setScheduler=a,oe._setAsap=r,oe._asap=c;function Si(){var T=void 0;if(typeof m.g!="undefined")T=m.g;else if(typeof self!="undefined")T=self;else try{T=Function("return this")()}catch{throw new Error("polyfill failed because global object is unavailable in this environment")}var B=T.Promise;if(B){var F=null;try{F=Object.prototype.toString.call(B.resolve())}catch{}if(F==="[object Promise]"&&!B.cast)return}T.Promise=oe}return oe.polyfill=Si,oe.Promise=oe,oe})},"./node_modules/events/events.js":function(x){var g=typeof Reflect=="object"?Reflect:null,m=g&&typeof g.apply=="function"?g.apply:function(L,R,C){return Function.prototype.apply.call(L,R,C)},E;g&&typeof g.ownKeys=="function"?E=g.ownKeys:Object.getOwnPropertySymbols?E=function(L){return Object.getOwnPropertyNames(L).concat(Object.getOwnPropertySymbols(L))}:E=function(L){return Object.getOwnPropertyNames(L)};function l(O){console&&console.warn&&console.warn(O)}var e=Number.isNaN||function(L){return L!==L};function t(){t.init.call(this)}x.exports=t,x.exports.once=b,t.EventEmitter=t,t.prototype._events=void 0,t.prototype._eventsCount=0,t.prototype._maxListeners=void 0;var p=10;function n(O){if(typeof O!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof O)}Object.defineProperty(t,"defaultMaxListeners",{enumerable:!0,get:function(){return p},set:function(O){if(typeof O!="number"||O<0||e(O))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+O+".");p=O}}),t.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},t.prototype.setMaxListeners=function(L){if(typeof L!="number"||L<0||e(L))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+L+".");return this._maxListeners=L,this};function d(O){return O._maxListeners===void 0?t.defaultMaxListeners:O._maxListeners}t.prototype.getMaxListeners=function(){return d(this)},t.prototype.emit=function(L){for(var R=[],C=1;C<arguments.length;C++)R.push(arguments[C]);var I=L==="error",M=this._events;if(M!==void 0)I=I&&M.error===void 0;else if(!I)return!1;if(I){var k;if(R.length>0&&(k=R[0]),k instanceof Error)throw k;var V=new Error("Unhandled error."+(k?" ("+k.message+")":""));throw V.context=k,V}var G=M[L];if(G===void 0)return!1;if(typeof G=="function")m(G,this,R);else for(var N=G.length,H=i(G,N),C=0;C<N;++C)m(H[C],this,R);return!0};function c(O,L,R,C){var I,M,k;if(n(R),M=O._events,M===void 0?(M=O._events=Object.create(null),O._eventsCount=0):(M.newListener!==void 0&&(O.emit("newListener",L,R.listener?R.listener:R),M=O._events),k=M[L]),k===void 0)k=M[L]=R,++O._eventsCount;else if(typeof k=="function"?k=M[L]=C?[R,k]:[k,R]:C?k.unshift(R):k.push(R),I=d(O),I>0&&k.length>I&&!k.warned){k.warned=!0;var V=new Error("Possible EventEmitter memory leak detected. "+k.length+" "+String(L)+" listeners added. Use emitter.setMaxListeners() to increase limit");V.name="MaxListenersExceededWarning",V.emitter=O,V.type=L,V.count=k.length,l(V)}return O}t.prototype.addListener=function(L,R){return c(this,L,R,!1)},t.prototype.on=t.prototype.addListener,t.prototype.prependListener=function(L,R){return c(this,L,R,!0)};function a(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function r(O,L,R){var C={fired:!1,wrapFn:void 0,target:O,type:L,listener:R},I=a.bind(C);return I.listener=R,C.wrapFn=I,I}t.prototype.once=function(L,R){return n(R),this.on(L,r(this,L,R)),this},t.prototype.prependOnceListener=function(L,R){return n(R),this.prependListener(L,r(this,L,R)),this},t.prototype.removeListener=function(L,R){var C,I,M,k,V;if(n(R),I=this._events,I===void 0)return this;if(C=I[L],C===void 0)return this;if(C===R||C.listener===R)--this._eventsCount==0?this._events=Object.create(null):(delete I[L],I.removeListener&&this.emit("removeListener",L,C.listener||R));else if(typeof C!="function"){for(M=-1,k=C.length-1;k>=0;k--)if(C[k]===R||C[k].listener===R){V=C[k].listener,M=k;break}if(M<0)return this;M===0?C.shift():o(C,M),C.length===1&&(I[L]=C[0]),I.removeListener!==void 0&&this.emit("removeListener",L,V||R)}return this},t.prototype.off=t.prototype.removeListener,t.prototype.removeAllListeners=function(L){var R,C,I;if(C=this._events,C===void 0)return this;if(C.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):C[L]!==void 0&&(--this._eventsCount==0?this._events=Object.create(null):delete C[L]),this;if(arguments.length===0){var M=Object.keys(C),k;for(I=0;I<M.length;++I)k=M[I],k!=="removeListener"&&this.removeAllListeners(k);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(R=C[L],typeof R=="function")this.removeListener(L,R);else if(R!==void 0)for(I=R.length-1;I>=0;I--)this.removeListener(L,R[I]);return this};function h(O,L,R){var C=O._events;if(C===void 0)return[];var I=C[L];return I===void 0?[]:typeof I=="function"?R?[I.listener||I]:[I]:R?v(I):i(I,I.length)}t.prototype.listeners=function(L){return h(this,L,!0)},t.prototype.rawListeners=function(L){return h(this,L,!1)},t.listenerCount=function(O,L){return typeof O.listenerCount=="function"?O.listenerCount(L):u.call(O,L)},t.prototype.listenerCount=u;function u(O){var L=this._events;if(L!==void 0){var R=L[O];if(typeof R=="function")return 1;if(R!==void 0)return R.length}return 0}t.prototype.eventNames=function(){return this._eventsCount>0?E(this._events):[]};function i(O,L){for(var R=new Array(L),C=0;C<L;++C)R[C]=O[C];return R}function o(O,L){for(;L+1<O.length;L++)O[L]=O[L+1];O.pop()}function v(O){for(var L=new Array(O.length),R=0;R<L.length;++R)L[R]=O[R].listener||O[R];return L}function b(O,L){return new Promise(function(R,C){function I(k){O.removeListener(L,M),C(k)}function M(){typeof O.removeListener=="function"&&O.removeListener("error",I),R([].slice.call(arguments))}D(O,L,M,{once:!0}),L!=="error"&&w(O,I,{once:!0})})}function w(O,L,R){typeof O.on=="function"&&D(O,"error",L,R)}function D(O,L,R,C){if(typeof O.on=="function")C.once?O.once(L,R):O.on(L,R);else if(typeof O.addEventListener=="function")O.addEventListener(L,function I(M){C.once&&O.removeEventListener(L,I),R(M)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof O)}},"./node_modules/webworkify-webpack/index.js":function(x,g,m){function E(a){var r={};function h(i){if(r[i])return r[i].exports;var o=r[i]={i,l:!1,exports:{}};return a[i].call(o.exports,o,o.exports,h),o.l=!0,o.exports}h.m=a,h.c=r,h.i=function(i){return i},h.d=function(i,o,v){h.o(i,o)||Object.defineProperty(i,o,{configurable:!1,enumerable:!0,get:v})},h.r=function(i){Object.defineProperty(i,"__esModule",{value:!0})},h.n=function(i){var o=i&&i.__esModule?function(){return i.default}:function(){return i};return h.d(o,"a",o),o},h.o=function(i,o){return Object.prototype.hasOwnProperty.call(i,o)},h.p="/",h.oe=function(i){throw console.error(i),i};var u=h(h.s=ENTRY_MODULE);return u.default||u}var l="[\\.|\\-|\\+|\\w|/|@]+",e="\\(\\s*(/\\*.*?\\*/)?\\s*.*?("+l+").*?\\)";function t(a){return(a+"").replace(/[.?*+^$[\]\\(){}|-]/g,"\\$&")}function p(a){return!isNaN(1*a)}function n(a,r,h){var u={};u[h]=[];var i=r.toString(),o=i.match(/^function\s?\w*\(\w+,\s*\w+,\s*(\w+)\)/);if(!o)return u;for(var v=o[1],b=new RegExp("(\\\\n|\\W)"+t(v)+e,"g"),w;w=b.exec(i);)w[3]!=="dll-reference"&&u[h].push(w[3]);for(b=new RegExp("\\("+t(v)+'\\("(dll-reference\\s('+l+'))"\\)\\)'+e,"g");w=b.exec(i);)a[w[2]]||(u[h].push(w[1]),a[w[2]]=m(w[1]).m),u[w[2]]=u[w[2]]||[],u[w[2]].push(w[4]);for(var D=Object.keys(u),O=0;O<D.length;O++)for(var L=0;L<u[D[O]].length;L++)p(u[D[O]][L])&&(u[D[O]][L]=1*u[D[O]][L]);return u}function d(a){var r=Object.keys(a);return r.reduce(function(h,u){return h||a[u].length>0},!1)}function c(a,r){for(var h={main:[r]},u={main:[]},i={main:{}};d(h);)for(var o=Object.keys(h),v=0;v<o.length;v++){var b=o[v],w=h[b],D=w.pop();if(i[b]=i[b]||{},!(i[b][D]||!a[b][D])){i[b][D]=!0,u[b]=u[b]||[],u[b].push(D);for(var O=n(a,a[b][D],b),L=Object.keys(O),R=0;R<L.length;R++)h[L[R]]=h[L[R]]||[],h[L[R]]=h[L[R]].concat(O[L[R]])}}return u}x.exports=function(a,r){r=r||{};var h={main:m.m},u=r.all?{main:Object.keys(h.main)}:c(h,a),i="";Object.keys(u).filter(function(D){return D!=="main"}).forEach(function(D){for(var O=0;u[D][O];)O++;u[D].push(O),h[D][O]="(function(module, exports, __webpack_require__) { module.exports = __webpack_require__; })",i=i+"var "+D+" = ("+E.toString().replace("ENTRY_MODULE",JSON.stringify(O))+")({"+u[D].map(function(L){return""+JSON.stringify(L)+": "+h[D][L].toString()}).join(",")+`});
`}),i=i+"new (("+E.toString().replace("ENTRY_MODULE",JSON.stringify(a))+")({"+u.main.map(function(D){return""+JSON.stringify(D)+": "+h.main[D].toString()}).join(",")+"}))(self);";var o=new window.Blob([i],{type:"text/javascript"});if(r.bare)return o;var v=window.URL||window.webkitURL||window.mozURL||window.msURL,b=v.createObjectURL(o),w=new window.Worker(b);return w.objectURL=b,w}},"./src/config.js":function(x,g,m){m.r(g),m.d(g,{defaultConfig:function(){return E},createDefaultConfig:function(){return l}});var E={enableWorker:!1,enableStashBuffer:!0,stashInitialSize:void 0,isLive:!1,lazyLoad:!0,lazyLoadMaxDuration:3*60,lazyLoadRecoverDuration:30,deferLoadAfterSourceOpen:!0,autoCleanupMaxBackwardDuration:3*60,autoCleanupMinBackwardDuration:2*60,statisticsInfoReportInterval:600,fixAudioTimestampGap:!0,accurateSeek:!1,seekType:"range",seekParamStart:"bstart",seekParamEnd:"bend",rangeLoadZeroStart:!1,customSeekHandler:void 0,reuseRedirectedURL:!1,headers:void 0,customLoader:void 0};function l(){return Object.assign({},E)}},"./src/core/features.js":function(x,g,m){m.r(g);var E=m("./src/io/io-controller.js"),l=m("./src/config.js"),e=function(){function t(){}return t.supportMSEH264Playback=function(){return window.MediaSource&&window.MediaSource.isTypeSupported('video/mp4; codecs="avc1.42E01E,mp4a.40.2"')},t.supportNetworkStreamIO=function(){var p=new E.default({},(0,l.createDefaultConfig)()),n=p.loaderType;return p.destroy(),n=="fetch-stream-loader"||n=="xhr-moz-chunked-loader"},t.getNetworkLoaderTypeName=function(){var p=new E.default({},(0,l.createDefaultConfig)()),n=p.loaderType;return p.destroy(),n},t.supportNativeMediaPlayback=function(p){t.videoElement==null&&(t.videoElement=window.document.createElement("video"));var n=t.videoElement.canPlayType(p);return n==="probably"||n=="maybe"},t.getFeatureList=function(){var p={mseFlvPlayback:!1,mseLiveFlvPlayback:!1,networkStreamIO:!1,networkLoaderName:"",nativeMP4H264Playback:!1,nativeWebmVP8Playback:!1,nativeWebmVP9Playback:!1};return p.mseFlvPlayback=t.supportMSEH264Playback(),p.networkStreamIO=t.supportNetworkStreamIO(),p.networkLoaderName=t.getNetworkLoaderTypeName(),p.mseLiveFlvPlayback=p.mseFlvPlayback&&p.networkStreamIO,p.nativeMP4H264Playback=t.supportNativeMediaPlayback('video/mp4; codecs="avc1.42001E, mp4a.40.2"'),p.nativeWebmVP8Playback=t.supportNativeMediaPlayback('video/webm; codecs="vp8.0, vorbis"'),p.nativeWebmVP9Playback=t.supportNativeMediaPlayback('video/webm; codecs="vp9"'),p},t}();g.default=e},"./src/core/media-info.js":function(x,g,m){m.r(g);var E=function(){function l(){this.mimeType=null,this.duration=null,this.hasAudio=null,this.hasVideo=null,this.audioCodec=null,this.videoCodec=null,this.audioDataRate=null,this.videoDataRate=null,this.audioSampleRate=null,this.audioChannelCount=null,this.width=null,this.height=null,this.fps=null,this.profile=null,this.level=null,this.refFrames=null,this.chromaFormat=null,this.sarNum=null,this.sarDen=null,this.metadata=null,this.segments=null,this.segmentCount=null,this.hasKeyframesIndex=null,this.keyframesIndex=null}return l.prototype.isComplete=function(){var e=this.hasAudio===!1||this.hasAudio===!0&&this.audioCodec!=null&&this.audioSampleRate!=null&&this.audioChannelCount!=null,t=this.hasVideo===!1||this.hasVideo===!0&&this.videoCodec!=null&&this.width!=null&&this.height!=null&&this.fps!=null&&this.profile!=null&&this.level!=null&&this.refFrames!=null&&this.chromaFormat!=null&&this.sarNum!=null&&this.sarDen!=null;return this.mimeType!=null&&this.duration!=null&&this.metadata!=null&&this.hasKeyframesIndex!=null&&e&&t},l.prototype.isSeekable=function(){return this.hasKeyframesIndex===!0},l.prototype.getNearestKeyframe=function(e){if(this.keyframesIndex==null)return null;var t=this.keyframesIndex,p=this._search(t.times,e);return{index:p,milliseconds:t.times[p],fileposition:t.filepositions[p]}},l.prototype._search=function(e,t){var p=0,n=e.length-1,d=0,c=0,a=n;for(t<e[0]&&(p=0,c=a+1);c<=a;)if(d=c+Math.floor((a-c)/2),d===n||t>=e[d]&&t<e[d+1]){p=d;break}else e[d]<t?c=d+1:a=d-1;return p},l}();g.default=E},"./src/core/media-segment-info.js":function(x,g,m){m.r(g),m.d(g,{SampleInfo:function(){return E},MediaSegmentInfo:function(){return l},IDRSampleList:function(){return e},MediaSegmentInfoList:function(){return t}});var E=function(){function p(n,d,c,a,r){this.dts=n,this.pts=d,this.duration=c,this.originalDts=a,this.isSyncPoint=r,this.fileposition=null}return p}(),l=function(){function p(){this.beginDts=0,this.endDts=0,this.beginPts=0,this.endPts=0,this.originalBeginDts=0,this.originalEndDts=0,this.syncPoints=[],this.firstSample=null,this.lastSample=null}return p.prototype.appendSyncPoint=function(n){n.isSyncPoint=!0,this.syncPoints.push(n)},p}(),e=function(){function p(){this._list=[]}return p.prototype.clear=function(){this._list=[]},p.prototype.appendArray=function(n){var d=this._list;n.length!==0&&(d.length>0&&n[0].originalDts<d[d.length-1].originalDts&&this.clear(),Array.prototype.push.apply(d,n))},p.prototype.getLastSyncPointBeforeDts=function(n){if(this._list.length==0)return null;var d=this._list,c=0,a=d.length-1,r=0,h=0,u=a;for(n<d[0].dts&&(c=0,h=u+1);h<=u;)if(r=h+Math.floor((u-h)/2),r===a||n>=d[r].dts&&n<d[r+1].dts){c=r;break}else d[r].dts<n?h=r+1:u=r-1;return this._list[c]},p}(),t=function(){function p(n){this._type=n,this._list=[],this._lastAppendLocation=-1}return Object.defineProperty(p.prototype,"type",{get:function(){return this._type},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"length",{get:function(){return this._list.length},enumerable:!1,configurable:!0}),p.prototype.isEmpty=function(){return this._list.length===0},p.prototype.clear=function(){this._list=[],this._lastAppendLocation=-1},p.prototype._searchNearestSegmentBefore=function(n){var d=this._list;if(d.length===0)return-2;var c=d.length-1,a=0,r=0,h=c,u=0;if(n<d[0].originalBeginDts)return u=-1,u;for(;r<=h;)if(a=r+Math.floor((h-r)/2),a===c||n>d[a].lastSample.originalDts&&n<d[a+1].originalBeginDts){u=a;break}else d[a].originalBeginDts<n?r=a+1:h=a-1;return u},p.prototype._searchNearestSegmentAfter=function(n){return this._searchNearestSegmentBefore(n)+1},p.prototype.append=function(n){var d=this._list,c=n,a=this._lastAppendLocation,r=0;a!==-1&&a<d.length&&c.originalBeginDts>=d[a].lastSample.originalDts&&(a===d.length-1||a<d.length-1&&c.originalBeginDts<d[a+1].originalBeginDts)?r=a+1:d.length>0&&(r=this._searchNearestSegmentBefore(c.originalBeginDts)+1),this._lastAppendLocation=r,this._list.splice(r,0,c)},p.prototype.getLastSegmentBefore=function(n){var d=this._searchNearestSegmentBefore(n);return d>=0?this._list[d]:null},p.prototype.getLastSampleBefore=function(n){var d=this.getLastSegmentBefore(n);return d!=null?d.lastSample:null},p.prototype.getLastSyncPointBefore=function(n){for(var d=this._searchNearestSegmentBefore(n),c=this._list[d].syncPoints;c.length===0&&d>0;)d--,c=this._list[d].syncPoints;return c.length>0?c[c.length-1]:null},p}()},"./src/core/mse-controller.js":function(x,g,m){m.r(g);var E=m("./node_modules/events/events.js"),l=m.n(E),e=m("./src/utils/logger.js"),t=m("./src/utils/browser.js"),p=m("./src/core/mse-events.js"),n=m("./src/core/media-segment-info.js"),d=m("./src/utils/exception.js"),c=function(){function a(r){this.TAG="MSEController",this._config=r,this._emitter=new(l()),this._config.isLive&&this._config.autoCleanupSourceBuffer==null&&(this._config.autoCleanupSourceBuffer=!0),this.e={onSourceOpen:this._onSourceOpen.bind(this),onSourceEnded:this._onSourceEnded.bind(this),onSourceClose:this._onSourceClose.bind(this),onSourceBufferError:this._onSourceBufferError.bind(this),onSourceBufferUpdateEnd:this._onSourceBufferUpdateEnd.bind(this)},this._mediaSource=null,this._mediaSourceObjectURL=null,this._mediaElement=null,this._isBufferFull=!1,this._hasPendingEos=!1,this._requireSetMediaDuration=!1,this._pendingMediaDuration=0,this._pendingSourceBufferInit=[],this._mimeTypes={video:null,audio:null},this._sourceBuffers={video:null,audio:null},this._lastInitSegments={video:null,audio:null},this._pendingSegments={video:[],audio:[]},this._pendingRemoveRanges={video:[],audio:[]},this._idrList=new n.IDRSampleList}return a.prototype.destroy=function(){(this._mediaElement||this._mediaSource)&&this.detachMediaElement(),this.e=null,this._emitter.removeAllListeners(),this._emitter=null},a.prototype.on=function(r,h){this._emitter.addListener(r,h)},a.prototype.off=function(r,h){this._emitter.removeListener(r,h)},a.prototype.attachMediaElement=function(r){if(this._mediaSource)throw new d.IllegalStateException("MediaSource has been attached to an HTMLMediaElement!");var h=this._mediaSource=new window.MediaSource;h.addEventListener("sourceopen",this.e.onSourceOpen),h.addEventListener("sourceended",this.e.onSourceEnded),h.addEventListener("sourceclose",this.e.onSourceClose),this._mediaElement=r,this._mediaSourceObjectURL=window.URL.createObjectURL(this._mediaSource),r.src=this._mediaSourceObjectURL},a.prototype.detachMediaElement=function(){if(this._mediaSource){var r=this._mediaSource;for(var h in this._sourceBuffers){var u=this._pendingSegments[h];u.splice(0,u.length),this._pendingSegments[h]=null,this._pendingRemoveRanges[h]=null,this._lastInitSegments[h]=null;var i=this._sourceBuffers[h];if(i){if(r.readyState!=="closed"){try{r.removeSourceBuffer(i)}catch(o){e.default.e(this.TAG,o.message)}i.removeEventListener("error",this.e.onSourceBufferError),i.removeEventListener("updateend",this.e.onSourceBufferUpdateEnd)}this._mimeTypes[h]=null,this._sourceBuffers[h]=null}}if(r.readyState==="open")try{r.endOfStream()}catch(o){e.default.e(this.TAG,o.message)}r.removeEventListener("sourceopen",this.e.onSourceOpen),r.removeEventListener("sourceended",this.e.onSourceEnded),r.removeEventListener("sourceclose",this.e.onSourceClose),this._pendingSourceBufferInit=[],this._isBufferFull=!1,this._idrList.clear(),this._mediaSource=null}this._mediaElement&&(this._mediaElement.src="",this._mediaElement.removeAttribute("src"),this._mediaElement=null),this._mediaSourceObjectURL&&(window.URL.revokeObjectURL(this._mediaSourceObjectURL),this._mediaSourceObjectURL=null)},a.prototype.appendInitSegment=function(r,h){if(!this._mediaSource||this._mediaSource.readyState!=="open"){this._pendingSourceBufferInit.push(r),this._pendingSegments[r.type].push(r);return}var u=r,i=""+u.container;u.codec&&u.codec.length>0&&(i+=";codecs="+u.codec);var o=!1;if(e.default.v(this.TAG,"Received Initialization Segment, mimeType: "+i),this._lastInitSegments[u.type]=u,i!==this._mimeTypes[u.type]){if(this._mimeTypes[u.type])e.default.v(this.TAG,"Notice: "+u.type+" mimeType changed, origin: "+this._mimeTypes[u.type]+", target: "+i);else{o=!0;try{var v=this._sourceBuffers[u.type]=this._mediaSource.addSourceBuffer(i);v.addEventListener("error",this.e.onSourceBufferError),v.addEventListener("updateend",this.e.onSourceBufferUpdateEnd)}catch(b){e.default.e(this.TAG,b.message),this._emitter.emit(p.default.ERROR,{code:b.code,msg:b.message});return}}this._mimeTypes[u.type]=i}h||this._pendingSegments[u.type].push(u),o||this._sourceBuffers[u.type]&&!this._sourceBuffers[u.type].updating&&this._doAppendSegments(),t.default.safari&&u.container==="audio/mpeg"&&u.mediaDuration>0&&(this._requireSetMediaDuration=!0,this._pendingMediaDuration=u.mediaDuration/1e3,this._updateMediaSourceDuration())},a.prototype.appendMediaSegment=function(r){var h=r;this._pendingSegments[h.type].push(h),this._config.autoCleanupSourceBuffer&&this._needCleanupSourceBuffer()&&this._doCleanupSourceBuffer();var u=this._sourceBuffers[h.type];u&&!u.updating&&!this._hasPendingRemoveRanges()&&this._doAppendSegments()},a.prototype.seek=function(r){for(var h in this._sourceBuffers)if(!!this._sourceBuffers[h]){var u=this._sourceBuffers[h];if(this._mediaSource.readyState==="open")try{u.abort()}catch(D){e.default.e(this.TAG,D.message)}this._idrList.clear();var i=this._pendingSegments[h];if(i.splice(0,i.length),this._mediaSource.readyState!=="closed"){for(var o=0;o<u.buffered.length;o++){var v=u.buffered.start(o),b=u.buffered.end(o);this._pendingRemoveRanges[h].push({start:v,end:b})}if(u.updating||this._doRemoveRanges(),t.default.safari){var w=this._lastInitSegments[h];w&&(this._pendingSegments[h].push(w),u.updating||this._doAppendSegments())}}}},a.prototype.endOfStream=function(){var r=this._mediaSource,h=this._sourceBuffers;if(!r||r.readyState!=="open"){r&&r.readyState==="closed"&&this._hasPendingSegments()&&(this._hasPendingEos=!0);return}h.video&&h.video.updating||h.audio&&h.audio.updating?this._hasPendingEos=!0:(this._hasPendingEos=!1,r.endOfStream())},a.prototype.getNearestKeyframe=function(r){return this._idrList.getLastSyncPointBeforeDts(r)},a.prototype._needCleanupSourceBuffer=function(){if(!this._config.autoCleanupSourceBuffer)return!1;var r=this._mediaElement.currentTime;for(var h in this._sourceBuffers){var u=this._sourceBuffers[h];if(u){var i=u.buffered;if(i.length>=1&&r-i.start(0)>=this._config.autoCleanupMaxBackwardDuration)return!0}}return!1},a.prototype._doCleanupSourceBuffer=function(){var r=this._mediaElement.currentTime;for(var h in this._sourceBuffers){var u=this._sourceBuffers[h];if(u){for(var i=u.buffered,o=!1,v=0;v<i.length;v++){var b=i.start(v),w=i.end(v);if(b<=r&&r<w+3){if(r-b>=this._config.autoCleanupMaxBackwardDuration){o=!0;var D=r-this._config.autoCleanupMinBackwardDuration;this._pendingRemoveRanges[h].push({start:b,end:D})}}else w<r&&(o=!0,this._pendingRemoveRanges[h].push({start:b,end:w}))}o&&!u.updating&&this._doRemoveRanges()}}},a.prototype._updateMediaSourceDuration=function(){var r=this._sourceBuffers;if(!(this._mediaElement.readyState===0||this._mediaSource.readyState!=="open")&&!(r.video&&r.video.updating||r.audio&&r.audio.updating)){var h=this._mediaSource.duration,u=this._pendingMediaDuration;u>0&&(isNaN(h)||u>h)&&(e.default.v(this.TAG,"Update MediaSource duration from "+h+" to "+u),this._mediaSource.duration=u),this._requireSetMediaDuration=!1,this._pendingMediaDuration=0}},a.prototype._doRemoveRanges=function(){for(var r in this._pendingRemoveRanges)if(!(!this._sourceBuffers[r]||this._sourceBuffers[r].updating))for(var h=this._sourceBuffers[r],u=this._pendingRemoveRanges[r];u.length&&!h.updating;){var i=u.shift();h.remove(i.start,i.end)}},a.prototype._doAppendSegments=function(){var r=this._pendingSegments;for(var h in r)if(!(!this._sourceBuffers[h]||this._sourceBuffers[h].updating)&&r[h].length>0){var u=r[h].shift();if(u.timestampOffset){var i=this._sourceBuffers[h].timestampOffset,o=u.timestampOffset/1e3,v=Math.abs(i-o);v>.1&&(e.default.v(this.TAG,"Update MPEG audio timestampOffset from "+i+" to "+o),this._sourceBuffers[h].timestampOffset=o),delete u.timestampOffset}if(!u.data||u.data.byteLength===0)continue;try{this._sourceBuffers[h].appendBuffer(u.data),this._isBufferFull=!1,h==="video"&&u.hasOwnProperty("info")&&this._idrList.appendArray(u.info.syncPoints)}catch(b){this._pendingSegments[h].unshift(u),b.code===22?(this._isBufferFull||this._emitter.emit(p.default.BUFFER_FULL),this._isBufferFull=!0):(e.default.e(this.TAG,b.message),this._emitter.emit(p.default.ERROR,{code:b.code,msg:b.message}))}}},a.prototype._onSourceOpen=function(){if(e.default.v(this.TAG,"MediaSource onSourceOpen"),this._mediaSource.removeEventListener("sourceopen",this.e.onSourceOpen),this._pendingSourceBufferInit.length>0)for(var r=this._pendingSourceBufferInit;r.length;){var h=r.shift();this.appendInitSegment(h,!0)}this._hasPendingSegments()&&this._doAppendSegments(),this._emitter.emit(p.default.SOURCE_OPEN)},a.prototype._onSourceEnded=function(){e.default.v(this.TAG,"MediaSource onSourceEnded")},a.prototype._onSourceClose=function(){e.default.v(this.TAG,"MediaSource onSourceClose"),this._mediaSource&&this.e!=null&&(this._mediaSource.removeEventListener("sourceopen",this.e.onSourceOpen),this._mediaSource.removeEventListener("sourceended",this.e.onSourceEnded),this._mediaSource.removeEventListener("sourceclose",this.e.onSourceClose))},a.prototype._hasPendingSegments=function(){var r=this._pendingSegments;return r.video.length>0||r.audio.length>0},a.prototype._hasPendingRemoveRanges=function(){var r=this._pendingRemoveRanges;return r.video.length>0||r.audio.length>0},a.prototype._onSourceBufferUpdateEnd=function(){this._requireSetMediaDuration?this._updateMediaSourceDuration():this._hasPendingRemoveRanges()?this._doRemoveRanges():this._hasPendingSegments()?this._doAppendSegments():this._hasPendingEos&&this.endOfStream(),this._emitter.emit(p.default.UPDATE_END)},a.prototype._onSourceBufferError=function(r){e.default.e(this.TAG,"SourceBuffer Error: "+r)},a}();g.default=c},"./src/core/mse-events.js":function(x,g,m){m.r(g);var E={ERROR:"error",SOURCE_OPEN:"source_open",UPDATE_END:"update_end",BUFFER_FULL:"buffer_full"};g.default=E},"./src/core/transmuxer.js":function(x,g,m){m.r(g);var E=m("./node_modules/events/events.js"),l=m.n(E),e=m("./node_modules/webworkify-webpack/index.js"),t=m.n(e),p=m("./src/utils/logger.js"),n=m("./src/utils/logging-control.js"),d=m("./src/core/transmuxing-controller.js"),c=m("./src/core/transmuxing-events.js"),a=m("./src/core/media-info.js"),r=function(){function h(u,i){if(this.TAG="Transmuxer",this._emitter=new(l()),i.enableWorker&&typeof Worker!="undefined")try{this._worker=t()("./src/core/transmuxing-worker.js"),this._workerDestroying=!1,this._worker.addEventListener("message",this._onWorkerMessage.bind(this)),this._worker.postMessage({cmd:"init",param:[u,i]}),this.e={onLoggingConfigChanged:this._onLoggingConfigChanged.bind(this)},n.default.registerListener(this.e.onLoggingConfigChanged),this._worker.postMessage({cmd:"logging_config",param:n.default.getConfig()})}catch{p.default.e(this.TAG,"Error while initialize transmuxing worker, fallback to inline transmuxing"),this._worker=null,this._controller=new d.default(u,i)}else this._controller=new d.default(u,i);if(this._controller){var o=this._controller;o.on(c.default.IO_ERROR,this._onIOError.bind(this)),o.on(c.default.DEMUX_ERROR,this._onDemuxError.bind(this)),o.on(c.default.INIT_SEGMENT,this._onInitSegment.bind(this)),o.on(c.default.MEDIA_SEGMENT,this._onMediaSegment.bind(this)),o.on(c.default.LOADING_COMPLETE,this._onLoadingComplete.bind(this)),o.on(c.default.RECOVERED_EARLY_EOF,this._onRecoveredEarlyEof.bind(this)),o.on(c.default.MEDIA_INFO,this._onMediaInfo.bind(this)),o.on(c.default.METADATA_ARRIVED,this._onMetaDataArrived.bind(this)),o.on(c.default.SCRIPTDATA_ARRIVED,this._onScriptDataArrived.bind(this)),o.on(c.default.STATISTICS_INFO,this._onStatisticsInfo.bind(this)),o.on(c.default.RECOMMEND_SEEKPOINT,this._onRecommendSeekpoint.bind(this))}}return h.prototype.destroy=function(){this._worker?this._workerDestroying||(this._workerDestroying=!0,this._worker.postMessage({cmd:"destroy"}),n.default.removeListener(this.e.onLoggingConfigChanged),this.e=null):(this._controller.destroy(),this._controller=null),this._emitter.removeAllListeners(),this._emitter=null},h.prototype.on=function(u,i){this._emitter.addListener(u,i)},h.prototype.off=function(u,i){this._emitter.removeListener(u,i)},h.prototype.hasWorker=function(){return this._worker!=null},h.prototype.open=function(){this._worker?this._worker.postMessage({cmd:"start"}):this._controller.start()},h.prototype.close=function(){this._worker?this._worker.postMessage({cmd:"stop"}):this._controller.stop()},h.prototype.seek=function(u){this._worker?this._worker.postMessage({cmd:"seek",param:u}):this._controller.seek(u)},h.prototype.pause=function(){this._worker?this._worker.postMessage({cmd:"pause"}):this._controller.pause()},h.prototype.resume=function(){this._worker?this._worker.postMessage({cmd:"resume"}):this._controller.resume()},h.prototype._onInitSegment=function(u,i){var o=this;Promise.resolve().then(function(){o._emitter.emit(c.default.INIT_SEGMENT,u,i)})},h.prototype._onMediaSegment=function(u,i){var o=this;Promise.resolve().then(function(){o._emitter.emit(c.default.MEDIA_SEGMENT,u,i)})},h.prototype._onLoadingComplete=function(){var u=this;Promise.resolve().then(function(){u._emitter.emit(c.default.LOADING_COMPLETE)})},h.prototype._onRecoveredEarlyEof=function(){var u=this;Promise.resolve().then(function(){u._emitter.emit(c.default.RECOVERED_EARLY_EOF)})},h.prototype._onMediaInfo=function(u){var i=this;Promise.resolve().then(function(){i._emitter.emit(c.default.MEDIA_INFO,u)})},h.prototype._onMetaDataArrived=function(u){var i=this;Promise.resolve().then(function(){i._emitter.emit(c.default.METADATA_ARRIVED,u)})},h.prototype._onScriptDataArrived=function(u){var i=this;Promise.resolve().then(function(){i._emitter.emit(c.default.SCRIPTDATA_ARRIVED,u)})},h.prototype._onStatisticsInfo=function(u){var i=this;Promise.resolve().then(function(){i._emitter.emit(c.default.STATISTICS_INFO,u)})},h.prototype._onIOError=function(u,i){var o=this;Promise.resolve().then(function(){o._emitter.emit(c.default.IO_ERROR,u,i)})},h.prototype._onDemuxError=function(u,i){var o=this;Promise.resolve().then(function(){o._emitter.emit(c.default.DEMUX_ERROR,u,i)})},h.prototype._onRecommendSeekpoint=function(u){var i=this;Promise.resolve().then(function(){i._emitter.emit(c.default.RECOMMEND_SEEKPOINT,u)})},h.prototype._onLoggingConfigChanged=function(u){this._worker&&this._worker.postMessage({cmd:"logging_config",param:u})},h.prototype._onWorkerMessage=function(u){var i=u.data,o=i.data;if(i.msg==="destroyed"||this._workerDestroying){this._workerDestroying=!1,this._worker.terminate(),this._worker=null;return}switch(i.msg){case c.default.INIT_SEGMENT:case c.default.MEDIA_SEGMENT:this._emitter.emit(i.msg,o.type,o.data);break;case c.default.LOADING_COMPLETE:case c.default.RECOVERED_EARLY_EOF:this._emitter.emit(i.msg);break;case c.default.MEDIA_INFO:Object.setPrototypeOf(o,a.default.prototype),this._emitter.emit(i.msg,o);break;case c.default.METADATA_ARRIVED:case c.default.SCRIPTDATA_ARRIVED:case c.default.STATISTICS_INFO:this._emitter.emit(i.msg,o);break;case c.default.IO_ERROR:case c.default.DEMUX_ERROR:this._emitter.emit(i.msg,o.type,o.info);break;case c.default.RECOMMEND_SEEKPOINT:this._emitter.emit(i.msg,o);break;case"logcat_callback":p.default.emitter.emit("log",o.type,o.logcat);break}},h}();g.default=r},"./src/core/transmuxing-controller.js":function(x,g,m){m.r(g);var E=m("./node_modules/events/events.js"),l=m.n(E),e=m("./src/utils/logger.js"),t=m("./src/utils/browser.js"),p=m("./src/core/media-info.js"),n=m("./src/demux/flv-demuxer.js"),d=m("./src/remux/mp4-remuxer.js"),c=m("./src/demux/demux-errors.js"),a=m("./src/io/io-controller.js"),r=m("./src/core/transmuxing-events.js"),h=function(){function u(i,o){this.TAG="TransmuxingController",this._emitter=new(l()),this._config=o,i.segments||(i.segments=[{duration:i.duration,filesize:i.filesize,url:i.url}]),typeof i.cors!="boolean"&&(i.cors=!0),typeof i.withCredentials!="boolean"&&(i.withCredentials=!1),this._mediaDataSource=i,this._currentSegmentIndex=0;var v=0;this._mediaDataSource.segments.forEach(function(b){b.timestampBase=v,v+=b.duration,b.cors=i.cors,b.withCredentials=i.withCredentials,o.referrerPolicy&&(b.referrerPolicy=o.referrerPolicy)}),!isNaN(v)&&this._mediaDataSource.duration!==v&&(this._mediaDataSource.duration=v),this._mediaInfo=null,this._demuxer=null,this._remuxer=null,this._ioctl=null,this._pendingSeekTime=null,this._pendingResolveSeekPoint=null,this._statisticsReporter=null}return u.prototype.destroy=function(){this._mediaInfo=null,this._mediaDataSource=null,this._statisticsReporter&&this._disableStatisticsReporter(),this._ioctl&&(this._ioctl.destroy(),this._ioctl=null),this._demuxer&&(this._demuxer.destroy(),this._demuxer=null),this._remuxer&&(this._remuxer.destroy(),this._remuxer=null),this._emitter.removeAllListeners(),this._emitter=null},u.prototype.on=function(i,o){this._emitter.addListener(i,o)},u.prototype.off=function(i,o){this._emitter.removeListener(i,o)},u.prototype.start=function(){this._loadSegment(0),this._enableStatisticsReporter()},u.prototype._loadSegment=function(i,o){this._currentSegmentIndex=i;var v=this._mediaDataSource.segments[i],b=this._ioctl=new a.default(v,this._config,i);b.onError=this._onIOException.bind(this),b.onSeeked=this._onIOSeeked.bind(this),b.onComplete=this._onIOComplete.bind(this),b.onRedirect=this._onIORedirect.bind(this),b.onRecoveredEarlyEof=this._onIORecoveredEarlyEof.bind(this),o?this._demuxer.bindDataSource(this._ioctl):b.onDataArrival=this._onInitChunkArrival.bind(this),b.open(o)},u.prototype.stop=function(){this._internalAbort(),this._disableStatisticsReporter()},u.prototype._internalAbort=function(){this._ioctl&&(this._ioctl.destroy(),this._ioctl=null)},u.prototype.pause=function(){this._ioctl&&this._ioctl.isWorking()&&(this._ioctl.pause(),this._disableStatisticsReporter())},u.prototype.resume=function(){this._ioctl&&this._ioctl.isPaused()&&(this._ioctl.resume(),this._enableStatisticsReporter())},u.prototype.seek=function(i){if(!(this._mediaInfo==null||!this._mediaInfo.isSeekable())){var o=this._searchSegmentIndexContains(i);if(o===this._currentSegmentIndex){var v=this._mediaInfo.segments[o];if(v==null)this._pendingSeekTime=i;else{var b=v.getNearestKeyframe(i);this._remuxer.seek(b.milliseconds),this._ioctl.seek(b.fileposition),this._pendingResolveSeekPoint=b.milliseconds}}else{var w=this._mediaInfo.segments[o];if(w==null)this._pendingSeekTime=i,this._internalAbort(),this._remuxer.seek(),this._remuxer.insertDiscontinuity(),this._loadSegment(o);else{var b=w.getNearestKeyframe(i);this._internalAbort(),this._remuxer.seek(i),this._remuxer.insertDiscontinuity(),this._demuxer.resetMediaInfo(),this._demuxer.timestampBase=this._mediaDataSource.segments[o].timestampBase,this._loadSegment(o,b.fileposition),this._pendingResolveSeekPoint=b.milliseconds,this._reportSegmentMediaInfo(o)}}this._enableStatisticsReporter()}},u.prototype._searchSegmentIndexContains=function(i){for(var o=this._mediaDataSource.segments,v=o.length-1,b=0;b<o.length;b++)if(i<o[b].timestampBase){v=b-1;break}return v},u.prototype._onInitChunkArrival=function(i,o){var v=this,b=null,w=0;if(o>0)this._demuxer.bindDataSource(this._ioctl),this._demuxer.timestampBase=this._mediaDataSource.segments[this._currentSegmentIndex].timestampBase,w=this._demuxer.parseChunks(i,o);else if((b=n.default.probe(i)).match){this._demuxer=new n.default(b,this._config),this._remuxer||(this._remuxer=new d.default(this._config));var D=this._mediaDataSource;D.duration!=null&&!isNaN(D.duration)&&(this._demuxer.overridedDuration=D.duration),typeof D.hasAudio=="boolean"&&(this._demuxer.overridedHasAudio=D.hasAudio),typeof D.hasVideo=="boolean"&&(this._demuxer.overridedHasVideo=D.hasVideo),this._demuxer.timestampBase=D.segments[this._currentSegmentIndex].timestampBase,this._demuxer.onError=this._onDemuxException.bind(this),this._demuxer.onMediaInfo=this._onMediaInfo.bind(this),this._demuxer.onMetaDataArrived=this._onMetaDataArrived.bind(this),this._demuxer.onScriptDataArrived=this._onScriptDataArrived.bind(this),this._remuxer.bindDataSource(this._demuxer.bindDataSource(this._ioctl)),this._remuxer.onInitSegment=this._onRemuxerInitSegmentArrival.bind(this),this._remuxer.onMediaSegment=this._onRemuxerMediaSegmentArrival.bind(this),w=this._demuxer.parseChunks(i,o)}else b=null,e.default.e(this.TAG,"Non-FLV, Unsupported media type!"),Promise.resolve().then(function(){v._internalAbort()}),this._emitter.emit(r.default.DEMUX_ERROR,c.default.FORMAT_UNSUPPORTED,"Non-FLV, Unsupported media type"),w=0;return w},u.prototype._onMediaInfo=function(i){var o=this;this._mediaInfo==null&&(this._mediaInfo=Object.assign({},i),this._mediaInfo.keyframesIndex=null,this._mediaInfo.segments=[],this._mediaInfo.segmentCount=this._mediaDataSource.segments.length,Object.setPrototypeOf(this._mediaInfo,p.default.prototype));var v=Object.assign({},i);Object.setPrototypeOf(v,p.default.prototype),this._mediaInfo.segments[this._currentSegmentIndex]=v,this._reportSegmentMediaInfo(this._currentSegmentIndex),this._pendingSeekTime!=null&&Promise.resolve().then(function(){var b=o._pendingSeekTime;o._pendingSeekTime=null,o.seek(b)})},u.prototype._onMetaDataArrived=function(i){this._emitter.emit(r.default.METADATA_ARRIVED,i)},u.prototype._onScriptDataArrived=function(i){this._emitter.emit(r.default.SCRIPTDATA_ARRIVED,i)},u.prototype._onIOSeeked=function(){this._remuxer.insertDiscontinuity()},u.prototype._onIOComplete=function(i){var o=i,v=o+1;v<this._mediaDataSource.segments.length?(this._internalAbort(),this._remuxer.flushStashedSamples(),this._loadSegment(v)):(this._remuxer.flushStashedSamples(),this._emitter.emit(r.default.LOADING_COMPLETE),this._disableStatisticsReporter())},u.prototype._onIORedirect=function(i){var o=this._ioctl.extraData;this._mediaDataSource.segments[o].redirectedURL=i},u.prototype._onIORecoveredEarlyEof=function(){this._emitter.emit(r.default.RECOVERED_EARLY_EOF)},u.prototype._onIOException=function(i,o){e.default.e(this.TAG,"IOException: type = "+i+", code = "+o.code+", msg = "+o.msg),this._emitter.emit(r.default.IO_ERROR,i,o),this._disableStatisticsReporter()},u.prototype._onDemuxException=function(i,o){e.default.e(this.TAG,"DemuxException: type = "+i+", info = "+o),this._emitter.emit(r.default.DEMUX_ERROR,i,o)},u.prototype._onRemuxerInitSegmentArrival=function(i,o){this._emitter.emit(r.default.INIT_SEGMENT,i,o)},u.prototype._onRemuxerMediaSegmentArrival=function(i,o){if(this._pendingSeekTime==null&&(this._emitter.emit(r.default.MEDIA_SEGMENT,i,o),this._pendingResolveSeekPoint!=null&&i==="video")){var v=o.info.syncPoints,b=this._pendingResolveSeekPoint;this._pendingResolveSeekPoint=null,t.default.safari&&v.length>0&&v[0].originalDts===b&&(b=v[0].pts),this._emitter.emit(r.default.RECOMMEND_SEEKPOINT,b)}},u.prototype._enableStatisticsReporter=function(){this._statisticsReporter==null&&(this._statisticsReporter=self.setInterval(this._reportStatisticsInfo.bind(this),this._config.statisticsInfoReportInterval))},u.prototype._disableStatisticsReporter=function(){this._statisticsReporter&&(self.clearInterval(this._statisticsReporter),this._statisticsReporter=null)},u.prototype._reportSegmentMediaInfo=function(i){var o=this._mediaInfo.segments[i],v=Object.assign({},o);v.duration=this._mediaInfo.duration,v.segmentCount=this._mediaInfo.segmentCount,delete v.segments,delete v.keyframesIndex,this._emitter.emit(r.default.MEDIA_INFO,v)},u.prototype._reportStatisticsInfo=function(){var i={};i.url=this._ioctl.currentURL,i.hasRedirect=this._ioctl.hasRedirect,i.hasRedirect&&(i.redirectedURL=this._ioctl.currentRedirectedURL),i.speed=this._ioctl.currentSpeed,i.loaderType=this._ioctl.loaderType,i.currentSegmentIndex=this._currentSegmentIndex,i.totalSegmentCount=this._mediaDataSource.segments.length,this._emitter.emit(r.default.STATISTICS_INFO,i)},u}();g.default=h},"./src/core/transmuxing-events.js":function(x,g,m){m.r(g);var E={IO_ERROR:"io_error",DEMUX_ERROR:"demux_error",INIT_SEGMENT:"init_segment",MEDIA_SEGMENT:"media_segment",LOADING_COMPLETE:"loading_complete",RECOVERED_EARLY_EOF:"recovered_early_eof",MEDIA_INFO:"media_info",METADATA_ARRIVED:"metadata_arrived",SCRIPTDATA_ARRIVED:"scriptdata_arrived",STATISTICS_INFO:"statistics_info",RECOMMEND_SEEKPOINT:"recommend_seekpoint"};g.default=E},"./src/core/transmuxing-worker.js":function(x,g,m){m.r(g);var E=m("./src/utils/logging-control.js"),l=m("./src/utils/polyfill.js"),e=m("./src/core/transmuxing-controller.js"),t=m("./src/core/transmuxing-events.js"),p=function(n){var d=null,c=L.bind(this);l.default.install(),n.addEventListener("message",function(R){switch(R.data.cmd){case"init":d=new e.default(R.data.param[0],R.data.param[1]),d.on(t.default.IO_ERROR,w.bind(this)),d.on(t.default.DEMUX_ERROR,D.bind(this)),d.on(t.default.INIT_SEGMENT,a.bind(this)),d.on(t.default.MEDIA_SEGMENT,r.bind(this)),d.on(t.default.LOADING_COMPLETE,h.bind(this)),d.on(t.default.RECOVERED_EARLY_EOF,u.bind(this)),d.on(t.default.MEDIA_INFO,i.bind(this)),d.on(t.default.METADATA_ARRIVED,o.bind(this)),d.on(t.default.SCRIPTDATA_ARRIVED,v.bind(this)),d.on(t.default.STATISTICS_INFO,b.bind(this)),d.on(t.default.RECOMMEND_SEEKPOINT,O.bind(this));break;case"destroy":d&&(d.destroy(),d=null),n.postMessage({msg:"destroyed"});break;case"start":d.start();break;case"stop":d.stop();break;case"seek":d.seek(R.data.param);break;case"pause":d.pause();break;case"resume":d.resume();break;case"logging_config":{var C=R.data.param;E.default.applyConfig(C),C.enableCallback===!0?E.default.addLogListener(c):E.default.removeLogListener(c);break}}});function a(R,C){var I={msg:t.default.INIT_SEGMENT,data:{type:R,data:C}};n.postMessage(I,[C.data])}function r(R,C){var I={msg:t.default.MEDIA_SEGMENT,data:{type:R,data:C}};n.postMessage(I,[C.data])}function h(){var R={msg:t.default.LOADING_COMPLETE};n.postMessage(R)}function u(){var R={msg:t.default.RECOVERED_EARLY_EOF};n.postMessage(R)}function i(R){var C={msg:t.default.MEDIA_INFO,data:R};n.postMessage(C)}function o(R){var C={msg:t.default.METADATA_ARRIVED,data:R};n.postMessage(C)}function v(R){var C={msg:t.default.SCRIPTDATA_ARRIVED,data:R};n.postMessage(C)}function b(R){var C={msg:t.default.STATISTICS_INFO,data:R};n.postMessage(C)}function w(R,C){n.postMessage({msg:t.default.IO_ERROR,data:{type:R,info:C}})}function D(R,C){n.postMessage({msg:t.default.DEMUX_ERROR,data:{type:R,info:C}})}function O(R){n.postMessage({msg:t.default.RECOMMEND_SEEKPOINT,data:R})}function L(R,C){n.postMessage({msg:"logcat_callback",data:{type:R,logcat:C}})}};g.default=p},"./src/demux/amf-parser.js":function(x,g,m){m.r(g);var E=m("./src/utils/logger.js"),l=m("./src/utils/utf8-conv.js"),e=m("./src/utils/exception.js"),t=function(){var n=new ArrayBuffer(2);return new DataView(n).setInt16(0,256,!0),new Int16Array(n)[0]===256}(),p=function(){function n(){}return n.parseScriptData=function(d,c,a){var r={};try{var h=n.parseValue(d,c,a),u=n.parseValue(d,c+h.size,a-h.size);r[h.data]=u.data}catch(i){E.default.e("AMF",i.toString())}return r},n.parseObject=function(d,c,a){if(a<3)throw new e.IllegalStateException("Data not enough when parse ScriptDataObject");var r=n.parseString(d,c,a),h=n.parseValue(d,c+r.size,a-r.size),u=h.objectEnd;return{data:{name:r.data,value:h.data},size:r.size+h.size,objectEnd:u}},n.parseVariable=function(d,c,a){return n.parseObject(d,c,a)},n.parseString=function(d,c,a){if(a<2)throw new e.IllegalStateException("Data not enough when parse String");var r=new DataView(d,c,a),h=r.getUint16(0,!t),u;return h>0?u=(0,l.default)(new Uint8Array(d,c+2,h)):u="",{data:u,size:2+h}},n.parseLongString=function(d,c,a){if(a<4)throw new e.IllegalStateException("Data not enough when parse LongString");var r=new DataView(d,c,a),h=r.getUint32(0,!t),u;return h>0?u=(0,l.default)(new Uint8Array(d,c+4,h)):u="",{data:u,size:4+h}},n.parseDate=function(d,c,a){if(a<10)throw new e.IllegalStateException("Data size invalid when parse Date");var r=new DataView(d,c,a),h=r.getFloat64(0,!t),u=r.getInt16(8,!t);return h+=u*60*1e3,{data:new Date(h),size:8+2}},n.parseValue=function(d,c,a){if(a<1)throw new e.IllegalStateException("Data not enough when parse Value");var r=new DataView(d,c,a),h=1,u=r.getUint8(0),i,o=!1;try{switch(u){case 0:i=r.getFloat64(1,!t),h+=8;break;case 1:{var v=r.getUint8(1);i=!!v,h+=1;break}case 2:{var b=n.parseString(d,c+1,a-1);i=b.data,h+=b.size;break}case 3:{i={};var w=0;for((r.getUint32(a-4,!t)&16777215)==9&&(w=3);h<a-4;){var D=n.parseObject(d,c+h,a-h-w);if(D.objectEnd)break;i[D.data.name]=D.data.value,h+=D.size}if(h<=a-3){var O=r.getUint32(h-1,!t)&16777215;O===9&&(h+=3)}break}case 8:{i={},h+=4;var w=0;for((r.getUint32(a-4,!t)&16777215)==9&&(w=3);h<a-8;){var L=n.parseVariable(d,c+h,a-h-w);if(L.objectEnd)break;i[L.data.name]=L.data.value,h+=L.size}if(h<=a-3){var O=r.getUint32(h-1,!t)&16777215;O===9&&(h+=3)}break}case 9:i=void 0,h=1,o=!0;break;case 10:{i=[];var R=r.getUint32(1,!t);h+=4;for(var C=0;C<R;C++){var I=n.parseValue(d,c+h,a-h);i.push(I.data),h+=I.size}break}case 11:{var M=n.parseDate(d,c+1,a-1);i=M.data,h+=M.size;break}case 12:{var k=n.parseString(d,c+1,a-1);i=k.data,h+=k.size;break}default:h=a,E.default.w("AMF","Unsupported AMF value type "+u)}}catch(V){E.default.e("AMF",V.toString())}return{data:i,size:h,objectEnd:o}},n}();g.default=p},"./src/demux/demux-errors.js":function(x,g,m){m.r(g);var E={OK:"OK",FORMAT_ERROR:"FormatError",FORMAT_UNSUPPORTED:"FormatUnsupported",CODEC_UNSUPPORTED:"CodecUnsupported"};g.default=E},"./src/demux/exp-golomb.js":function(x,g,m){m.r(g);var E=m("./src/utils/exception.js"),l=function(){function e(t){this.TAG="ExpGolomb",this._buffer=t,this._buffer_index=0,this._total_bytes=t.byteLength,this._total_bits=t.byteLength*8,this._current_word=0,this._current_word_bits_left=0}return e.prototype.destroy=function(){this._buffer=null},e.prototype._fillCurrentWord=function(){var t=this._total_bytes-this._buffer_index;if(t<=0)throw new E.IllegalStateException("ExpGolomb: _fillCurrentWord() but no bytes available");var p=Math.min(4,t),n=new Uint8Array(4);n.set(this._buffer.subarray(this._buffer_index,this._buffer_index+p)),this._current_word=new DataView(n.buffer).getUint32(0,!1),this._buffer_index+=p,this._current_word_bits_left=p*8},e.prototype.readBits=function(t){if(t>32)throw new E.InvalidArgumentException("ExpGolomb: readBits() bits exceeded max 32bits!");if(t<=this._current_word_bits_left){var p=this._current_word>>>32-t;return this._current_word<<=t,this._current_word_bits_left-=t,p}var n=this._current_word_bits_left?this._current_word:0;n=n>>>32-this._current_word_bits_left;var d=t-this._current_word_bits_left;this._fillCurrentWord();var c=Math.min(d,this._current_word_bits_left),a=this._current_word>>>32-c;return this._current_word<<=c,this._current_word_bits_left-=c,n=n<<c|a,n},e.prototype.readBool=function(){return this.readBits(1)===1},e.prototype.readByte=function(){return this.readBits(8)},e.prototype._skipLeadingZero=function(){var t;for(t=0;t<this._current_word_bits_left;t++)if((this._current_word&2147483648>>>t)!=0)return this._current_word<<=t,this._current_word_bits_left-=t,t;return this._fillCurrentWord(),t+this._skipLeadingZero()},e.prototype.readUEG=function(){var t=this._skipLeadingZero();return this.readBits(t+1)-1},e.prototype.readSEG=function(){var t=this.readUEG();return t&1?t+1>>>1:-1*(t>>>1)},e}();g.default=l},"./src/demux/flv-demuxer.js":function(x,g,m){m.r(g);var E=m("./src/utils/logger.js"),l=m("./src/demux/amf-parser.js"),e=m("./src/demux/sps-parser.js"),t=m("./src/demux/demux-errors.js"),p=m("./src/core/media-info.js"),n=m("./src/utils/exception.js");function d(a,r){return a[r]<<24|a[r+1]<<16|a[r+2]<<8|a[r+3]}var c=function(){function a(r,h){this.TAG="FLVDemuxer",this._config=h,this._onError=null,this._onMediaInfo=null,this._onMetaDataArrived=null,this._onScriptDataArrived=null,this._onTrackMetadata=null,this._onDataAvailable=null,this._dataOffset=r.dataOffset,this._firstParse=!0,this._dispatch=!1,this._hasAudio=r.hasAudioTrack,this._hasVideo=r.hasVideoTrack,this._hasAudioFlagOverrided=!1,this._hasVideoFlagOverrided=!1,this._audioInitialMetadataDispatched=!1,this._videoInitialMetadataDispatched=!1,this._mediaInfo=new p.default,this._mediaInfo.hasAudio=this._hasAudio,this._mediaInfo.hasVideo=this._hasVideo,this._metadata=null,this._audioMetadata=null,this._videoMetadata=null,this._naluLengthSize=4,this._timestampBase=0,this._timescale=1e3,this._duration=0,this._durationOverrided=!1,this._referenceFrameRate={fixed:!0,fps:23.976,fps_num:23976,fps_den:1e3},this._flvSoundRateTable=[5500,11025,22050,44100,48e3],this._mpegSamplingRates=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350],this._mpegAudioV10SampleRateTable=[44100,48e3,32e3,0],this._mpegAudioV20SampleRateTable=[22050,24e3,16e3,0],this._mpegAudioV25SampleRateTable=[11025,12e3,8e3,0],this._mpegAudioL1BitRateTable=[0,32,64,96,128,160,192,224,256,288,320,352,384,416,448,-1],this._mpegAudioL2BitRateTable=[0,32,48,56,64,80,96,112,128,160,192,224,256,320,384,-1],this._mpegAudioL3BitRateTable=[0,32,40,48,56,64,80,96,112,128,160,192,224,256,320,-1],this._videoTrack={type:"video",id:1,sequenceNumber:0,samples:[],length:0},this._audioTrack={type:"audio",id:2,sequenceNumber:0,samples:[],length:0},this._littleEndian=function(){var u=new ArrayBuffer(2);return new DataView(u).setInt16(0,256,!0),new Int16Array(u)[0]===256}()}return a.prototype.destroy=function(){this._mediaInfo=null,this._metadata=null,this._audioMetadata=null,this._videoMetadata=null,this._videoTrack=null,this._audioTrack=null,this._onError=null,this._onMediaInfo=null,this._onMetaDataArrived=null,this._onScriptDataArrived=null,this._onTrackMetadata=null,this._onDataAvailable=null},a.probe=function(r){var h=new Uint8Array(r),u={match:!1};if(h[0]!==70||h[1]!==76||h[2]!==86||h[3]!==1)return u;var i=(h[4]&4)>>>2!=0,o=(h[4]&1)!=0,v=d(h,5);return v<9?u:{match:!0,consumed:v,dataOffset:v,hasAudioTrack:i,hasVideoTrack:o}},a.prototype.bindDataSource=function(r){return r.onDataArrival=this.parseChunks.bind(this),this},Object.defineProperty(a.prototype,"onTrackMetadata",{get:function(){return this._onTrackMetadata},set:function(r){this._onTrackMetadata=r},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"onMediaInfo",{get:function(){return this._onMediaInfo},set:function(r){this._onMediaInfo=r},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"onMetaDataArrived",{get:function(){return this._onMetaDataArrived},set:function(r){this._onMetaDataArrived=r},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"onScriptDataArrived",{get:function(){return this._onScriptDataArrived},set:function(r){this._onScriptDataArrived=r},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"onError",{get:function(){return this._onError},set:function(r){this._onError=r},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"onDataAvailable",{get:function(){return this._onDataAvailable},set:function(r){this._onDataAvailable=r},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"timestampBase",{get:function(){return this._timestampBase},set:function(r){this._timestampBase=r},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"overridedDuration",{get:function(){return this._duration},set:function(r){this._durationOverrided=!0,this._duration=r,this._mediaInfo.duration=r},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"overridedHasAudio",{set:function(r){this._hasAudioFlagOverrided=!0,this._hasAudio=r,this._mediaInfo.hasAudio=r},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"overridedHasVideo",{set:function(r){this._hasVideoFlagOverrided=!0,this._hasVideo=r,this._mediaInfo.hasVideo=r},enumerable:!1,configurable:!0}),a.prototype.resetMediaInfo=function(){this._mediaInfo=new p.default},a.prototype._isInitialMetadataDispatched=function(){return this._hasAudio&&this._hasVideo?this._audioInitialMetadataDispatched&&this._videoInitialMetadataDispatched:this._hasAudio&&!this._hasVideo?this._audioInitialMetadataDispatched:!this._hasAudio&&this._hasVideo?this._videoInitialMetadataDispatched:!1},a.prototype.parseChunks=function(r,h){if(!this._onError||!this._onMediaInfo||!this._onTrackMetadata||!this._onDataAvailable)throw new n.IllegalStateException("Flv: onError & onMediaInfo & onTrackMetadata & onDataAvailable callback must be specified");var u=0,i=this._littleEndian;if(h===0)if(r.byteLength>13){var o=a.probe(r);u=o.dataOffset}else return 0;if(this._firstParse){this._firstParse=!1,h+u!==this._dataOffset&&E.default.w(this.TAG,"First time parsing but chunk byteStart invalid!");var v=new DataView(r,u),b=v.getUint32(0,!i);b!==0&&E.default.w(this.TAG,"PrevTagSize0 !== 0 !!!"),u+=4}for(;u<r.byteLength;){this._dispatch=!0;var v=new DataView(r,u);if(u+11+4>r.byteLength)break;var w=v.getUint8(0),D=v.getUint32(0,!i)&16777215;if(u+11+D+4>r.byteLength)break;if(w!==8&&w!==9&&w!==18){E.default.w(this.TAG,"Unsupported tag type "+w+", skipped"),u+=11+D+4;continue}var O=v.getUint8(4),L=v.getUint8(5),R=v.getUint8(6),C=v.getUint8(7),I=R|L<<8|O<<16|C<<24,M=v.getUint32(7,!i)&16777215;M!==0&&E.default.w(this.TAG,"Meet tag which has StreamID != 0!");var k=u+11;switch(w){case 8:this._parseAudioData(r,k,D,I);break;case 9:this._parseVideoData(r,k,D,I,h+u);break;case 18:this._parseScriptData(r,k,D);break}var V=v.getUint32(11+D,!i);V!==11+D&&E.default.w(this.TAG,"Invalid PrevTagSize "+V),u+=11+D+4}return this._isInitialMetadataDispatched()&&this._dispatch&&(this._audioTrack.length||this._videoTrack.length)&&this._onDataAvailable(this._audioTrack,this._videoTrack),u},a.prototype._parseScriptData=function(r,h,u){var i=l.default.parseScriptData(r,h,u);if(i.hasOwnProperty("onMetaData")){if(i.onMetaData==null||typeof i.onMetaData!="object"){E.default.w(this.TAG,"Invalid onMetaData structure!");return}this._metadata&&E.default.w(this.TAG,"Found another onMetaData tag!"),this._metadata=i;var o=this._metadata.onMetaData;if(this._onMetaDataArrived&&this._onMetaDataArrived(Object.assign({},o)),typeof o.hasAudio=="boolean"&&this._hasAudioFlagOverrided===!1&&(this._hasAudio=o.hasAudio,this._mediaInfo.hasAudio=this._hasAudio),typeof o.hasVideo=="boolean"&&this._hasVideoFlagOverrided===!1&&(this._hasVideo=o.hasVideo,this._mediaInfo.hasVideo=this._hasVideo),typeof o.audiodatarate=="number"&&(this._mediaInfo.audioDataRate=o.audiodatarate),typeof o.videodatarate=="number"&&(this._mediaInfo.videoDataRate=o.videodatarate),typeof o.width=="number"&&(this._mediaInfo.width=o.width),typeof o.height=="number"&&(this._mediaInfo.height=o.height),typeof o.duration=="number"){if(!this._durationOverrided){var v=Math.floor(o.duration*this._timescale);this._duration=v,this._mediaInfo.duration=v}}else this._mediaInfo.duration=0;if(typeof o.framerate=="number"){var b=Math.floor(o.framerate*1e3);if(b>0){var w=b/1e3;this._referenceFrameRate.fixed=!0,this._referenceFrameRate.fps=w,this._referenceFrameRate.fps_num=b,this._referenceFrameRate.fps_den=1e3,this._mediaInfo.fps=w}}if(typeof o.keyframes=="object"){this._mediaInfo.hasKeyframesIndex=!0;var D=o.keyframes;this._mediaInfo.keyframesIndex=this._parseKeyframesIndex(D),o.keyframes=null}else this._mediaInfo.hasKeyframesIndex=!1;this._dispatch=!1,this._mediaInfo.metadata=o,E.default.v(this.TAG,"Parsed onMetaData"),this._mediaInfo.isComplete()&&this._onMediaInfo(this._mediaInfo)}Object.keys(i).length>0&&this._onScriptDataArrived&&this._onScriptDataArrived(Object.assign({},i))},a.prototype._parseKeyframesIndex=function(r){for(var h=[],u=[],i=1;i<r.times.length;i++){var o=this._timestampBase+Math.floor(r.times[i]*1e3);h.push(o),u.push(r.filepositions[i])}return{times:h,filepositions:u}},a.prototype._parseAudioData=function(r,h,u,i){if(u<=1){E.default.w(this.TAG,"Flv: Invalid audio packet, missing SoundData payload!");return}if(!(this._hasAudioFlagOverrided===!0&&this._hasAudio===!1)){this._littleEndian;var o=new DataView(r,h,u),v=o.getUint8(0),b=v>>>4;if(b!==2&&b!==10){this._onError(t.default.CODEC_UNSUPPORTED,"Flv: Unsupported audio codec idx: "+b);return}var w=0,D=(v&12)>>>2;if(D>=0&&D<=4)w=this._flvSoundRateTable[D];else{this._onError(t.default.FORMAT_ERROR,"Flv: Invalid audio sample rate idx: "+D);return}var O=v&1,L=this._audioMetadata,R=this._audioTrack;if(L||(this._hasAudio===!1&&this._hasAudioFlagOverrided===!1&&(this._hasAudio=!0,this._mediaInfo.hasAudio=!0),L=this._audioMetadata={},L.type="audio",L.id=R.id,L.timescale=this._timescale,L.duration=this._duration,L.audioSampleRate=w,L.channelCount=O===0?1:2),b===10){var C=this._parseAACAudioData(r,h+1,u-1);if(C==null)return;if(C.packetType===0){L.config&&E.default.w(this.TAG,"Found another AudioSpecificConfig!");var I=C.data;L.audioSampleRate=I.samplingRate,L.channelCount=I.channelCount,L.codec=I.codec,L.originalCodec=I.originalCodec,L.config=I.config,L.refSampleDuration=1024/L.audioSampleRate*L.timescale,E.default.v(this.TAG,"Parsed AudioSpecificConfig"),this._isInitialMetadataDispatched()?this._dispatch&&(this._audioTrack.length||this._videoTrack.length)&&this._onDataAvailable(this._audioTrack,this._videoTrack):this._audioInitialMetadataDispatched=!0,this._dispatch=!1,this._onTrackMetadata("audio",L);var M=this._mediaInfo;M.audioCodec=L.originalCodec,M.audioSampleRate=L.audioSampleRate,M.audioChannelCount=L.channelCount,M.hasVideo?M.videoCodec!=null&&(M.mimeType='video/x-flv; codecs="'+M.videoCodec+","+M.audioCodec+'"'):M.mimeType='video/x-flv; codecs="'+M.audioCodec+'"',M.isComplete()&&this._onMediaInfo(M)}else if(C.packetType===1){var k=this._timestampBase+i,V={unit:C.data,length:C.data.byteLength,dts:k,pts:k};R.samples.push(V),R.length+=C.data.length}else E.default.e(this.TAG,"Flv: Unsupported AAC data type "+C.packetType)}else if(b===2){if(!L.codec){var I=this._parseMP3AudioData(r,h+1,u-1,!0);if(I==null)return;L.audioSampleRate=I.samplingRate,L.channelCount=I.channelCount,L.codec=I.codec,L.originalCodec=I.originalCodec,L.refSampleDuration=1152/L.audioSampleRate*L.timescale,E.default.v(this.TAG,"Parsed MPEG Audio Frame Header"),this._audioInitialMetadataDispatched=!0,this._onTrackMetadata("audio",L);var M=this._mediaInfo;M.audioCodec=L.codec,M.audioSampleRate=L.audioSampleRate,M.audioChannelCount=L.channelCount,M.audioDataRate=I.bitRate,M.hasVideo?M.videoCodec!=null&&(M.mimeType='video/x-flv; codecs="'+M.videoCodec+","+M.audioCodec+'"'):M.mimeType='video/x-flv; codecs="'+M.audioCodec+'"',M.isComplete()&&this._onMediaInfo(M)}var G=this._parseMP3AudioData(r,h+1,u-1,!1);if(G==null)return;var k=this._timestampBase+i,N={unit:G,length:G.byteLength,dts:k,pts:k};R.samples.push(N),R.length+=G.length}}},a.prototype._parseAACAudioData=function(r,h,u){if(u<=1){E.default.w(this.TAG,"Flv: Invalid AAC packet, missing AACPacketType or/and Data!");return}var i={},o=new Uint8Array(r,h,u);return i.packetType=o[0],o[0]===0?i.data=this._parseAACAudioSpecificConfig(r,h+1,u-1):i.data=o.subarray(1),i},a.prototype._parseAACAudioSpecificConfig=function(r,h,u){var i=new Uint8Array(r,h,u),o=null,v=0,b=0,w=0,D=null;if(v=b=i[0]>>>3,w=(i[0]&7)<<1|i[1]>>>7,w<0||w>=this._mpegSamplingRates.length){this._onError(t.default.FORMAT_ERROR,"Flv: AAC invalid sampling frequency index!");return}var O=this._mpegSamplingRates[w],L=(i[1]&120)>>>3;if(L<0||L>=8){this._onError(t.default.FORMAT_ERROR,"Flv: AAC invalid channel configuration");return}v===5&&(D=(i[1]&7)<<1|i[2]>>>7,(i[2]&124)>>>2);var R=self.navigator.userAgent.toLowerCase();return R.indexOf("firefox")!==-1?w>=6?(v=5,o=new Array(4),D=w-3):(v=2,o=new Array(2),D=w):R.indexOf("android")!==-1?(v=2,o=new Array(2),D=w):(v=5,D=w,o=new Array(4),w>=6?D=w-3:L===1&&(v=2,o=new Array(2),D=w)),o[0]=v<<3,o[0]|=(w&15)>>>1,o[1]=(w&15)<<7,o[1]|=(L&15)<<3,v===5&&(o[1]|=(D&15)>>>1,o[2]=(D&1)<<7,o[2]|=2<<2,o[3]=0),{config:o,samplingRate:O,channelCount:L,codec:"mp4a.40."+v,originalCodec:"mp4a.40."+b}},a.prototype._parseMP3AudioData=function(r,h,u,i){if(u<4){E.default.w(this.TAG,"Flv: Invalid MP3 packet, header missing!");return}this._littleEndian;var o=new Uint8Array(r,h,u),v=null;if(i){if(o[0]!==255)return;var b=o[1]>>>3&3,w=(o[1]&6)>>1,D=(o[2]&240)>>>4,O=(o[2]&12)>>>2,L=o[3]>>>6&3,R=L!==3?2:1,C=0,I=0,M="mp3";switch(b){case 0:C=this._mpegAudioV25SampleRateTable[O];break;case 2:C=this._mpegAudioV20SampleRateTable[O];break;case 3:C=this._mpegAudioV10SampleRateTable[O];break}switch(w){case 1:D<this._mpegAudioL3BitRateTable.length&&(I=this._mpegAudioL3BitRateTable[D]);break;case 2:D<this._mpegAudioL2BitRateTable.length&&(I=this._mpegAudioL2BitRateTable[D]);break;case 3:D<this._mpegAudioL1BitRateTable.length&&(I=this._mpegAudioL1BitRateTable[D]);break}v={bitRate:I,samplingRate:C,channelCount:R,codec:M,originalCodec:M}}else v=o;return v},a.prototype._parseVideoData=function(r,h,u,i,o){if(u<=1){E.default.w(this.TAG,"Flv: Invalid video packet, missing VideoData payload!");return}if(!(this._hasVideoFlagOverrided===!0&&this._hasVideo===!1)){var v=new Uint8Array(r,h,u)[0],b=(v&240)>>>4,w=v&15;if(w!==7){this._onError(t.default.CODEC_UNSUPPORTED,"Flv: Unsupported codec in video frame: "+w);return}this._parseAVCVideoPacket(r,h+1,u-1,i,o,b)}},a.prototype._parseAVCVideoPacket=function(r,h,u,i,o,v){if(u<4){E.default.w(this.TAG,"Flv: Invalid AVC packet, missing AVCPacketType or/and CompositionTime");return}var b=this._littleEndian,w=new DataView(r,h,u),D=w.getUint8(0),O=w.getUint32(0,!b)&16777215,L=O<<8>>8;if(D===0)this._parseAVCDecoderConfigurationRecord(r,h+4,u-4);else if(D===1)this._parseAVCVideoData(r,h+4,u-4,i,o,v,L);else if(D!==2){this._onError(t.default.FORMAT_ERROR,"Flv: Invalid video packet type "+D);return}},a.prototype._parseAVCDecoderConfigurationRecord=function(r,h,u){if(u<7){E.default.w(this.TAG,"Flv: Invalid AVCDecoderConfigurationRecord, lack of data!");return}var i=this._videoMetadata,o=this._videoTrack,v=this._littleEndian,b=new DataView(r,h,u);i?typeof i.avcc!="undefined"&&E.default.w(this.TAG,"Found another AVCDecoderConfigurationRecord!"):(this._hasVideo===!1&&this._hasVideoFlagOverrided===!1&&(this._hasVideo=!0,this._mediaInfo.hasVideo=!0),i=this._videoMetadata={},i.type="video",i.id=o.id,i.timescale=this._timescale,i.duration=this._duration);var w=b.getUint8(0),D=b.getUint8(1);if(b.getUint8(2),b.getUint8(3),w!==1||D===0){this._onError(t.default.FORMAT_ERROR,"Flv: Invalid AVCDecoderConfigurationRecord");return}if(this._naluLengthSize=(b.getUint8(4)&3)+1,this._naluLengthSize!==3&&this._naluLengthSize!==4){this._onError(t.default.FORMAT_ERROR,"Flv: Strange NaluLengthSizeMinusOne: "+(this._naluLengthSize-1));return}var O=b.getUint8(5)&31;if(O===0){this._onError(t.default.FORMAT_ERROR,"Flv: Invalid AVCDecoderConfigurationRecord: No SPS");return}else O>1&&E.default.w(this.TAG,"Flv: Strange AVCDecoderConfigurationRecord: SPS Count = "+O);for(var L=6,R=0;R<O;R++){var C=b.getUint16(L,!v);if(L+=2,C!==0){var I=new Uint8Array(r,h+L,C);L+=C;var M=e.default.parseSPS(I);if(R===0){i.codecWidth=M.codec_size.width,i.codecHeight=M.codec_size.height,i.presentWidth=M.present_size.width,i.presentHeight=M.present_size.height,i.profile=M.profile_string,i.level=M.level_string,i.bitDepth=M.bit_depth,i.chromaFormat=M.chroma_format,i.sarRatio=M.sar_ratio,i.frameRate=M.frame_rate,(M.frame_rate.fixed===!1||M.frame_rate.fps_num===0||M.frame_rate.fps_den===0)&&(i.frameRate=this._referenceFrameRate);var k=i.frameRate.fps_den,V=i.frameRate.fps_num;i.refSampleDuration=i.timescale*(k/V);for(var G=I.subarray(1,4),N="avc1.",H=0;H<3;H++){var $=G[H].toString(16);$.length<2&&($="0"+$),N+=$}i.codec=N;var j=this._mediaInfo;j.width=i.codecWidth,j.height=i.codecHeight,j.fps=i.frameRate.fps,j.profile=i.profile,j.level=i.level,j.refFrames=M.ref_frames,j.chromaFormat=M.chroma_format_string,j.sarNum=i.sarRatio.width,j.sarDen=i.sarRatio.height,j.videoCodec=N,j.hasAudio?j.audioCodec!=null&&(j.mimeType='video/x-flv; codecs="'+j.videoCodec+","+j.audioCodec+'"'):j.mimeType='video/x-flv; codecs="'+j.videoCodec+'"',j.isComplete()&&this._onMediaInfo(j)}}}var Y=b.getUint8(L);if(Y===0){this._onError(t.default.FORMAT_ERROR,"Flv: Invalid AVCDecoderConfigurationRecord: No PPS");return}else Y>1&&E.default.w(this.TAG,"Flv: Strange AVCDecoderConfigurationRecord: PPS Count = "+Y);L++;for(var R=0;R<Y;R++){var C=b.getUint16(L,!v);L+=2,C!==0&&(L+=C)}i.avcc=new Uint8Array(u),i.avcc.set(new Uint8Array(r,h,u),0),E.default.v(this.TAG,"Parsed AVCDecoderConfigurationRecord"),this._isInitialMetadataDispatched()?this._dispatch&&(this._audioTrack.length||this._videoTrack.length)&&this._onDataAvailable(this._audioTrack,this._videoTrack):this._videoInitialMetadataDispatched=!0,this._dispatch=!1,this._onTrackMetadata("video",i)},a.prototype._parseAVCVideoData=function(r,h,u,i,o,v,b){for(var w=this._littleEndian,D=new DataView(r,h,u),O=[],L=0,R=0,C=this._naluLengthSize,I=this._timestampBase+i,M=v===1;R<u;){if(R+4>=u){E.default.w(this.TAG,"Malformed Nalu near timestamp "+I+", offset = "+R+", dataSize = "+u);break}var k=D.getUint32(R,!w);if(C===3&&(k>>>=8),k>u-C){E.default.w(this.TAG,"Malformed Nalus near timestamp "+I+", NaluSize > DataSize!");return}var V=D.getUint8(R+C)&31;V===5&&(M=!0);var G=new Uint8Array(r,h+R,C+k),N={type:V,data:G};O.push(N),L+=G.byteLength,R+=C+k}if(O.length){var H=this._videoTrack,$={units:O,length:L,isKeyframe:M,dts:I,cts:b,pts:I+b};M&&($.fileposition=o),H.samples.push($),H.length+=L}},a}();g.default=c},"./src/demux/sps-parser.js":function(x,g,m){m.r(g);var E=m("./src/demux/exp-golomb.js"),l=function(){function e(){}return e._ebsp2rbsp=function(t){for(var p=t,n=p.byteLength,d=new Uint8Array(n),c=0,a=0;a<n;a++)a>=2&&p[a]===3&&p[a-1]===0&&p[a-2]===0||(d[c]=p[a],c++);return new Uint8Array(d.buffer,0,c)},e.parseSPS=function(t){var p=e._ebsp2rbsp(t),n=new E.default(p);n.readByte();var d=n.readByte();n.readByte();var c=n.readByte();n.readUEG();var a=e.getProfileString(d),r=e.getLevelString(c),h=1,u=420,i=[0,420,422,444],o=8;if((d===100||d===110||d===122||d===244||d===44||d===83||d===86||d===118||d===128||d===138||d===144)&&(h=n.readUEG(),h===3&&n.readBits(1),h<=3&&(u=i[h]),o=n.readUEG()+8,n.readUEG(),n.readBits(1),n.readBool()))for(var v=h!==3?8:12,b=0;b<v;b++)n.readBool()&&(b<6?e._skipScalingList(n,16):e._skipScalingList(n,64));n.readUEG();var w=n.readUEG();if(w===0)n.readUEG();else if(w===1){n.readBits(1),n.readSEG(),n.readSEG();for(var D=n.readUEG(),b=0;b<D;b++)n.readSEG()}var O=n.readUEG();n.readBits(1);var L=n.readUEG(),R=n.readUEG(),C=n.readBits(1);C===0&&n.readBits(1),n.readBits(1);var I=0,M=0,k=0,V=0,G=n.readBool();G&&(I=n.readUEG(),M=n.readUEG(),k=n.readUEG(),V=n.readUEG());var N=1,H=1,$=0,j=!0,Y=0,fe=0,Q=n.readBool();if(Q){if(n.readBool()){var Z=n.readByte(),ce=[1,12,10,16,40,24,20,32,80,18,15,64,160,4,3,2],se=[1,11,11,11,33,11,11,11,33,11,11,33,99,3,2,1];Z>0&&Z<16?(N=ce[Z-1],H=se[Z-1]):Z===255&&(N=n.readByte()<<8|n.readByte(),H=n.readByte()<<8|n.readByte())}if(n.readBool()&&n.readBool(),n.readBool()&&(n.readBits(4),n.readBool()&&n.readBits(24)),n.readBool()&&(n.readUEG(),n.readUEG()),n.readBool()){var he=n.readBits(32),be=n.readBits(32);j=n.readBool(),Y=be,fe=he*2,$=Y/fe}}var J=1;(N!==1||H!==1)&&(J=N/H);var W=0,de=0;if(h===0)W=1,de=2-C;else{var ge=h===3?1:2,De=h===1?2:1;W=ge,de=De*(2-C)}var Se=(L+1)*16,Le=(2-C)*((R+1)*16);Se-=(I+M)*W,Le-=(k+V)*de;var Pe=Math.ceil(Se*J);return n.destroy(),n=null,{profile_string:a,level_string:r,bit_depth:o,ref_frames:O,chroma_format:u,chroma_format_string:e.getChromaFormatString(u),frame_rate:{fixed:j,fps:$,fps_den:fe,fps_num:Y},sar_ratio:{width:N,height:H},codec_size:{width:Se,height:Le},present_size:{width:Pe,height:Le}}},e._skipScalingList=function(t,p){for(var n=8,d=8,c=0,a=0;a<p;a++)d!==0&&(c=t.readSEG(),d=(n+c+256)%256),n=d===0?n:d},e.getProfileString=function(t){switch(t){case 66:return"Baseline";case 77:return"Main";case 88:return"Extended";case 100:return"High";case 110:return"High10";case 122:return"High422";case 244:return"High444";default:return"Unknown"}},e.getLevelString=function(t){return(t/10).toFixed(1)},e.getChromaFormatString=function(t){switch(t){case 420:return"4:2:0";case 422:return"4:2:2";case 444:return"4:4:4";default:return"Unknown"}},e}();g.default=l},"./src/flv.js":function(x,g,m){m.r(g);var E=m("./src/utils/polyfill.js"),l=m("./src/core/features.js"),e=m("./src/io/loader.js"),t=m("./src/player/flv-player.js"),p=m("./src/player/native-player.js"),n=m("./src/player/player-events.js"),d=m("./src/player/player-errors.js"),c=m("./src/utils/logging-control.js"),a=m("./src/utils/exception.js");E.default.install();function r(o,v){var b=o;if(b==null||typeof b!="object")throw new a.InvalidArgumentException("MediaDataSource must be an javascript object!");if(!b.hasOwnProperty("type"))throw new a.InvalidArgumentException("MediaDataSource must has type field to indicate video file type!");switch(b.type){case"flv":return new t.default(b,v);default:return new p.default(b,v)}}function h(){return l.default.supportMSEH264Playback()}function u(){return l.default.getFeatureList()}var i={};i.createPlayer=r,i.isSupported=h,i.getFeatureList=u,i.BaseLoader=e.BaseLoader,i.LoaderStatus=e.LoaderStatus,i.LoaderErrors=e.LoaderErrors,i.Events=n.default,i.ErrorTypes=d.ErrorTypes,i.ErrorDetails=d.ErrorDetails,i.FlvPlayer=t.default,i.NativePlayer=p.default,i.LoggingControl=c.default,Object.defineProperty(i,"version",{enumerable:!0,get:function(){return"1.6.2"}}),g.default=i},"./src/index.js":function(x,g,m){x.exports=m("./src/flv.js").default},"./src/io/fetch-stream-loader.js":function(x,g,m){m.r(g);var E=m("./src/utils/browser.js"),l=m("./src/io/loader.js"),e=m("./src/utils/exception.js"),t=function(){var n=function(d,c){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,r){a.__proto__=r}||function(a,r){for(var h in r)Object.prototype.hasOwnProperty.call(r,h)&&(a[h]=r[h])},n(d,c)};return function(d,c){if(typeof c!="function"&&c!==null)throw new TypeError("Class extends value "+String(c)+" is not a constructor or null");n(d,c);function a(){this.constructor=d}d.prototype=c===null?Object.create(c):(a.prototype=c.prototype,new a)}}(),p=function(n){t(d,n);function d(c,a){var r=n.call(this,"fetch-stream-loader")||this;return r.TAG="FetchStreamLoader",r._seekHandler=c,r._config=a,r._needStash=!0,r._requestAbort=!1,r._contentLength=null,r._receivedLength=0,r}return d.isSupported=function(){try{var c=E.default.msedge&&E.default.version.minor>=15048,a=E.default.msedge?c:!0;return self.fetch&&self.ReadableStream&&a}catch{return!1}},d.prototype.destroy=function(){this.isWorking()&&this.abort(),n.prototype.destroy.call(this)},d.prototype.open=function(c,a){var r=this;this._dataSource=c,this._range=a;var h=c.url;this._config.reuseRedirectedURL&&c.redirectedURL!=null&&(h=c.redirectedURL);var u=this._seekHandler.getConfig(h,a),i=new self.Headers;if(typeof u.headers=="object"){var o=u.headers;for(var v in o)o.hasOwnProperty(v)&&i.append(v,o[v])}var b={method:"GET",headers:i,mode:"cors",cache:"default",referrerPolicy:"no-referrer-when-downgrade"};if(typeof this._config.headers=="object")for(var v in this._config.headers)i.append(v,this._config.headers[v]);c.cors===!1&&(b.mode="same-origin"),c.withCredentials&&(b.credentials="include"),c.referrerPolicy&&(b.referrerPolicy=c.referrerPolicy),self.AbortController&&(this._abortController=new self.AbortController,b.signal=this._abortController.signal),this._status=l.LoaderStatus.kConnecting,self.fetch(u.url,b).then(function(w){if(r._requestAbort){r._status=l.LoaderStatus.kIdle,w.body.cancel();return}if(w.ok&&w.status>=200&&w.status<=299){if(w.url!==u.url&&r._onURLRedirect){var D=r._seekHandler.removeURLParameters(w.url);r._onURLRedirect(D)}var O=w.headers.get("Content-Length");return O!=null&&(r._contentLength=parseInt(O),r._contentLength!==0&&r._onContentLengthKnown&&r._onContentLengthKnown(r._contentLength)),r._pump.call(r,w.body.getReader())}else if(r._status=l.LoaderStatus.kError,r._onError)r._onError(l.LoaderErrors.HTTP_STATUS_CODE_INVALID,{code:w.status,msg:w.statusText});else throw new e.RuntimeException("FetchStreamLoader: Http code invalid, "+w.status+" "+w.statusText)}).catch(function(w){if(!(r._abortController&&r._abortController.signal.aborted))if(r._status=l.LoaderStatus.kError,r._onError)r._onError(l.LoaderErrors.EXCEPTION,{code:-1,msg:w.message});else throw w})},d.prototype.abort=function(){if(this._requestAbort=!0,(this._status!==l.LoaderStatus.kBuffering||!E.default.chrome)&&this._abortController)try{this._abortController.abort()}catch{}},d.prototype._pump=function(c){var a=this;return c.read().then(function(r){if(r.done)if(a._contentLength!==null&&a._receivedLength<a._contentLength){a._status=l.LoaderStatus.kError;var h=l.LoaderErrors.EARLY_EOF,u={code:-1,msg:"Fetch stream meet Early-EOF"};if(a._onError)a._onError(h,u);else throw new e.RuntimeException(u.msg)}else a._status=l.LoaderStatus.kComplete,a._onComplete&&a._onComplete(a._range.from,a._range.from+a._receivedLength-1);else{if(a._abortController&&a._abortController.signal.aborted){a._status=l.LoaderStatus.kComplete;return}else if(a._requestAbort===!0)return a._status=l.LoaderStatus.kComplete,c.cancel();a._status=l.LoaderStatus.kBuffering;var i=r.value.buffer,o=a._range.from+a._receivedLength;a._receivedLength+=i.byteLength,a._onDataArrival&&a._onDataArrival(i,o,a._receivedLength),a._pump(c)}}).catch(function(r){if(a._abortController&&a._abortController.signal.aborted){a._status=l.LoaderStatus.kComplete;return}if(!(r.code===11&&E.default.msedge)){a._status=l.LoaderStatus.kError;var h=0,u=null;if((r.code===19||r.message==="network error")&&(a._contentLength===null||a._contentLength!==null&&a._receivedLength<a._contentLength)?(h=l.LoaderErrors.EARLY_EOF,u={code:r.code,msg:"Fetch stream meet Early-EOF"}):(h=l.LoaderErrors.EXCEPTION,u={code:r.code,msg:r.message}),a._onError)a._onError(h,u);else throw new e.RuntimeException(u.msg)}})},d}(l.BaseLoader);g.default=p},"./src/io/io-controller.js":function(x,g,m){m.r(g);var E=m("./src/utils/logger.js"),l=m("./src/io/speed-sampler.js"),e=m("./src/io/loader.js"),t=m("./src/io/fetch-stream-loader.js"),p=m("./src/io/xhr-moz-chunked-loader.js"),n=m("./src/io/xhr-range-loader.js"),d=m("./src/io/websocket-loader.js"),c=m("./src/io/range-seek-handler.js"),a=m("./src/io/param-seek-handler.js"),r=m("./src/utils/exception.js"),h=function(){function u(i,o,v){this.TAG="IOController",this._config=o,this._extraData=v,this._stashInitialSize=1024*384,o.stashInitialSize!=null&&o.stashInitialSize>0&&(this._stashInitialSize=o.stashInitialSize),this._stashUsed=0,this._stashSize=this._stashInitialSize,this._bufferSize=1024*1024*3,this._stashBuffer=new ArrayBuffer(this._bufferSize),this._stashByteStart=0,this._enableStash=!0,o.enableStashBuffer===!1&&(this._enableStash=!1),this._loader=null,this._loaderClass=null,this._seekHandler=null,this._dataSource=i,this._isWebSocketURL=/wss?:\/\/(.+?)/.test(i.url),this._refTotalLength=i.filesize?i.filesize:null,this._totalLength=this._refTotalLength,this._fullRequestFlag=!1,this._currentRange=null,this._redirectedURL=null,this._speedNormalized=0,this._speedSampler=new l.default,this._speedNormalizeList=[64,128,256,384,512,768,1024,1536,2048,3072,4096],this._isEarlyEofReconnecting=!1,this._paused=!1,this._resumeFrom=0,this._onDataArrival=null,this._onSeeked=null,this._onError=null,this._onComplete=null,this._onRedirect=null,this._onRecoveredEarlyEof=null,this._selectSeekHandler(),this._selectLoader(),this._createLoader()}return u.prototype.destroy=function(){this._loader.isWorking()&&this._loader.abort(),this._loader.destroy(),this._loader=null,this._loaderClass=null,this._dataSource=null,this._stashBuffer=null,this._stashUsed=this._stashSize=this._bufferSize=this._stashByteStart=0,this._currentRange=null,this._speedSampler=null,this._isEarlyEofReconnecting=!1,this._onDataArrival=null,this._onSeeked=null,this._onError=null,this._onComplete=null,this._onRedirect=null,this._onRecoveredEarlyEof=null,this._extraData=null},u.prototype.isWorking=function(){return this._loader&&this._loader.isWorking()&&!this._paused},u.prototype.isPaused=function(){return this._paused},Object.defineProperty(u.prototype,"status",{get:function(){return this._loader.status},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"extraData",{get:function(){return this._extraData},set:function(i){this._extraData=i},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"onDataArrival",{get:function(){return this._onDataArrival},set:function(i){this._onDataArrival=i},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"onSeeked",{get:function(){return this._onSeeked},set:function(i){this._onSeeked=i},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"onError",{get:function(){return this._onError},set:function(i){this._onError=i},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"onComplete",{get:function(){return this._onComplete},set:function(i){this._onComplete=i},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"onRedirect",{get:function(){return this._onRedirect},set:function(i){this._onRedirect=i},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"onRecoveredEarlyEof",{get:function(){return this._onRecoveredEarlyEof},set:function(i){this._onRecoveredEarlyEof=i},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"currentURL",{get:function(){return this._dataSource.url},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"hasRedirect",{get:function(){return this._redirectedURL!=null||this._dataSource.redirectedURL!=null},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"currentRedirectedURL",{get:function(){return this._redirectedURL||this._dataSource.redirectedURL},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"currentSpeed",{get:function(){return this._loaderClass===n.default?this._loader.currentSpeed:this._speedSampler.lastSecondKBps},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"loaderType",{get:function(){return this._loader.type},enumerable:!1,configurable:!0}),u.prototype._selectSeekHandler=function(){var i=this._config;if(i.seekType==="range")this._seekHandler=new c.default(this._config.rangeLoadZeroStart);else if(i.seekType==="param"){var o=i.seekParamStart||"bstart",v=i.seekParamEnd||"bend";this._seekHandler=new a.default(o,v)}else if(i.seekType==="custom"){if(typeof i.customSeekHandler!="function")throw new r.InvalidArgumentException("Custom seekType specified in config but invalid customSeekHandler!");this._seekHandler=new i.customSeekHandler}else throw new r.InvalidArgumentException("Invalid seekType in config: "+i.seekType)},u.prototype._selectLoader=function(){if(this._config.customLoader!=null)this._loaderClass=this._config.customLoader;else if(this._isWebSocketURL)this._loaderClass=d.default;else if(t.default.isSupported())this._loaderClass=t.default;else if(p.default.isSupported())this._loaderClass=p.default;else if(n.default.isSupported())this._loaderClass=n.default;else throw new r.RuntimeException("Your browser doesn't support xhr with arraybuffer responseType!")},u.prototype._createLoader=function(){this._loader=new this._loaderClass(this._seekHandler,this._config),this._loader.needStashBuffer===!1&&(this._enableStash=!1),this._loader.onContentLengthKnown=this._onContentLengthKnown.bind(this),this._loader.onURLRedirect=this._onURLRedirect.bind(this),this._loader.onDataArrival=this._onLoaderChunkArrival.bind(this),this._loader.onComplete=this._onLoaderComplete.bind(this),this._loader.onError=this._onLoaderError.bind(this)},u.prototype.open=function(i){this._currentRange={from:0,to:-1},i&&(this._currentRange.from=i),this._speedSampler.reset(),i||(this._fullRequestFlag=!0),this._loader.open(this._dataSource,Object.assign({},this._currentRange))},u.prototype.abort=function(){this._loader.abort(),this._paused&&(this._paused=!1,this._resumeFrom=0)},u.prototype.pause=function(){this.isWorking()&&(this._loader.abort(),this._stashUsed!==0?(this._resumeFrom=this._stashByteStart,this._currentRange.to=this._stashByteStart-1):this._resumeFrom=this._currentRange.to+1,this._stashUsed=0,this._stashByteStart=0,this._paused=!0)},u.prototype.resume=function(){if(this._paused){this._paused=!1;var i=this._resumeFrom;this._resumeFrom=0,this._internalSeek(i,!0)}},u.prototype.seek=function(i){this._paused=!1,this._stashUsed=0,this._stashByteStart=0,this._internalSeek(i,!0)},u.prototype._internalSeek=function(i,o){this._loader.isWorking()&&this._loader.abort(),this._flushStashBuffer(o),this._loader.destroy(),this._loader=null;var v={from:i,to:-1};this._currentRange={from:v.from,to:-1},this._speedSampler.reset(),this._stashSize=this._stashInitialSize,this._createLoader(),this._loader.open(this._dataSource,v),this._onSeeked&&this._onSeeked()},u.prototype.updateUrl=function(i){if(!i||typeof i!="string"||i.length===0)throw new r.InvalidArgumentException("Url must be a non-empty string!");this._dataSource.url=i},u.prototype._expandBuffer=function(i){for(var o=this._stashSize;o+1024*1024*1<i;)o*=2;if(o+=1024*1024*1,o!==this._bufferSize){var v=new ArrayBuffer(o);if(this._stashUsed>0){var b=new Uint8Array(this._stashBuffer,0,this._stashUsed),w=new Uint8Array(v,0,o);w.set(b,0)}this._stashBuffer=v,this._bufferSize=o}},u.prototype._normalizeSpeed=function(i){var o=this._speedNormalizeList,v=o.length-1,b=0,w=0,D=v;if(i<o[0])return o[0];for(;w<=D;){if(b=w+Math.floor((D-w)/2),b===v||i>=o[b]&&i<o[b+1])return o[b];o[b]<i?w=b+1:D=b-1}},u.prototype._adjustStashSize=function(i){var o=0;this._config.isLive||i<512?o=i:i>=512&&i<=1024?o=Math.floor(i*1.5):o=i*2,o>8192&&(o=8192);var v=o*1024+1024*1024*1;this._bufferSize<v&&this._expandBuffer(v),this._stashSize=o*1024},u.prototype._dispatchChunks=function(i,o){return this._currentRange.to=o+i.byteLength-1,this._onDataArrival(i,o)},u.prototype._onURLRedirect=function(i){this._redirectedURL=i,this._onRedirect&&this._onRedirect(i)},u.prototype._onContentLengthKnown=function(i){i&&this._fullRequestFlag&&(this._totalLength=i,this._fullRequestFlag=!1)},u.prototype._onLoaderChunkArrival=function(i,o,v){if(!this._onDataArrival)throw new r.IllegalStateException("IOController: No existing consumer (onDataArrival) callback!");if(!this._paused){this._isEarlyEofReconnecting&&(this._isEarlyEofReconnecting=!1,this._onRecoveredEarlyEof&&this._onRecoveredEarlyEof()),this._speedSampler.addBytes(i.byteLength);var b=this._speedSampler.lastSecondKBps;if(b!==0){var w=this._normalizeSpeed(b);this._speedNormalized!==w&&(this._speedNormalized=w,this._adjustStashSize(w))}if(this._enableStash)if(this._stashUsed===0&&this._stashByteStart===0&&(this._stashByteStart=o),this._stashUsed+i.byteLength<=this._stashSize){var L=new Uint8Array(this._stashBuffer,0,this._stashSize);L.set(new Uint8Array(i),this._stashUsed),this._stashUsed+=i.byteLength}else{var L=new Uint8Array(this._stashBuffer,0,this._bufferSize);if(this._stashUsed>0){var C=this._stashBuffer.slice(0,this._stashUsed),D=this._dispatchChunks(C,this._stashByteStart);if(D<C.byteLength){if(D>0){var R=new Uint8Array(C,D);L.set(R,0),this._stashUsed=R.byteLength,this._stashByteStart+=D}}else this._stashUsed=0,this._stashByteStart+=D;this._stashUsed+i.byteLength>this._bufferSize&&(this._expandBuffer(this._stashUsed+i.byteLength),L=new Uint8Array(this._stashBuffer,0,this._bufferSize)),L.set(new Uint8Array(i),this._stashUsed),this._stashUsed+=i.byteLength}else{var D=this._dispatchChunks(i,o);if(D<i.byteLength){var O=i.byteLength-D;O>this._bufferSize&&(this._expandBuffer(O),L=new Uint8Array(this._stashBuffer,0,this._bufferSize)),L.set(new Uint8Array(i,D),0),this._stashUsed+=O,this._stashByteStart=o+D}}}else if(this._stashUsed===0){var D=this._dispatchChunks(i,o);if(D<i.byteLength){var O=i.byteLength-D;O>this._bufferSize&&this._expandBuffer(O);var L=new Uint8Array(this._stashBuffer,0,this._bufferSize);L.set(new Uint8Array(i,D),0),this._stashUsed+=O,this._stashByteStart=o+D}}else{this._stashUsed+i.byteLength>this._bufferSize&&this._expandBuffer(this._stashUsed+i.byteLength);var L=new Uint8Array(this._stashBuffer,0,this._bufferSize);L.set(new Uint8Array(i),this._stashUsed),this._stashUsed+=i.byteLength;var D=this._dispatchChunks(this._stashBuffer.slice(0,this._stashUsed),this._stashByteStart);if(D<this._stashUsed&&D>0){var R=new Uint8Array(this._stashBuffer,D);L.set(R,0)}this._stashUsed-=D,this._stashByteStart+=D}}},u.prototype._flushStashBuffer=function(i){if(this._stashUsed>0){var o=this._stashBuffer.slice(0,this._stashUsed),v=this._dispatchChunks(o,this._stashByteStart),b=o.byteLength-v;if(v<o.byteLength)if(i)E.default.w(this.TAG,b+" bytes unconsumed data remain when flush buffer, dropped");else{if(v>0){var w=new Uint8Array(this._stashBuffer,0,this._bufferSize),D=new Uint8Array(o,v);w.set(D,0),this._stashUsed=D.byteLength,this._stashByteStart+=v}return 0}return this._stashUsed=0,this._stashByteStart=0,b}return 0},u.prototype._onLoaderComplete=function(i,o){this._flushStashBuffer(!0),this._onComplete&&this._onComplete(this._extraData)},u.prototype._onLoaderError=function(i,o){switch(E.default.e(this.TAG,"Loader error, code = "+o.code+", msg = "+o.msg),this._flushStashBuffer(!1),this._isEarlyEofReconnecting&&(this._isEarlyEofReconnecting=!1,i=e.LoaderErrors.UNRECOVERABLE_EARLY_EOF),i){case e.LoaderErrors.EARLY_EOF:{if(!this._config.isLive&&this._totalLength){var v=this._currentRange.to+1;v<this._totalLength&&(E.default.w(this.TAG,"Connection lost, trying reconnect..."),this._isEarlyEofReconnecting=!0,this._internalSeek(v,!1));return}i=e.LoaderErrors.UNRECOVERABLE_EARLY_EOF;break}case e.LoaderErrors.UNRECOVERABLE_EARLY_EOF:case e.LoaderErrors.CONNECTING_TIMEOUT:case e.LoaderErrors.HTTP_STATUS_CODE_INVALID:case e.LoaderErrors.EXCEPTION:break}if(this._onError)this._onError(i,o);else throw new r.RuntimeException("IOException: "+o.msg)},u}();g.default=h},"./src/io/loader.js":function(x,g,m){m.r(g),m.d(g,{LoaderStatus:function(){return l},LoaderErrors:function(){return e},BaseLoader:function(){return t}});var E=m("./src/utils/exception.js"),l={kIdle:0,kConnecting:1,kBuffering:2,kError:3,kComplete:4},e={OK:"OK",EXCEPTION:"Exception",HTTP_STATUS_CODE_INVALID:"HttpStatusCodeInvalid",CONNECTING_TIMEOUT:"ConnectingTimeout",EARLY_EOF:"EarlyEof",UNRECOVERABLE_EARLY_EOF:"UnrecoverableEarlyEof"},t=function(){function p(n){this._type=n||"undefined",this._status=l.kIdle,this._needStash=!1,this._onContentLengthKnown=null,this._onURLRedirect=null,this._onDataArrival=null,this._onError=null,this._onComplete=null}return p.prototype.destroy=function(){this._status=l.kIdle,this._onContentLengthKnown=null,this._onURLRedirect=null,this._onDataArrival=null,this._onError=null,this._onComplete=null},p.prototype.isWorking=function(){return this._status===l.kConnecting||this._status===l.kBuffering},Object.defineProperty(p.prototype,"type",{get:function(){return this._type},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"status",{get:function(){return this._status},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"needStashBuffer",{get:function(){return this._needStash},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"onContentLengthKnown",{get:function(){return this._onContentLengthKnown},set:function(n){this._onContentLengthKnown=n},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"onURLRedirect",{get:function(){return this._onURLRedirect},set:function(n){this._onURLRedirect=n},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"onDataArrival",{get:function(){return this._onDataArrival},set:function(n){this._onDataArrival=n},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"onError",{get:function(){return this._onError},set:function(n){this._onError=n},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"onComplete",{get:function(){return this._onComplete},set:function(n){this._onComplete=n},enumerable:!1,configurable:!0}),p.prototype.open=function(n,d){throw new E.NotImplementedException("Unimplemented abstract function!")},p.prototype.abort=function(){throw new E.NotImplementedException("Unimplemented abstract function!")},p}()},"./src/io/param-seek-handler.js":function(x,g,m){m.r(g);var E=function(){function l(e,t){this._startName=e,this._endName=t}return l.prototype.getConfig=function(e,t){var p=e;if(t.from!==0||t.to!==-1){var n=!0;p.indexOf("?")===-1&&(p+="?",n=!1),n&&(p+="&"),p+=this._startName+"="+t.from.toString(),t.to!==-1&&(p+="&"+this._endName+"="+t.to.toString())}return{url:p,headers:{}}},l.prototype.removeURLParameters=function(e){var t=e.split("?")[0],p=void 0,n=e.indexOf("?");n!==-1&&(p=e.substring(n+1));var d="";if(p!=null&&p.length>0)for(var c=p.split("&"),a=0;a<c.length;a++){var r=c[a].split("="),h=a>0;r[0]!==this._startName&&r[0]!==this._endName&&(h&&(d+="&"),d+=c[a])}return d.length===0?t:t+"?"+d},l}();g.default=E},"./src/io/range-seek-handler.js":function(x,g,m){m.r(g);var E=function(){function l(e){this._zeroStart=e||!1}return l.prototype.getConfig=function(e,t){var p={};if(t.from!==0||t.to!==-1){var n=void 0;t.to!==-1?n="bytes="+t.from.toString()+"-"+t.to.toString():n="bytes="+t.from.toString()+"-",p.Range=n}else this._zeroStart&&(p.Range="bytes=0-");return{url:e,headers:p}},l.prototype.removeURLParameters=function(e){return e},l}();g.default=E},"./src/io/speed-sampler.js":function(x,g,m){m.r(g);var E=function(){function l(){this._firstCheckpoint=0,this._lastCheckpoint=0,this._intervalBytes=0,this._totalBytes=0,this._lastSecondBytes=0,self.performance&&self.performance.now?this._now=self.performance.now.bind(self.performance):this._now=Date.now}return l.prototype.reset=function(){this._firstCheckpoint=this._lastCheckpoint=0,this._totalBytes=this._intervalBytes=0,this._lastSecondBytes=0},l.prototype.addBytes=function(e){this._firstCheckpoint===0?(this._firstCheckpoint=this._now(),this._lastCheckpoint=this._firstCheckpoint,this._intervalBytes+=e,this._totalBytes+=e):this._now()-this._lastCheckpoint<1e3?(this._intervalBytes+=e,this._totalBytes+=e):(this._lastSecondBytes=this._intervalBytes,this._intervalBytes=e,this._totalBytes+=e,this._lastCheckpoint=this._now())},Object.defineProperty(l.prototype,"currentKBps",{get:function(){this.addBytes(0);var e=(this._now()-this._lastCheckpoint)/1e3;return e==0&&(e=1),this._intervalBytes/e/1024},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"lastSecondKBps",{get:function(){return this.addBytes(0),this._lastSecondBytes!==0?this._lastSecondBytes/1024:this._now()-this._lastCheckpoint>=500?this.currentKBps:0},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"averageKBps",{get:function(){var e=(this._now()-this._firstCheckpoint)/1e3;return this._totalBytes/e/1024},enumerable:!1,configurable:!0}),l}();g.default=E},"./src/io/websocket-loader.js":function(x,g,m){m.r(g);var E=m("./src/io/loader.js"),l=m("./src/utils/exception.js"),e=function(){var p=function(n,d){return p=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,a){c.__proto__=a}||function(c,a){for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(c[r]=a[r])},p(n,d)};return function(n,d){if(typeof d!="function"&&d!==null)throw new TypeError("Class extends value "+String(d)+" is not a constructor or null");p(n,d);function c(){this.constructor=n}n.prototype=d===null?Object.create(d):(c.prototype=d.prototype,new c)}}(),t=function(p){e(n,p);function n(){var d=p.call(this,"websocket-loader")||this;return d.TAG="WebSocketLoader",d._needStash=!0,d._ws=null,d._requestAbort=!1,d._receivedLength=0,d}return n.isSupported=function(){try{return typeof self.WebSocket!="undefined"}catch{return!1}},n.prototype.destroy=function(){this._ws&&this.abort(),p.prototype.destroy.call(this)},n.prototype.open=function(d){try{var c=this._ws=new self.WebSocket(d.url);c.binaryType="arraybuffer",c.onopen=this._onWebSocketOpen.bind(this),c.onclose=this._onWebSocketClose.bind(this),c.onmessage=this._onWebSocketMessage.bind(this),c.onerror=this._onWebSocketError.bind(this),this._status=E.LoaderStatus.kConnecting}catch(r){this._status=E.LoaderStatus.kError;var a={code:r.code,msg:r.message};if(this._onError)this._onError(E.LoaderErrors.EXCEPTION,a);else throw new l.RuntimeException(a.msg)}},n.prototype.abort=function(){var d=this._ws;d&&(d.readyState===0||d.readyState===1)&&(this._requestAbort=!0,d.close()),this._ws=null,this._status=E.LoaderStatus.kComplete},n.prototype._onWebSocketOpen=function(d){this._status=E.LoaderStatus.kBuffering},n.prototype._onWebSocketClose=function(d){if(this._requestAbort===!0){this._requestAbort=!1;return}this._status=E.LoaderStatus.kComplete,this._onComplete&&this._onComplete(0,this._receivedLength-1)},n.prototype._onWebSocketMessage=function(d){var c=this;if(d.data instanceof ArrayBuffer)this._dispatchArrayBuffer(d.data);else if(d.data instanceof Blob){var a=new FileReader;a.onload=function(){c._dispatchArrayBuffer(a.result)},a.readAsArrayBuffer(d.data)}else{this._status=E.LoaderStatus.kError;var r={code:-1,msg:"Unsupported WebSocket message type: "+d.data.constructor.name};if(this._onError)this._onError(E.LoaderErrors.EXCEPTION,r);else throw new l.RuntimeException(r.msg)}},n.prototype._dispatchArrayBuffer=function(d){var c=d,a=this._receivedLength;this._receivedLength+=c.byteLength,this._onDataArrival&&this._onDataArrival(c,a,this._receivedLength)},n.prototype._onWebSocketError=function(d){this._status=E.LoaderStatus.kError;var c={code:d.code,msg:d.message};if(this._onError)this._onError(E.LoaderErrors.EXCEPTION,c);else throw new l.RuntimeException(c.msg)},n}(E.BaseLoader);g.default=t},"./src/io/xhr-moz-chunked-loader.js":function(x,g,m){m.r(g);var E=m("./src/utils/logger.js"),l=m("./src/io/loader.js"),e=m("./src/utils/exception.js"),t=function(){var n=function(d,c){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,r){a.__proto__=r}||function(a,r){for(var h in r)Object.prototype.hasOwnProperty.call(r,h)&&(a[h]=r[h])},n(d,c)};return function(d,c){if(typeof c!="function"&&c!==null)throw new TypeError("Class extends value "+String(c)+" is not a constructor or null");n(d,c);function a(){this.constructor=d}d.prototype=c===null?Object.create(c):(a.prototype=c.prototype,new a)}}(),p=function(n){t(d,n);function d(c,a){var r=n.call(this,"xhr-moz-chunked-loader")||this;return r.TAG="MozChunkedLoader",r._seekHandler=c,r._config=a,r._needStash=!0,r._xhr=null,r._requestAbort=!1,r._contentLength=null,r._receivedLength=0,r}return d.isSupported=function(){try{var c=new XMLHttpRequest;return c.open("GET","https://example.com",!0),c.responseType="moz-chunked-arraybuffer",c.responseType==="moz-chunked-arraybuffer"}catch(a){return E.default.w("MozChunkedLoader",a.message),!1}},d.prototype.destroy=function(){this.isWorking()&&this.abort(),this._xhr&&(this._xhr.onreadystatechange=null,this._xhr.onprogress=null,this._xhr.onloadend=null,this._xhr.onerror=null,this._xhr=null),n.prototype.destroy.call(this)},d.prototype.open=function(c,a){this._dataSource=c,this._range=a;var r=c.url;this._config.reuseRedirectedURL&&c.redirectedURL!=null&&(r=c.redirectedURL);var h=this._seekHandler.getConfig(r,a);this._requestURL=h.url;var u=this._xhr=new XMLHttpRequest;if(u.open("GET",h.url,!0),u.responseType="moz-chunked-arraybuffer",u.onreadystatechange=this._onReadyStateChange.bind(this),u.onprogress=this._onProgress.bind(this),u.onloadend=this._onLoadEnd.bind(this),u.onerror=this._onXhrError.bind(this),c.withCredentials&&(u.withCredentials=!0),typeof h.headers=="object"){var i=h.headers;for(var o in i)i.hasOwnProperty(o)&&u.setRequestHeader(o,i[o])}if(typeof this._config.headers=="object"){var i=this._config.headers;for(var o in i)i.hasOwnProperty(o)&&u.setRequestHeader(o,i[o])}this._status=l.LoaderStatus.kConnecting,u.send()},d.prototype.abort=function(){this._requestAbort=!0,this._xhr&&this._xhr.abort(),this._status=l.LoaderStatus.kComplete},d.prototype._onReadyStateChange=function(c){var a=c.target;if(a.readyState===2){if(a.responseURL!=null&&a.responseURL!==this._requestURL&&this._onURLRedirect){var r=this._seekHandler.removeURLParameters(a.responseURL);this._onURLRedirect(r)}if(a.status!==0&&(a.status<200||a.status>299))if(this._status=l.LoaderStatus.kError,this._onError)this._onError(l.LoaderErrors.HTTP_STATUS_CODE_INVALID,{code:a.status,msg:a.statusText});else throw new e.RuntimeException("MozChunkedLoader: Http code invalid, "+a.status+" "+a.statusText);else this._status=l.LoaderStatus.kBuffering}},d.prototype._onProgress=function(c){if(this._status!==l.LoaderStatus.kError){this._contentLength===null&&c.total!==null&&c.total!==0&&(this._contentLength=c.total,this._onContentLengthKnown&&this._onContentLengthKnown(this._contentLength));var a=c.target.response,r=this._range.from+this._receivedLength;this._receivedLength+=a.byteLength,this._onDataArrival&&this._onDataArrival(a,r,this._receivedLength)}},d.prototype._onLoadEnd=function(c){if(this._requestAbort===!0){this._requestAbort=!1;return}else if(this._status===l.LoaderStatus.kError)return;this._status=l.LoaderStatus.kComplete,this._onComplete&&this._onComplete(this._range.from,this._range.from+this._receivedLength-1)},d.prototype._onXhrError=function(c){this._status=l.LoaderStatus.kError;var a=0,r=null;if(this._contentLength&&c.loaded<this._contentLength?(a=l.LoaderErrors.EARLY_EOF,r={code:-1,msg:"Moz-Chunked stream meet Early-Eof"}):(a=l.LoaderErrors.EXCEPTION,r={code:-1,msg:c.constructor.name+" "+c.type}),this._onError)this._onError(a,r);else throw new e.RuntimeException(r.msg)},d}(l.BaseLoader);g.default=p},"./src/io/xhr-range-loader.js":function(x,g,m){m.r(g);var E=m("./src/utils/logger.js"),l=m("./src/io/speed-sampler.js"),e=m("./src/io/loader.js"),t=m("./src/utils/exception.js"),p=function(){var d=function(c,a){return d=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,h){r.__proto__=h}||function(r,h){for(var u in h)Object.prototype.hasOwnProperty.call(h,u)&&(r[u]=h[u])},d(c,a)};return function(c,a){if(typeof a!="function"&&a!==null)throw new TypeError("Class extends value "+String(a)+" is not a constructor or null");d(c,a);function r(){this.constructor=c}c.prototype=a===null?Object.create(a):(r.prototype=a.prototype,new r)}}(),n=function(d){p(c,d);function c(a,r){var h=d.call(this,"xhr-range-loader")||this;return h.TAG="RangeLoader",h._seekHandler=a,h._config=r,h._needStash=!1,h._chunkSizeKBList=[128,256,384,512,768,1024,1536,2048,3072,4096,5120,6144,7168,8192],h._currentChunkSizeKB=384,h._currentSpeedNormalized=0,h._zeroSpeedChunkCount=0,h._xhr=null,h._speedSampler=new l.default,h._requestAbort=!1,h._waitForTotalLength=!1,h._totalLengthReceived=!1,h._currentRequestURL=null,h._currentRedirectedURL=null,h._currentRequestRange=null,h._totalLength=null,h._contentLength=null,h._receivedLength=0,h._lastTimeLoaded=0,h}return c.isSupported=function(){try{var a=new XMLHttpRequest;return a.open("GET","https://example.com",!0),a.responseType="arraybuffer",a.responseType==="arraybuffer"}catch(r){return E.default.w("RangeLoader",r.message),!1}},c.prototype.destroy=function(){this.isWorking()&&this.abort(),this._xhr&&(this._xhr.onreadystatechange=null,this._xhr.onprogress=null,this._xhr.onload=null,this._xhr.onerror=null,this._xhr=null),d.prototype.destroy.call(this)},Object.defineProperty(c.prototype,"currentSpeed",{get:function(){return this._speedSampler.lastSecondKBps},enumerable:!1,configurable:!0}),c.prototype.open=function(a,r){this._dataSource=a,this._range=r,this._status=e.LoaderStatus.kConnecting;var h=!1;this._dataSource.filesize!=null&&this._dataSource.filesize!==0&&(h=!0,this._totalLength=this._dataSource.filesize),!this._totalLengthReceived&&!h?(this._waitForTotalLength=!0,this._internalOpen(this._dataSource,{from:0,to:-1})):this._openSubRange()},c.prototype._openSubRange=function(){var a=this._currentChunkSizeKB*1024,r=this._range.from+this._receivedLength,h=r+a;this._contentLength!=null&&h-this._range.from>=this._contentLength&&(h=this._range.from+this._contentLength-1),this._currentRequestRange={from:r,to:h},this._internalOpen(this._dataSource,this._currentRequestRange)},c.prototype._internalOpen=function(a,r){this._lastTimeLoaded=0;var h=a.url;this._config.reuseRedirectedURL&&(this._currentRedirectedURL!=null?h=this._currentRedirectedURL:a.redirectedURL!=null&&(h=a.redirectedURL));var u=this._seekHandler.getConfig(h,r);this._currentRequestURL=u.url;var i=this._xhr=new XMLHttpRequest;if(i.open("GET",u.url,!0),i.responseType="arraybuffer",i.onreadystatechange=this._onReadyStateChange.bind(this),i.onprogress=this._onProgress.bind(this),i.onload=this._onLoad.bind(this),i.onerror=this._onXhrError.bind(this),a.withCredentials&&(i.withCredentials=!0),typeof u.headers=="object"){var o=u.headers;for(var v in o)o.hasOwnProperty(v)&&i.setRequestHeader(v,o[v])}if(typeof this._config.headers=="object"){var o=this._config.headers;for(var v in o)o.hasOwnProperty(v)&&i.setRequestHeader(v,o[v])}i.send()},c.prototype.abort=function(){this._requestAbort=!0,this._internalAbort(),this._status=e.LoaderStatus.kComplete},c.prototype._internalAbort=function(){this._xhr&&(this._xhr.onreadystatechange=null,this._xhr.onprogress=null,this._xhr.onload=null,this._xhr.onerror=null,this._xhr.abort(),this._xhr=null)},c.prototype._onReadyStateChange=function(a){var r=a.target;if(r.readyState===2){if(r.responseURL!=null){var h=this._seekHandler.removeURLParameters(r.responseURL);r.responseURL!==this._currentRequestURL&&h!==this._currentRedirectedURL&&(this._currentRedirectedURL=h,this._onURLRedirect&&this._onURLRedirect(h))}if(r.status>=200&&r.status<=299){if(this._waitForTotalLength)return;this._status=e.LoaderStatus.kBuffering}else if(this._status=e.LoaderStatus.kError,this._onError)this._onError(e.LoaderErrors.HTTP_STATUS_CODE_INVALID,{code:r.status,msg:r.statusText});else throw new t.RuntimeException("RangeLoader: Http code invalid, "+r.status+" "+r.statusText)}},c.prototype._onProgress=function(a){if(this._status!==e.LoaderStatus.kError){if(this._contentLength===null){var r=!1;if(this._waitForTotalLength){this._waitForTotalLength=!1,this._totalLengthReceived=!0,r=!0;var h=a.total;this._internalAbort(),h!=null&h!==0&&(this._totalLength=h)}if(this._range.to===-1?this._contentLength=this._totalLength-this._range.from:this._contentLength=this._range.to-this._range.from+1,r){this._openSubRange();return}this._onContentLengthKnown&&this._onContentLengthKnown(this._contentLength)}var u=a.loaded-this._lastTimeLoaded;this._lastTimeLoaded=a.loaded,this._speedSampler.addBytes(u)}},c.prototype._normalizeSpeed=function(a){var r=this._chunkSizeKBList,h=r.length-1,u=0,i=0,o=h;if(a<r[0])return r[0];for(;i<=o;){if(u=i+Math.floor((o-i)/2),u===h||a>=r[u]&&a<r[u+1])return r[u];r[u]<a?i=u+1:o=u-1}},c.prototype._onLoad=function(a){if(this._status!==e.LoaderStatus.kError){if(this._waitForTotalLength){this._waitForTotalLength=!1;return}this._lastTimeLoaded=0;var r=this._speedSampler.lastSecondKBps;if(r===0&&(this._zeroSpeedChunkCount++,this._zeroSpeedChunkCount>=3&&(r=this._speedSampler.currentKBps)),r!==0){var h=this._normalizeSpeed(r);this._currentSpeedNormalized!==h&&(this._currentSpeedNormalized=h,this._currentChunkSizeKB=h)}var u=a.target.response,i=this._range.from+this._receivedLength;this._receivedLength+=u.byteLength;var o=!1;this._contentLength!=null&&this._receivedLength<this._contentLength?this._openSubRange():o=!0,this._onDataArrival&&this._onDataArrival(u,i,this._receivedLength),o&&(this._status=e.LoaderStatus.kComplete,this._onComplete&&this._onComplete(this._range.from,this._range.from+this._receivedLength-1))}},c.prototype._onXhrError=function(a){this._status=e.LoaderStatus.kError;var r=0,h=null;if(this._contentLength&&this._receivedLength>0&&this._receivedLength<this._contentLength?(r=e.LoaderErrors.EARLY_EOF,h={code:-1,msg:"RangeLoader meet Early-Eof"}):(r=e.LoaderErrors.EXCEPTION,h={code:-1,msg:a.constructor.name+" "+a.type}),this._onError)this._onError(r,h);else throw new t.RuntimeException(h.msg)},c}(e.BaseLoader);g.default=n},"./src/player/flv-player.js":function(x,g,m){m.r(g);var E=m("./node_modules/events/events.js"),l=m.n(E),e=m("./src/utils/logger.js"),t=m("./src/utils/browser.js"),p=m("./src/player/player-events.js"),n=m("./src/core/transmuxer.js"),d=m("./src/core/transmuxing-events.js"),c=m("./src/core/mse-controller.js"),a=m("./src/core/mse-events.js"),r=m("./src/player/player-errors.js"),h=m("./src/config.js"),u=m("./src/utils/exception.js"),i=function(){function o(v,b){if(this.TAG="FlvPlayer",this._type="FlvPlayer",this._emitter=new(l()),this._config=(0,h.createDefaultConfig)(),typeof b=="object"&&Object.assign(this._config,b),v.type.toLowerCase()!=="flv")throw new u.InvalidArgumentException("FlvPlayer requires an flv MediaDataSource input!");v.isLive===!0&&(this._config.isLive=!0),this.e={onvLoadedMetadata:this._onvLoadedMetadata.bind(this),onvSeeking:this._onvSeeking.bind(this),onvCanPlay:this._onvCanPlay.bind(this),onvStalled:this._onvStalled.bind(this),onvProgress:this._onvProgress.bind(this)},self.performance&&self.performance.now?this._now=self.performance.now.bind(self.performance):this._now=Date.now,this._pendingSeekTime=null,this._requestSetTime=!1,this._seekpointRecord=null,this._progressChecker=null,this._mediaDataSource=v,this._mediaElement=null,this._msectl=null,this._transmuxer=null,this._mseSourceOpened=!1,this._hasPendingLoad=!1,this._receivedCanPlay=!1,this._mediaInfo=null,this._statisticsInfo=null;var w=t.default.chrome&&(t.default.version.major<50||t.default.version.major===50&&t.default.version.build<2661);this._alwaysSeekKeyframe=!!(w||t.default.msedge||t.default.msie),this._alwaysSeekKeyframe&&(this._config.accurateSeek=!1)}return o.prototype.destroy=function(){this._progressChecker!=null&&(window.clearInterval(this._progressChecker),this._progressChecker=null),this._transmuxer&&this.unload(),this._mediaElement&&this.detachMediaElement(),this.e=null,this._mediaDataSource=null,this._emitter.removeAllListeners(),this._emitter=null},o.prototype.on=function(v,b){var w=this;v===p.default.MEDIA_INFO?this._mediaInfo!=null&&Promise.resolve().then(function(){w._emitter.emit(p.default.MEDIA_INFO,w.mediaInfo)}):v===p.default.STATISTICS_INFO&&this._statisticsInfo!=null&&Promise.resolve().then(function(){w._emitter.emit(p.default.STATISTICS_INFO,w.statisticsInfo)}),this._emitter.addListener(v,b)},o.prototype.off=function(v,b){this._emitter.removeListener(v,b)},o.prototype.attachMediaElement=function(v){var b=this;if(this._mediaElement=v,v.addEventListener("loadedmetadata",this.e.onvLoadedMetadata),v.addEventListener("seeking",this.e.onvSeeking),v.addEventListener("canplay",this.e.onvCanPlay),v.addEventListener("stalled",this.e.onvStalled),v.addEventListener("progress",this.e.onvProgress),this._msectl=new c.default(this._config),this._msectl.on(a.default.UPDATE_END,this._onmseUpdateEnd.bind(this)),this._msectl.on(a.default.BUFFER_FULL,this._onmseBufferFull.bind(this)),this._msectl.on(a.default.SOURCE_OPEN,function(){b._mseSourceOpened=!0,b._hasPendingLoad&&(b._hasPendingLoad=!1,b.load())}),this._msectl.on(a.default.ERROR,function(w){b._emitter.emit(p.default.ERROR,r.ErrorTypes.MEDIA_ERROR,r.ErrorDetails.MEDIA_MSE_ERROR,w)}),this._msectl.attachMediaElement(v),this._pendingSeekTime!=null)try{v.currentTime=this._pendingSeekTime,this._pendingSeekTime=null}catch{}},o.prototype.detachMediaElement=function(){this._mediaElement&&(this._msectl.detachMediaElement(),this._mediaElement.removeEventListener("loadedmetadata",this.e.onvLoadedMetadata),this._mediaElement.removeEventListener("seeking",this.e.onvSeeking),this._mediaElement.removeEventListener("canplay",this.e.onvCanPlay),this._mediaElement.removeEventListener("stalled",this.e.onvStalled),this._mediaElement.removeEventListener("progress",this.e.onvProgress),this._mediaElement=null),this._msectl&&(this._msectl.destroy(),this._msectl=null)},o.prototype.load=function(){var v=this;if(!this._mediaElement)throw new u.IllegalStateException("HTMLMediaElement must be attached before load()!");if(this._transmuxer)throw new u.IllegalStateException("FlvPlayer.load() has been called, please call unload() first!");if(!this._hasPendingLoad){if(this._config.deferLoadAfterSourceOpen&&this._mseSourceOpened===!1){this._hasPendingLoad=!0;return}this._mediaElement.readyState>0&&(this._requestSetTime=!0,this._mediaElement.currentTime=0),this._transmuxer=new n.default(this._mediaDataSource,this._config),this._transmuxer.on(d.default.INIT_SEGMENT,function(b,w){v._msectl.appendInitSegment(w)}),this._transmuxer.on(d.default.MEDIA_SEGMENT,function(b,w){if(v._msectl.appendMediaSegment(w),v._config.lazyLoad&&!v._config.isLive){var D=v._mediaElement.currentTime;w.info.endDts>=(D+v._config.lazyLoadMaxDuration)*1e3&&v._progressChecker==null&&(e.default.v(v.TAG,"Maximum buffering duration exceeded, suspend transmuxing task"),v._suspendTransmuxer())}}),this._transmuxer.on(d.default.LOADING_COMPLETE,function(){v._msectl.endOfStream(),v._emitter.emit(p.default.LOADING_COMPLETE)}),this._transmuxer.on(d.default.RECOVERED_EARLY_EOF,function(){v._emitter.emit(p.default.RECOVERED_EARLY_EOF)}),this._transmuxer.on(d.default.IO_ERROR,function(b,w){v._emitter.emit(p.default.ERROR,r.ErrorTypes.NETWORK_ERROR,b,w)}),this._transmuxer.on(d.default.DEMUX_ERROR,function(b,w){v._emitter.emit(p.default.ERROR,r.ErrorTypes.MEDIA_ERROR,b,{code:-1,msg:w})}),this._transmuxer.on(d.default.MEDIA_INFO,function(b){v._mediaInfo=b,v._emitter.emit(p.default.MEDIA_INFO,Object.assign({},b))}),this._transmuxer.on(d.default.METADATA_ARRIVED,function(b){v._emitter.emit(p.default.METADATA_ARRIVED,b)}),this._transmuxer.on(d.default.SCRIPTDATA_ARRIVED,function(b){v._emitter.emit(p.default.SCRIPTDATA_ARRIVED,b)}),this._transmuxer.on(d.default.STATISTICS_INFO,function(b){v._statisticsInfo=v._fillStatisticsInfo(b),v._emitter.emit(p.default.STATISTICS_INFO,Object.assign({},v._statisticsInfo))}),this._transmuxer.on(d.default.RECOMMEND_SEEKPOINT,function(b){v._mediaElement&&!v._config.accurateSeek&&(v._requestSetTime=!0,v._mediaElement.currentTime=b/1e3)}),this._transmuxer.open()}},o.prototype.unload=function(){this._mediaElement&&this._mediaElement.pause(),this._msectl&&this._msectl.seek(0),this._transmuxer&&(this._transmuxer.close(),this._transmuxer.destroy(),this._transmuxer=null)},o.prototype.play=function(){return this._mediaElement.play()},o.prototype.pause=function(){this._mediaElement.pause()},Object.defineProperty(o.prototype,"type",{get:function(){return this._type},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"buffered",{get:function(){return this._mediaElement.buffered},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"duration",{get:function(){return this._mediaElement.duration},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"volume",{get:function(){return this._mediaElement.volume},set:function(v){this._mediaElement.volume=v},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"muted",{get:function(){return this._mediaElement.muted},set:function(v){this._mediaElement.muted=v},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"currentTime",{get:function(){return this._mediaElement?this._mediaElement.currentTime:0},set:function(v){this._mediaElement?this._internalSeek(v):this._pendingSeekTime=v},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"mediaInfo",{get:function(){return Object.assign({},this._mediaInfo)},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"statisticsInfo",{get:function(){return this._statisticsInfo==null&&(this._statisticsInfo={}),this._statisticsInfo=this._fillStatisticsInfo(this._statisticsInfo),Object.assign({},this._statisticsInfo)},enumerable:!1,configurable:!0}),o.prototype._fillStatisticsInfo=function(v){if(v.playerType=this._type,!(this._mediaElement instanceof HTMLVideoElement))return v;var b=!0,w=0,D=0;if(this._mediaElement.getVideoPlaybackQuality){var O=this._mediaElement.getVideoPlaybackQuality();w=O.totalVideoFrames,D=O.droppedVideoFrames}else this._mediaElement.webkitDecodedFrameCount!=null?(w=this._mediaElement.webkitDecodedFrameCount,D=this._mediaElement.webkitDroppedFrameCount):b=!1;return b&&(v.decodedFrames=w,v.droppedFrames=D),v},o.prototype._onmseUpdateEnd=function(){if(!(!this._config.lazyLoad||this._config.isLive)){for(var v=this._mediaElement.buffered,b=this._mediaElement.currentTime,w=0,D=0;D<v.length;D++){var O=v.start(D),L=v.end(D);if(O<=b&&b<L){w=L;break}}w>=b+this._config.lazyLoadMaxDuration&&this._progressChecker==null&&(e.default.v(this.TAG,"Maximum buffering duration exceeded, suspend transmuxing task"),this._suspendTransmuxer())}},o.prototype._onmseBufferFull=function(){e.default.v(this.TAG,"MSE SourceBuffer is full, suspend transmuxing task"),this._progressChecker==null&&this._suspendTransmuxer()},o.prototype._suspendTransmuxer=function(){this._transmuxer&&(this._transmuxer.pause(),this._progressChecker==null&&(this._progressChecker=window.setInterval(this._checkProgressAndResume.bind(this),1e3)))},o.prototype._checkProgressAndResume=function(){for(var v=this._mediaElement.currentTime,b=this._mediaElement.buffered,w=!1,D=0;D<b.length;D++){var O=b.start(D),L=b.end(D);if(v>=O&&v<L){v>=L-this._config.lazyLoadRecoverDuration&&(w=!0);break}}w&&(window.clearInterval(this._progressChecker),this._progressChecker=null,w&&(e.default.v(this.TAG,"Continue loading from paused position"),this._transmuxer.resume()))},o.prototype._isTimepointBuffered=function(v){for(var b=this._mediaElement.buffered,w=0;w<b.length;w++){var D=b.start(w),O=b.end(w);if(v>=D&&v<O)return!0}return!1},o.prototype._internalSeek=function(v){var b=this._isTimepointBuffered(v),w=!1,D=0;if(v<1&&this._mediaElement.buffered.length>0){var O=this._mediaElement.buffered.start(0);(O<1&&v<O||t.default.safari)&&(w=!0,D=t.default.safari?.1:O)}if(w)this._requestSetTime=!0,this._mediaElement.currentTime=D;else if(b){if(!this._alwaysSeekKeyframe)this._requestSetTime=!0,this._mediaElement.currentTime=v;else{var L=this._msectl.getNearestKeyframe(Math.floor(v*1e3));this._requestSetTime=!0,L!=null?this._mediaElement.currentTime=L.dts/1e3:this._mediaElement.currentTime=v}this._progressChecker!=null&&this._checkProgressAndResume()}else this._progressChecker!=null&&(window.clearInterval(this._progressChecker),this._progressChecker=null),this._msectl.seek(v),this._transmuxer.seek(Math.floor(v*1e3)),this._config.accurateSeek&&(this._requestSetTime=!0,this._mediaElement.currentTime=v)},o.prototype._checkAndApplyUnbufferedSeekpoint=function(){if(this._seekpointRecord)if(this._seekpointRecord.recordTime<=this._now()-100){var v=this._mediaElement.currentTime;this._seekpointRecord=null,this._isTimepointBuffered(v)||(this._progressChecker!=null&&(window.clearTimeout(this._progressChecker),this._progressChecker=null),this._msectl.seek(v),this._transmuxer.seek(Math.floor(v*1e3)),this._config.accurateSeek&&(this._requestSetTime=!0,this._mediaElement.currentTime=v))}else window.setTimeout(this._checkAndApplyUnbufferedSeekpoint.bind(this),50)},o.prototype._checkAndResumeStuckPlayback=function(v){var b=this._mediaElement;if(v||!this._receivedCanPlay||b.readyState<2){var w=b.buffered;w.length>0&&b.currentTime<w.start(0)&&(e.default.w(this.TAG,"Playback seems stuck at "+b.currentTime+", seek to "+w.start(0)),this._requestSetTime=!0,this._mediaElement.currentTime=w.start(0),this._mediaElement.removeEventListener("progress",this.e.onvProgress))}else this._mediaElement.removeEventListener("progress",this.e.onvProgress)},o.prototype._onvLoadedMetadata=function(v){this._pendingSeekTime!=null&&(this._mediaElement.currentTime=this._pendingSeekTime,this._pendingSeekTime=null)},o.prototype._onvSeeking=function(v){var b=this._mediaElement.currentTime,w=this._mediaElement.buffered;if(this._requestSetTime){this._requestSetTime=!1;return}if(b<1&&w.length>0){var D=w.start(0);if(D<1&&b<D||t.default.safari){this._requestSetTime=!0,this._mediaElement.currentTime=t.default.safari?.1:D;return}}if(this._isTimepointBuffered(b)){if(this._alwaysSeekKeyframe){var O=this._msectl.getNearestKeyframe(Math.floor(b*1e3));O!=null&&(this._requestSetTime=!0,this._mediaElement.currentTime=O.dts/1e3)}this._progressChecker!=null&&this._checkProgressAndResume();return}this._seekpointRecord={seekPoint:b,recordTime:this._now()},window.setTimeout(this._checkAndApplyUnbufferedSeekpoint.bind(this),50)},o.prototype._onvCanPlay=function(v){this._receivedCanPlay=!0,this._mediaElement.removeEventListener("canplay",this.e.onvCanPlay)},o.prototype._onvStalled=function(v){this._checkAndResumeStuckPlayback(!0)},o.prototype._onvProgress=function(v){this._checkAndResumeStuckPlayback()},o}();g.default=i},"./src/player/native-player.js":function(x,g,m){m.r(g);var E=m("./node_modules/events/events.js"),l=m.n(E),e=m("./src/player/player-events.js"),t=m("./src/config.js"),p=m("./src/utils/exception.js"),n=function(){function d(c,a){if(this.TAG="NativePlayer",this._type="NativePlayer",this._emitter=new(l()),this._config=(0,t.createDefaultConfig)(),typeof a=="object"&&Object.assign(this._config,a),c.type.toLowerCase()==="flv")throw new p.InvalidArgumentException("NativePlayer does't support flv MediaDataSource input!");if(c.hasOwnProperty("segments"))throw new p.InvalidArgumentException("NativePlayer("+c.type+") doesn't support multipart playback!");this.e={onvLoadedMetadata:this._onvLoadedMetadata.bind(this)},this._pendingSeekTime=null,this._statisticsReporter=null,this._mediaDataSource=c,this._mediaElement=null}return d.prototype.destroy=function(){this._mediaElement&&(this.unload(),this.detachMediaElement()),this.e=null,this._mediaDataSource=null,this._emitter.removeAllListeners(),this._emitter=null},d.prototype.on=function(c,a){var r=this;c===e.default.MEDIA_INFO?this._mediaElement!=null&&this._mediaElement.readyState!==0&&Promise.resolve().then(function(){r._emitter.emit(e.default.MEDIA_INFO,r.mediaInfo)}):c===e.default.STATISTICS_INFO&&this._mediaElement!=null&&this._mediaElement.readyState!==0&&Promise.resolve().then(function(){r._emitter.emit(e.default.STATISTICS_INFO,r.statisticsInfo)}),this._emitter.addListener(c,a)},d.prototype.off=function(c,a){this._emitter.removeListener(c,a)},d.prototype.attachMediaElement=function(c){if(this._mediaElement=c,c.addEventListener("loadedmetadata",this.e.onvLoadedMetadata),this._pendingSeekTime!=null)try{c.currentTime=this._pendingSeekTime,this._pendingSeekTime=null}catch{}},d.prototype.detachMediaElement=function(){this._mediaElement&&(this._mediaElement.src="",this._mediaElement.removeAttribute("src"),this._mediaElement.removeEventListener("loadedmetadata",this.e.onvLoadedMetadata),this._mediaElement=null),this._statisticsReporter!=null&&(window.clearInterval(this._statisticsReporter),this._statisticsReporter=null)},d.prototype.load=function(){if(!this._mediaElement)throw new p.IllegalStateException("HTMLMediaElement must be attached before load()!");this._mediaElement.src=this._mediaDataSource.url,this._mediaElement.readyState>0&&(this._mediaElement.currentTime=0),this._mediaElement.preload="auto",this._mediaElement.load(),this._statisticsReporter=window.setInterval(this._reportStatisticsInfo.bind(this),this._config.statisticsInfoReportInterval)},d.prototype.unload=function(){this._mediaElement&&(this._mediaElement.src="",this._mediaElement.removeAttribute("src")),this._statisticsReporter!=null&&(window.clearInterval(this._statisticsReporter),this._statisticsReporter=null)},d.prototype.play=function(){return this._mediaElement.play()},d.prototype.pause=function(){this._mediaElement.pause()},Object.defineProperty(d.prototype,"type",{get:function(){return this._type},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"buffered",{get:function(){return this._mediaElement.buffered},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"duration",{get:function(){return this._mediaElement.duration},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"volume",{get:function(){return this._mediaElement.volume},set:function(c){this._mediaElement.volume=c},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"muted",{get:function(){return this._mediaElement.muted},set:function(c){this._mediaElement.muted=c},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"currentTime",{get:function(){return this._mediaElement?this._mediaElement.currentTime:0},set:function(c){this._mediaElement?this._mediaElement.currentTime=c:this._pendingSeekTime=c},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"mediaInfo",{get:function(){var c=this._mediaElement instanceof HTMLAudioElement?"audio/":"video/",a={mimeType:c+this._mediaDataSource.type};return this._mediaElement&&(a.duration=Math.floor(this._mediaElement.duration*1e3),this._mediaElement instanceof HTMLVideoElement&&(a.width=this._mediaElement.videoWidth,a.height=this._mediaElement.videoHeight)),a},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"statisticsInfo",{get:function(){var c={playerType:this._type,url:this._mediaDataSource.url};if(!(this._mediaElement instanceof HTMLVideoElement))return c;var a=!0,r=0,h=0;if(this._mediaElement.getVideoPlaybackQuality){var u=this._mediaElement.getVideoPlaybackQuality();r=u.totalVideoFrames,h=u.droppedVideoFrames}else this._mediaElement.webkitDecodedFrameCount!=null?(r=this._mediaElement.webkitDecodedFrameCount,h=this._mediaElement.webkitDroppedFrameCount):a=!1;return a&&(c.decodedFrames=r,c.droppedFrames=h),c},enumerable:!1,configurable:!0}),d.prototype._onvLoadedMetadata=function(c){this._pendingSeekTime!=null&&(this._mediaElement.currentTime=this._pendingSeekTime,this._pendingSeekTime=null),this._emitter.emit(e.default.MEDIA_INFO,this.mediaInfo)},d.prototype._reportStatisticsInfo=function(){this._emitter.emit(e.default.STATISTICS_INFO,this.statisticsInfo)},d}();g.default=n},"./src/player/player-errors.js":function(x,g,m){m.r(g),m.d(g,{ErrorTypes:function(){return e},ErrorDetails:function(){return t}});var E=m("./src/io/loader.js"),l=m("./src/demux/demux-errors.js"),e={NETWORK_ERROR:"NetworkError",MEDIA_ERROR:"MediaError",OTHER_ERROR:"OtherError"},t={NETWORK_EXCEPTION:E.LoaderErrors.EXCEPTION,NETWORK_STATUS_CODE_INVALID:E.LoaderErrors.HTTP_STATUS_CODE_INVALID,NETWORK_TIMEOUT:E.LoaderErrors.CONNECTING_TIMEOUT,NETWORK_UNRECOVERABLE_EARLY_EOF:E.LoaderErrors.UNRECOVERABLE_EARLY_EOF,MEDIA_MSE_ERROR:"MediaMSEError",MEDIA_FORMAT_ERROR:l.default.FORMAT_ERROR,MEDIA_FORMAT_UNSUPPORTED:l.default.FORMAT_UNSUPPORTED,MEDIA_CODEC_UNSUPPORTED:l.default.CODEC_UNSUPPORTED}},"./src/player/player-events.js":function(x,g,m){m.r(g);var E={ERROR:"error",LOADING_COMPLETE:"loading_complete",RECOVERED_EARLY_EOF:"recovered_early_eof",MEDIA_INFO:"media_info",METADATA_ARRIVED:"metadata_arrived",SCRIPTDATA_ARRIVED:"scriptdata_arrived",STATISTICS_INFO:"statistics_info"};g.default=E},"./src/remux/aac-silent.js":function(x,g,m){m.r(g);var E=function(){function l(){}return l.getSilentFrame=function(e,t){if(e==="mp4a.40.2"){if(t===1)return new Uint8Array([0,200,0,128,35,128]);if(t===2)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(t===3)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(t===4)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(t===5)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(t===6)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224])}else{if(t===1)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(t===2)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(t===3)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94])}return null},l}();g.default=E},"./src/remux/mp4-generator.js":function(x,g,m){m.r(g);var E=function(){function l(){}return l.init=function(){l.types={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],mvex:[],mvhd:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[],".mp3":[]};for(var e in l.types)l.types.hasOwnProperty(e)&&(l.types[e]=[e.charCodeAt(0),e.charCodeAt(1),e.charCodeAt(2),e.charCodeAt(3)]);var t=l.constants={};t.FTYP=new Uint8Array([105,115,111,109,0,0,0,1,105,115,111,109,97,118,99,49]),t.STSD_PREFIX=new Uint8Array([0,0,0,0,0,0,0,1]),t.STTS=new Uint8Array([0,0,0,0,0,0,0,0]),t.STSC=t.STCO=t.STTS,t.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),t.HDLR_VIDEO=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),t.HDLR_AUDIO=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]),t.DREF=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),t.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),t.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0])},l.box=function(e){for(var t=8,p=null,n=Array.prototype.slice.call(arguments,1),d=n.length,c=0;c<d;c++)t+=n[c].byteLength;p=new Uint8Array(t),p[0]=t>>>24&255,p[1]=t>>>16&255,p[2]=t>>>8&255,p[3]=t&255,p.set(e,4);for(var a=8,c=0;c<d;c++)p.set(n[c],a),a+=n[c].byteLength;return p},l.generateInitSegment=function(e){var t=l.box(l.types.ftyp,l.constants.FTYP),p=l.moov(e),n=new Uint8Array(t.byteLength+p.byteLength);return n.set(t,0),n.set(p,t.byteLength),n},l.moov=function(e){var t=l.mvhd(e.timescale,e.duration),p=l.trak(e),n=l.mvex(e);return l.box(l.types.moov,t,p,n)},l.mvhd=function(e,t){return l.box(l.types.mvhd,new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,e>>>24&255,e>>>16&255,e>>>8&255,e&255,t>>>24&255,t>>>16&255,t>>>8&255,t&255,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]))},l.trak=function(e){return l.box(l.types.trak,l.tkhd(e),l.mdia(e))},l.tkhd=function(e){var t=e.id,p=e.duration,n=e.presentWidth,d=e.presentHeight;return l.box(l.types.tkhd,new Uint8Array([0,0,0,7,0,0,0,0,0,0,0,0,t>>>24&255,t>>>16&255,t>>>8&255,t&255,0,0,0,0,p>>>24&255,p>>>16&255,p>>>8&255,p&255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,n>>>8&255,n&255,0,0,d>>>8&255,d&255,0,0]))},l.mdia=function(e){return l.box(l.types.mdia,l.mdhd(e),l.hdlr(e),l.minf(e))},l.mdhd=function(e){var t=e.timescale,p=e.duration;return l.box(l.types.mdhd,new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,t>>>24&255,t>>>16&255,t>>>8&255,t&255,p>>>24&255,p>>>16&255,p>>>8&255,p&255,85,196,0,0]))},l.hdlr=function(e){var t=null;return e.type==="audio"?t=l.constants.HDLR_AUDIO:t=l.constants.HDLR_VIDEO,l.box(l.types.hdlr,t)},l.minf=function(e){var t=null;return e.type==="audio"?t=l.box(l.types.smhd,l.constants.SMHD):t=l.box(l.types.vmhd,l.constants.VMHD),l.box(l.types.minf,t,l.dinf(),l.stbl(e))},l.dinf=function(){var e=l.box(l.types.dinf,l.box(l.types.dref,l.constants.DREF));return e},l.stbl=function(e){var t=l.box(l.types.stbl,l.stsd(e),l.box(l.types.stts,l.constants.STTS),l.box(l.types.stsc,l.constants.STSC),l.box(l.types.stsz,l.constants.STSZ),l.box(l.types.stco,l.constants.STCO));return t},l.stsd=function(e){return e.type==="audio"?e.codec==="mp3"?l.box(l.types.stsd,l.constants.STSD_PREFIX,l.mp3(e)):l.box(l.types.stsd,l.constants.STSD_PREFIX,l.mp4a(e)):l.box(l.types.stsd,l.constants.STSD_PREFIX,l.avc1(e))},l.mp3=function(e){var t=e.channelCount,p=e.audioSampleRate,n=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,t,0,16,0,0,0,0,p>>>8&255,p&255,0,0]);return l.box(l.types[".mp3"],n)},l.mp4a=function(e){var t=e.channelCount,p=e.audioSampleRate,n=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,t,0,16,0,0,0,0,p>>>8&255,p&255,0,0]);return l.box(l.types.mp4a,n,l.esds(e))},l.esds=function(e){var t=e.config||[],p=t.length,n=new Uint8Array([0,0,0,0,3,23+p,0,1,0,4,15+p,64,21,0,0,0,0,0,0,0,0,0,0,0,5].concat([p]).concat(t).concat([6,1,2]));return l.box(l.types.esds,n)},l.avc1=function(e){var t=e.avcc,p=e.codecWidth,n=e.codecHeight,d=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,p>>>8&255,p&255,n>>>8&255,n&255,0,72,0,0,0,72,0,0,0,0,0,0,0,1,10,120,113,113,47,102,108,118,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,255,255]);return l.box(l.types.avc1,d,l.box(l.types.avcC,t))},l.mvex=function(e){return l.box(l.types.mvex,l.trex(e))},l.trex=function(e){var t=e.id,p=new Uint8Array([0,0,0,0,t>>>24&255,t>>>16&255,t>>>8&255,t&255,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]);return l.box(l.types.trex,p)},l.moof=function(e,t){return l.box(l.types.moof,l.mfhd(e.sequenceNumber),l.traf(e,t))},l.mfhd=function(e){var t=new Uint8Array([0,0,0,0,e>>>24&255,e>>>16&255,e>>>8&255,e&255]);return l.box(l.types.mfhd,t)},l.traf=function(e,t){var p=e.id,n=l.box(l.types.tfhd,new Uint8Array([0,0,0,0,p>>>24&255,p>>>16&255,p>>>8&255,p&255])),d=l.box(l.types.tfdt,new Uint8Array([0,0,0,0,t>>>24&255,t>>>16&255,t>>>8&255,t&255])),c=l.sdtp(e),a=l.trun(e,c.byteLength+16+16+8+16+8+8);return l.box(l.types.traf,n,d,a,c)},l.sdtp=function(e){for(var t=e.samples||[],p=t.length,n=new Uint8Array(4+p),d=0;d<p;d++){var c=t[d].flags;n[d+4]=c.isLeading<<6|c.dependsOn<<4|c.isDependedOn<<2|c.hasRedundancy}return l.box(l.types.sdtp,n)},l.trun=function(e,t){var p=e.samples||[],n=p.length,d=12+16*n,c=new Uint8Array(d);t+=8+d,c.set([0,0,15,1,n>>>24&255,n>>>16&255,n>>>8&255,n&255,t>>>24&255,t>>>16&255,t>>>8&255,t&255],0);for(var a=0;a<n;a++){var r=p[a].duration,h=p[a].size,u=p[a].flags,i=p[a].cts;c.set([r>>>24&255,r>>>16&255,r>>>8&255,r&255,h>>>24&255,h>>>16&255,h>>>8&255,h&255,u.isLeading<<2|u.dependsOn,u.isDependedOn<<6|u.hasRedundancy<<4|u.isNonSync,0,0,i>>>24&255,i>>>16&255,i>>>8&255,i&255],12+16*a)}return l.box(l.types.trun,c)},l.mdat=function(e){return l.box(l.types.mdat,e)},l}();E.init(),g.default=E},"./src/remux/mp4-remuxer.js":function(x,g,m){m.r(g);var E=m("./src/utils/logger.js"),l=m("./src/remux/mp4-generator.js"),e=m("./src/remux/aac-silent.js"),t=m("./src/utils/browser.js"),p=m("./src/core/media-segment-info.js"),n=m("./src/utils/exception.js"),d=function(){function c(a){this.TAG="MP4Remuxer",this._config=a,this._isLive=a.isLive===!0,this._dtsBase=-1,this._dtsBaseInited=!1,this._audioDtsBase=1/0,this._videoDtsBase=1/0,this._audioNextDts=void 0,this._videoNextDts=void 0,this._audioStashedLastSample=null,this._videoStashedLastSample=null,this._audioMeta=null,this._videoMeta=null,this._audioSegmentInfoList=new p.MediaSegmentInfoList("audio"),this._videoSegmentInfoList=new p.MediaSegmentInfoList("video"),this._onInitSegment=null,this._onMediaSegment=null,this._forceFirstIDR=!!(t.default.chrome&&(t.default.version.major<50||t.default.version.major===50&&t.default.version.build<2661)),this._fillSilentAfterSeek=t.default.msedge||t.default.msie,this._mp3UseMpegAudio=!t.default.firefox,this._fillAudioTimestampGap=this._config.fixAudioTimestampGap}return c.prototype.destroy=function(){this._dtsBase=-1,this._dtsBaseInited=!1,this._audioMeta=null,this._videoMeta=null,this._audioSegmentInfoList.clear(),this._audioSegmentInfoList=null,this._videoSegmentInfoList.clear(),this._videoSegmentInfoList=null,this._onInitSegment=null,this._onMediaSegment=null},c.prototype.bindDataSource=function(a){return a.onDataAvailable=this.remux.bind(this),a.onTrackMetadata=this._onTrackMetadataReceived.bind(this),this},Object.defineProperty(c.prototype,"onInitSegment",{get:function(){return this._onInitSegment},set:function(a){this._onInitSegment=a},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"onMediaSegment",{get:function(){return this._onMediaSegment},set:function(a){this._onMediaSegment=a},enumerable:!1,configurable:!0}),c.prototype.insertDiscontinuity=function(){this._audioNextDts=this._videoNextDts=void 0},c.prototype.seek=function(a){this._audioStashedLastSample=null,this._videoStashedLastSample=null,this._videoSegmentInfoList.clear(),this._audioSegmentInfoList.clear()},c.prototype.remux=function(a,r){if(!this._onMediaSegment)throw new n.IllegalStateException("MP4Remuxer: onMediaSegment callback must be specificed!");this._dtsBaseInited||this._calculateDtsBase(a,r),this._remuxVideo(r),this._remuxAudio(a)},c.prototype._onTrackMetadataReceived=function(a,r){var h=null,u="mp4",i=r.codec;if(a==="audio")this._audioMeta=r,r.codec==="mp3"&&this._mp3UseMpegAudio?(u="mpeg",i="",h=new Uint8Array):h=l.default.generateInitSegment(r);else if(a==="video")this._videoMeta=r,h=l.default.generateInitSegment(r);else return;if(!this._onInitSegment)throw new n.IllegalStateException("MP4Remuxer: onInitSegment callback must be specified!");this._onInitSegment(a,{type:a,data:h.buffer,codec:i,container:a+"/"+u,mediaDuration:r.duration})},c.prototype._calculateDtsBase=function(a,r){this._dtsBaseInited||(a.samples&&a.samples.length&&(this._audioDtsBase=a.samples[0].dts),r.samples&&r.samples.length&&(this._videoDtsBase=r.samples[0].dts),this._dtsBase=Math.min(this._audioDtsBase,this._videoDtsBase),this._dtsBaseInited=!0)},c.prototype.flushStashedSamples=function(){var a=this._videoStashedLastSample,r=this._audioStashedLastSample,h={type:"video",id:1,sequenceNumber:0,samples:[],length:0};a!=null&&(h.samples.push(a),h.length=a.length);var u={type:"audio",id:2,sequenceNumber:0,samples:[],length:0};r!=null&&(u.samples.push(r),u.length=r.length),this._videoStashedLastSample=null,this._audioStashedLastSample=null,this._remuxVideo(h,!0),this._remuxAudio(u,!0)},c.prototype._remuxAudio=function(a,r){if(this._audioMeta!=null){var h=a,u=h.samples,i=void 0,o=-1,v=-1,b=this._audioMeta.refSampleDuration,w=this._audioMeta.codec==="mp3"&&this._mp3UseMpegAudio,D=this._dtsBaseInited&&this._audioNextDts===void 0,O=!1;if(!(!u||u.length===0)&&!(u.length===1&&!r)){var L=0,R=null,C=0;w?(L=0,C=h.length):(L=8,C=8+h.length);var I=null;if(u.length>1&&(I=u.pop(),C-=I.length),this._audioStashedLastSample!=null){var M=this._audioStashedLastSample;this._audioStashedLastSample=null,u.unshift(M),C+=M.length}I!=null&&(this._audioStashedLastSample=I);var k=u[0].dts-this._dtsBase;if(this._audioNextDts)i=k-this._audioNextDts;else if(this._audioSegmentInfoList.isEmpty())i=0,this._fillSilentAfterSeek&&!this._videoSegmentInfoList.isEmpty()&&this._audioMeta.originalCodec!=="mp3"&&(O=!0);else{var V=this._audioSegmentInfoList.getLastSampleBefore(k);if(V!=null){var G=k-(V.originalDts+V.duration);G<=3&&(G=0);var N=V.dts+V.duration+G;i=k-N}else i=0}if(O){var H=k-i,$=this._videoSegmentInfoList.getLastSegmentBefore(k);if($!=null&&$.beginDts<H){var j=e.default.getSilentFrame(this._audioMeta.originalCodec,this._audioMeta.channelCount);if(j){var Y=$.beginDts,fe=H-$.beginDts;E.default.v(this.TAG,"InsertPrefixSilentAudio: dts: "+Y+", duration: "+fe),u.unshift({unit:j,dts:Y,pts:Y}),C+=j.byteLength}}else O=!1}for(var Q=[],Z=0;Z<u.length;Z++){var M=u[Z],ce=M.unit,se=M.dts-this._dtsBase,Y=se,he=!1,be=null,J=0;if(!(se<-.001)){if(this._audioMeta.codec!=="mp3"){var W=se,de=3;if(this._audioNextDts&&(W=this._audioNextDts),i=se-W,i<=-de*b){E.default.w(this.TAG,"Dropping 1 audio frame (originalDts: "+se+" ms ,curRefDts: "+W+" ms)  due to dtsCorrection: "+i+" ms overlap.");continue}else if(i>=de*b&&this._fillAudioTimestampGap&&!t.default.safari){he=!0;var ge=Math.floor(i/b);E.default.w(this.TAG,`Large audio timestamp gap detected, may cause AV sync to drift. Silent frames will be generated to avoid unsync.
`+("originalDts: "+se+" ms, curRefDts: "+W+" ms, ")+("dtsCorrection: "+Math.round(i)+" ms, generate: "+ge+" frames")),Y=Math.floor(W),J=Math.floor(W+b)-Y;var j=e.default.getSilentFrame(this._audioMeta.originalCodec,this._audioMeta.channelCount);j==null&&(E.default.w(this.TAG,"Unable to generate silent frame for "+(this._audioMeta.originalCodec+" with "+this._audioMeta.channelCount+" channels, repeat last frame")),j=ce),be=[];for(var De=0;De<ge;De++){W=W+b;var Se=Math.floor(W),Le=Math.floor(W+b)-Se,Pe={dts:Se,pts:Se,cts:0,unit:j,size:j.byteLength,duration:Le,originalDts:se,flags:{isLeading:0,dependsOn:1,isDependedOn:0,hasRedundancy:0}};be.push(Pe),C+=Pe.size}this._audioNextDts=W+b}else Y=Math.floor(W),J=Math.floor(W+b)-Y,this._audioNextDts=W+b}else{if(Y=se-i,Z!==u.length-1){var Be=u[Z+1].dts-this._dtsBase-i;J=Be-Y}else if(I!=null){var Be=I.dts-this._dtsBase-i;J=Be-Y}else Q.length>=1?J=Q[Q.length-1].duration:J=Math.floor(b);this._audioNextDts=Y+J}o===-1&&(o=Y),Q.push({dts:Y,pts:Y,cts:0,unit:M.unit,size:M.unit.byteLength,duration:J,originalDts:se,flags:{isLeading:0,dependsOn:1,isDependedOn:0,hasRedundancy:0}}),he&&Q.push.apply(Q,be)}}if(Q.length===0){h.samples=[],h.length=0;return}w?R=new Uint8Array(C):(R=new Uint8Array(C),R[0]=C>>>24&255,R[1]=C>>>16&255,R[2]=C>>>8&255,R[3]=C&255,R.set(l.default.types.mdat,4));for(var Z=0;Z<Q.length;Z++){var ce=Q[Z].unit;R.set(ce,L),L+=ce.byteLength}var xe=Q[Q.length-1];v=xe.dts+xe.duration;var _e=new p.MediaSegmentInfo;_e.beginDts=o,_e.endDts=v,_e.beginPts=o,_e.endPts=v,_e.originalBeginDts=Q[0].originalDts,_e.originalEndDts=xe.originalDts+xe.duration,_e.firstSample=new p.SampleInfo(Q[0].dts,Q[0].pts,Q[0].duration,Q[0].originalDts,!1),_e.lastSample=new p.SampleInfo(xe.dts,xe.pts,xe.duration,xe.originalDts,!1),this._isLive||this._audioSegmentInfoList.append(_e),h.samples=Q,h.sequenceNumber++;var ze=null;w?ze=new Uint8Array:ze=l.default.moof(h,o),h.samples=[],h.length=0;var qe={type:"audio",data:this._mergeBoxes(ze,R).buffer,sampleCount:Q.length,info:_e};w&&D&&(qe.timestampOffset=o),this._onMediaSegment("audio",qe)}}},c.prototype._remuxVideo=function(a,r){if(this._videoMeta!=null){var h=a,u=h.samples,i=void 0,o=-1,v=-1,b=-1,w=-1;if(!(!u||u.length===0)&&!(u.length===1&&!r)){var D=8,O=null,L=8+a.length,R=null;if(u.length>1&&(R=u.pop(),L-=R.length),this._videoStashedLastSample!=null){var C=this._videoStashedLastSample;this._videoStashedLastSample=null,u.unshift(C),L+=C.length}R!=null&&(this._videoStashedLastSample=R);var I=u[0].dts-this._dtsBase;if(this._videoNextDts)i=I-this._videoNextDts;else if(this._videoSegmentInfoList.isEmpty())i=0;else{var M=this._videoSegmentInfoList.getLastSampleBefore(I);if(M!=null){var k=I-(M.originalDts+M.duration);k<=3&&(k=0);var V=M.dts+M.duration+k;i=I-V}else i=0}for(var G=new p.MediaSegmentInfo,N=[],H=0;H<u.length;H++){var C=u[H],$=C.dts-this._dtsBase,j=C.isKeyframe,Y=$-i,fe=C.cts,Q=Y+fe;o===-1&&(o=Y,b=Q);var Z=0;if(H!==u.length-1){var ce=u[H+1].dts-this._dtsBase-i;Z=ce-Y}else if(R!=null){var ce=R.dts-this._dtsBase-i;Z=ce-Y}else N.length>=1?Z=N[N.length-1].duration:Z=Math.floor(this._videoMeta.refSampleDuration);if(j){var se=new p.SampleInfo(Y,Q,Z,C.dts,!0);se.fileposition=C.fileposition,G.appendSyncPoint(se)}N.push({dts:Y,pts:Q,cts:fe,units:C.units,size:C.length,isKeyframe:j,duration:Z,originalDts:$,flags:{isLeading:0,dependsOn:j?2:1,isDependedOn:j?1:0,hasRedundancy:0,isNonSync:j?0:1}})}O=new Uint8Array(L),O[0]=L>>>24&255,O[1]=L>>>16&255,O[2]=L>>>8&255,O[3]=L&255,O.set(l.default.types.mdat,4);for(var H=0;H<N.length;H++)for(var he=N[H].units;he.length;){var be=he.shift(),J=be.data;O.set(J,D),D+=J.byteLength}var W=N[N.length-1];if(v=W.dts+W.duration,w=W.pts+W.duration,this._videoNextDts=v,G.beginDts=o,G.endDts=v,G.beginPts=b,G.endPts=w,G.originalBeginDts=N[0].originalDts,G.originalEndDts=W.originalDts+W.duration,G.firstSample=new p.SampleInfo(N[0].dts,N[0].pts,N[0].duration,N[0].originalDts,N[0].isKeyframe),G.lastSample=new p.SampleInfo(W.dts,W.pts,W.duration,W.originalDts,W.isKeyframe),this._isLive||this._videoSegmentInfoList.append(G),h.samples=N,h.sequenceNumber++,this._forceFirstIDR){var de=N[0].flags;de.dependsOn=2,de.isNonSync=0}var ge=l.default.moof(h,o);h.samples=[],h.length=0,this._onMediaSegment("video",{type:"video",data:this._mergeBoxes(ge,O).buffer,sampleCount:N.length,info:G})}}},c.prototype._mergeBoxes=function(a,r){var h=new Uint8Array(a.byteLength+r.byteLength);return h.set(a,0),h.set(r,a.byteLength),h},c}();g.default=d},"./src/utils/browser.js":function(x,g,m){m.r(g);var E={};function l(){var e=self.navigator.userAgent.toLowerCase(),t=/(edge)\/([\w.]+)/.exec(e)||/(opr)[\/]([\w.]+)/.exec(e)||/(chrome)[ \/]([\w.]+)/.exec(e)||/(iemobile)[\/]([\w.]+)/.exec(e)||/(version)(applewebkit)[ \/]([\w.]+).*(safari)[ \/]([\w.]+)/.exec(e)||/(webkit)[ \/]([\w.]+).*(version)[ \/]([\w.]+).*(safari)[ \/]([\w.]+)/.exec(e)||/(webkit)[ \/]([\w.]+)/.exec(e)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(e)||/(msie) ([\w.]+)/.exec(e)||e.indexOf("trident")>=0&&/(rv)(?::| )([\w.]+)/.exec(e)||e.indexOf("compatible")<0&&/(firefox)[ \/]([\w.]+)/.exec(e)||[],p=/(ipad)/.exec(e)||/(ipod)/.exec(e)||/(windows phone)/.exec(e)||/(iphone)/.exec(e)||/(kindle)/.exec(e)||/(android)/.exec(e)||/(windows)/.exec(e)||/(mac)/.exec(e)||/(linux)/.exec(e)||/(cros)/.exec(e)||[],n={browser:t[5]||t[3]||t[1]||"",version:t[2]||t[4]||"0",majorVersion:t[4]||t[2]||"0",platform:p[0]||""},d={};if(n.browser){d[n.browser]=!0;var c=n.majorVersion.split(".");d.version={major:parseInt(n.majorVersion,10),string:n.version},c.length>1&&(d.version.minor=parseInt(c[1],10)),c.length>2&&(d.version.build=parseInt(c[2],10))}if(n.platform&&(d[n.platform]=!0),(d.chrome||d.opr||d.safari)&&(d.webkit=!0),d.rv||d.iemobile){d.rv&&delete d.rv;var a="msie";n.browser=a,d[a]=!0}if(d.edge){delete d.edge;var r="msedge";n.browser=r,d[r]=!0}if(d.opr){var h="opera";n.browser=h,d[h]=!0}if(d.safari&&d.android){var u="android";n.browser=u,d[u]=!0}d.name=n.browser,d.platform=n.platform;for(var i in E)E.hasOwnProperty(i)&&delete E[i];Object.assign(E,d)}l(),g.default=E},"./src/utils/exception.js":function(x,g,m){m.r(g),m.d(g,{RuntimeException:function(){return l},IllegalStateException:function(){return e},InvalidArgumentException:function(){return t},NotImplementedException:function(){return p}});var E=function(){var n=function(d,c){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,r){a.__proto__=r}||function(a,r){for(var h in r)Object.prototype.hasOwnProperty.call(r,h)&&(a[h]=r[h])},n(d,c)};return function(d,c){if(typeof c!="function"&&c!==null)throw new TypeError("Class extends value "+String(c)+" is not a constructor or null");n(d,c);function a(){this.constructor=d}d.prototype=c===null?Object.create(c):(a.prototype=c.prototype,new a)}}(),l=function(){function n(d){this._message=d}return Object.defineProperty(n.prototype,"name",{get:function(){return"RuntimeException"},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"message",{get:function(){return this._message},enumerable:!1,configurable:!0}),n.prototype.toString=function(){return this.name+": "+this.message},n}(),e=function(n){E(d,n);function d(c){return n.call(this,c)||this}return Object.defineProperty(d.prototype,"name",{get:function(){return"IllegalStateException"},enumerable:!1,configurable:!0}),d}(l),t=function(n){E(d,n);function d(c){return n.call(this,c)||this}return Object.defineProperty(d.prototype,"name",{get:function(){return"InvalidArgumentException"},enumerable:!1,configurable:!0}),d}(l),p=function(n){E(d,n);function d(c){return n.call(this,c)||this}return Object.defineProperty(d.prototype,"name",{get:function(){return"NotImplementedException"},enumerable:!1,configurable:!0}),d}(l)},"./src/utils/logger.js":function(x,g,m){m.r(g);var E=m("./node_modules/events/events.js"),l=m.n(E),e=function(){function t(){}return t.e=function(p,n){(!p||t.FORCE_GLOBAL_TAG)&&(p=t.GLOBAL_TAG);var d="["+p+"] > "+n;t.ENABLE_CALLBACK&&t.emitter.emit("log","error",d),!!t.ENABLE_ERROR&&(console.error?console.error(d):console.warn?console.warn(d):console.log(d))},t.i=function(p,n){(!p||t.FORCE_GLOBAL_TAG)&&(p=t.GLOBAL_TAG);var d="["+p+"] > "+n;t.ENABLE_CALLBACK&&t.emitter.emit("log","info",d),!!t.ENABLE_INFO&&(console.info?console.info(d):console.log(d))},t.w=function(p,n){(!p||t.FORCE_GLOBAL_TAG)&&(p=t.GLOBAL_TAG);var d="["+p+"] > "+n;t.ENABLE_CALLBACK&&t.emitter.emit("log","warn",d),!!t.ENABLE_WARN&&(console.warn?console.warn(d):console.log(d))},t.d=function(p,n){(!p||t.FORCE_GLOBAL_TAG)&&(p=t.GLOBAL_TAG);var d="["+p+"] > "+n;t.ENABLE_CALLBACK&&t.emitter.emit("log","debug",d),!!t.ENABLE_DEBUG&&(console.debug?console.debug(d):console.log(d))},t.v=function(p,n){(!p||t.FORCE_GLOBAL_TAG)&&(p=t.GLOBAL_TAG);var d="["+p+"] > "+n;t.ENABLE_CALLBACK&&t.emitter.emit("log","verbose",d),!!t.ENABLE_VERBOSE&&console.log(d)},t}();e.GLOBAL_TAG="flv.js",e.FORCE_GLOBAL_TAG=!1,e.ENABLE_ERROR=!0,e.ENABLE_INFO=!0,e.ENABLE_WARN=!0,e.ENABLE_DEBUG=!0,e.ENABLE_VERBOSE=!0,e.ENABLE_CALLBACK=!1,e.emitter=new(l()),g.default=e},"./src/utils/logging-control.js":function(x,g,m){m.r(g);var E=m("./node_modules/events/events.js"),l=m.n(E),e=m("./src/utils/logger.js"),t=function(){function p(){}return Object.defineProperty(p,"forceGlobalTag",{get:function(){return e.default.FORCE_GLOBAL_TAG},set:function(n){e.default.FORCE_GLOBAL_TAG=n,p._notifyChange()},enumerable:!1,configurable:!0}),Object.defineProperty(p,"globalTag",{get:function(){return e.default.GLOBAL_TAG},set:function(n){e.default.GLOBAL_TAG=n,p._notifyChange()},enumerable:!1,configurable:!0}),Object.defineProperty(p,"enableAll",{get:function(){return e.default.ENABLE_VERBOSE&&e.default.ENABLE_DEBUG&&e.default.ENABLE_INFO&&e.default.ENABLE_WARN&&e.default.ENABLE_ERROR},set:function(n){e.default.ENABLE_VERBOSE=n,e.default.ENABLE_DEBUG=n,e.default.ENABLE_INFO=n,e.default.ENABLE_WARN=n,e.default.ENABLE_ERROR=n,p._notifyChange()},enumerable:!1,configurable:!0}),Object.defineProperty(p,"enableDebug",{get:function(){return e.default.ENABLE_DEBUG},set:function(n){e.default.ENABLE_DEBUG=n,p._notifyChange()},enumerable:!1,configurable:!0}),Object.defineProperty(p,"enableVerbose",{get:function(){return e.default.ENABLE_VERBOSE},set:function(n){e.default.ENABLE_VERBOSE=n,p._notifyChange()},enumerable:!1,configurable:!0}),Object.defineProperty(p,"enableInfo",{get:function(){return e.default.ENABLE_INFO},set:function(n){e.default.ENABLE_INFO=n,p._notifyChange()},enumerable:!1,configurable:!0}),Object.defineProperty(p,"enableWarn",{get:function(){return e.default.ENABLE_WARN},set:function(n){e.default.ENABLE_WARN=n,p._notifyChange()},enumerable:!1,configurable:!0}),Object.defineProperty(p,"enableError",{get:function(){return e.default.ENABLE_ERROR},set:function(n){e.default.ENABLE_ERROR=n,p._notifyChange()},enumerable:!1,configurable:!0}),p.getConfig=function(){return{globalTag:e.default.GLOBAL_TAG,forceGlobalTag:e.default.FORCE_GLOBAL_TAG,enableVerbose:e.default.ENABLE_VERBOSE,enableDebug:e.default.ENABLE_DEBUG,enableInfo:e.default.ENABLE_INFO,enableWarn:e.default.ENABLE_WARN,enableError:e.default.ENABLE_ERROR,enableCallback:e.default.ENABLE_CALLBACK}},p.applyConfig=function(n){e.default.GLOBAL_TAG=n.globalTag,e.default.FORCE_GLOBAL_TAG=n.forceGlobalTag,e.default.ENABLE_VERBOSE=n.enableVerbose,e.default.ENABLE_DEBUG=n.enableDebug,e.default.ENABLE_INFO=n.enableInfo,e.default.ENABLE_WARN=n.enableWarn,e.default.ENABLE_ERROR=n.enableError,e.default.ENABLE_CALLBACK=n.enableCallback},p._notifyChange=function(){var n=p.emitter;if(n.listenerCount("change")>0){var d=p.getConfig();n.emit("change",d)}},p.registerListener=function(n){p.emitter.addListener("change",n)},p.removeListener=function(n){p.emitter.removeListener("change",n)},p.addLogListener=function(n){e.default.emitter.addListener("log",n),e.default.emitter.listenerCount("log")>0&&(e.default.ENABLE_CALLBACK=!0,p._notifyChange())},p.removeLogListener=function(n){e.default.emitter.removeListener("log",n),e.default.emitter.listenerCount("log")===0&&(e.default.ENABLE_CALLBACK=!1,p._notifyChange())},p}();t.emitter=new(l()),g.default=t},"./src/utils/polyfill.js":function(x,g,m){m.r(g);var E=function(){function l(){}return l.install=function(){Object.setPrototypeOf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Object.assign=Object.assign||function(e){if(e==null)throw new TypeError("Cannot convert undefined or null to object");for(var t=Object(e),p=1;p<arguments.length;p++){var n=arguments[p];if(n!=null)for(var d in n)n.hasOwnProperty(d)&&(t[d]=n[d])}return t},typeof self.Promise!="function"&&m("./node_modules/es6-promise/dist/es6-promise.js").polyfill()},l}();E.install(),g.default=E},"./src/utils/utf8-conv.js":function(x,g,m){m.r(g);function E(e,t,p){var n=e;if(t+p<n.length){for(;p--;)if((n[++t]&192)!=128)return!1;return!0}else return!1}function l(e){for(var t=[],p=e,n=0,d=e.length;n<d;){if(p[n]<128){t.push(String.fromCharCode(p[n])),++n;continue}else if(!(p[n]<192)){if(p[n]<224){if(E(p,n,1)){var c=(p[n]&31)<<6|p[n+1]&63;if(c>=128){t.push(String.fromCharCode(c&65535)),n+=2;continue}}}else if(p[n]<240){if(E(p,n,2)){var c=(p[n]&15)<<12|(p[n+1]&63)<<6|p[n+2]&63;if(c>=2048&&(c&63488)!=55296){t.push(String.fromCharCode(c&65535)),n+=3;continue}}}else if(p[n]<248&&E(p,n,3)){var c=(p[n]&7)<<18|(p[n+1]&63)<<12|(p[n+2]&63)<<6|p[n+3]&63;if(c>65536&&c<1114112){c-=65536,t.push(String.fromCharCode(c>>>10|55296)),t.push(String.fromCharCode(c&1023|56320)),n+=4;continue}}}t.push(String.fromCharCode(65533)),++n}return t.join("")}g.default=l}},f={};function A(x){var g=f[x];if(g!==void 0)return g.exports;var m=f[x]={exports:{}};return _[x].call(m.exports,m,m.exports,A),m.exports}A.m=_,function(){A.n=function(x){var g=x&&x.__esModule?function(){return x.default}:function(){return x};return A.d(g,{a:g}),g}}(),function(){A.d=function(x,g){for(var m in g)A.o(g,m)&&!A.o(x,m)&&Object.defineProperty(x,m,{enumerable:!0,get:g[m]})}}(),function(){A.g=function(){if(typeof globalThis=="object")return globalThis;try{return this||new Function("return this")()}catch{if(typeof window=="object")return window}}()}(),function(){A.o=function(x,g){return Object.prototype.hasOwnProperty.call(x,g)}}(),function(){A.r=function(x){typeof Symbol!="undefined"&&Symbol.toStringTag&&Object.defineProperty(x,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(x,"__esModule",{value:!0})}}();var S=A("./src/index.js");return S}()})})(Nt);var Wt=Li(Nt.exports);const Ci={class:"w-100 h-100 m-auto",style:{"background-color":"black"}},Ti=["volume"],Mi={key:0,class:"position-absolute w-100 h-100 bg-dark",style:{left:"0%",right:"0%",top:"0%",bottom:"0%","min-width":"100%","min-height":"100%","z-index":"5"}},Ii=P("div",{class:"d-flex flex-column justify-content-center"},[P("h3",{class:"h3 text-light align-self-center"},"\u4E0D\u652F\u6301\u8BE5\u6D4F\u89C8\u5668")],-1),Pi=[Ii],Hn=ke({props:{video_src:null,volume:null,playing:{type:Boolean}},setup(y){const s=y;var _;const f=ie(),A=ie(!1);return ht(()=>s.video_src,()=>{console.log(s.video_src),Wt.isSupported()?(_=Wt.createPlayer({type:"flv",url:s.video_src,isLive:!0,cors:!0}),_.attachMediaElement(f.value),_.load()):A.value=!0}),ht(()=>s.playing,()=>{s.playing?_.play():_.pause(),console.log(s.video_src)}),Ai(()=>{}),(S,x)=>(ae(),pe("div",Ci,[P("video",{volume:y.volume,class:"w-100 m-0",style:{"min-height":"100%","z-index":"1"},ref:(g,m)=>{m.videoElement=g,f.value=g}},null,8,Ti),A.value?(ae(),pe("div",Mi,Pi)):Dt("",!0)]))}}),Bi={class:"px-4 py-3 d-flex flex-column justify-content-center needs-validation",novalidate:"",style:{"min-width":"20em"}},Fi={class:"form-row"},ki=P("label",{for:"userInputBox"},"\u7528\u6237",-1),Ui={class:"invalid-feedback"},ji=P("div",{class:"valid-feedback"},null,-1),Ni={class:"form-row"},Wi=P("label",{for:"userPasswordInputBox"},"\u5BC6\u7801",-1),Vi={class:"invalid-feedback"},Gi=P("div",{class:"valid-feedback"},null,-1),Ki=P("a",{class:"form-text",href:"javascript:;"},"\u5FD8\u8BB0\u5BC6\u7801\uFF1F",-1),zi=P("br",null,null,-1),Hi=["disabled"],Xi={key:0},Yi={key:1,class:"spinner-border text-light small",role:"status"},$i=P("span",{class:"sr-only"},"Loading...",-1),Qi=[$i],Zi=ke({setup(y){const s=new Ut,_=ie(""),f=ie(""),A=Ae("userStore"),S=Ae("errorModal");Ct(()=>{tt(()=>{if(A.logined)throw"\u4F7F\u7528\u767B\u5F55\u9762\u677F\u524D\u8BF7\u5148\u6CE8\u9500"})}),wi(()=>{});function x(){Oi.push("/signup")}const g=ie(!1),m=ie(!1),E=ie(!1),l=ie(),e=ie();function t(){g.value=!0,s.login({name:_.value,password:f.value}).then(p=>{A.login(p)}).catch(p=>{p.errors.Name!==void 0&&(m.value=!0,l.value=p.errors.Name[0]),p.errors.Password!==void 0&&(E.value=!0,e.value=p.errors.Password[0])}).catch(()=>{S.value.show()}).finally(()=>{g.value=!1})}return(p,n)=>(ae(),pe("form",Bi,[P("div",Fi,[ki,dt(P("input",{type:"text",class:Tt(["form-control",{"is-invalid":m.value}]),"onUpdate:modelValue":n[0]||(n[0]=d=>_.value=d),id:"userInputBox",required:"",onChange:n[1]||(n[1]=d=>m.value=!1)},null,34),[[ft,_.value]]),P("div",Ui,Ue(l.value),1),ji]),P("div",Ni,[Wi,dt(P("input",{type:"password",class:Tt(["form-control",{"is-invalid":E.value}]),"onUpdate:modelValue":n[2]||(n[2]=d=>f.value=d),id:"userPasswordInputBox",required:"",onChange:n[3]||(n[3]=d=>E.value=!1)},null,34),[[ft,f.value]]),P("div",Vi,Ue(e.value),1),Gi]),P("div",{class:"d-flex flex-row justify-content-between"},[Ki,P("a",{class:"form-text",href:"javascript:;",onClick:x},"\u6CE8\u518C")]),zi,P("button",{type:"submit",class:"btn btn-primary w-25",onClick:t,disabled:g.value},[g.value?(ae(),pe("div",Yi,Qi)):(ae(),pe("span",Xi,"\u767B\u5F55"))],8,Hi)]))}});/*!
 * Cropper.js v1.5.12
 * https://fengyuanchen.github.io/cropperjs
 *
 * Copyright 2015-present Chen Fengyuan
 * Released under the MIT license
 *
 * Date: 2021-06-12T08:00:17.411Z
 */function Vt(y,s){var _=Object.keys(y);if(Object.getOwnPropertySymbols){var f=Object.getOwnPropertySymbols(y);s&&(f=f.filter(function(A){return Object.getOwnPropertyDescriptor(y,A).enumerable})),_.push.apply(_,f)}return _}function Gt(y){for(var s=1;s<arguments.length;s++){var _=arguments[s]!=null?arguments[s]:{};s%2?Vt(Object(_),!0).forEach(function(f){er(y,f,_[f])}):Object.getOwnPropertyDescriptors?Object.defineProperties(y,Object.getOwnPropertyDescriptors(_)):Vt(Object(_)).forEach(function(f){Object.defineProperty(y,f,Object.getOwnPropertyDescriptor(_,f))})}return y}function rt(y){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?rt=function(s){return typeof s}:rt=function(s){return s&&typeof Symbol=="function"&&s.constructor===Symbol&&s!==Symbol.prototype?"symbol":typeof s},rt(y)}function Ji(y,s){if(!(y instanceof s))throw new TypeError("Cannot call a class as a function")}function Kt(y,s){for(var _=0;_<s.length;_++){var f=s[_];f.enumerable=f.enumerable||!1,f.configurable=!0,"value"in f&&(f.writable=!0),Object.defineProperty(y,f.key,f)}}function qi(y,s,_){return s&&Kt(y.prototype,s),_&&Kt(y,_),y}function er(y,s,_){return s in y?Object.defineProperty(y,s,{value:_,enumerable:!0,configurable:!0,writable:!0}):y[s]=_,y}function zt(y){return tr(y)||ir(y)||rr(y)||nr()}function tr(y){if(Array.isArray(y))return ct(y)}function ir(y){if(typeof Symbol!="undefined"&&y[Symbol.iterator]!=null||y["@@iterator"]!=null)return Array.from(y)}function rr(y,s){if(!!y){if(typeof y=="string")return ct(y,s);var _=Object.prototype.toString.call(y).slice(8,-1);if(_==="Object"&&y.constructor&&(_=y.constructor.name),_==="Map"||_==="Set")return Array.from(y);if(_==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(_))return ct(y,s)}}function ct(y,s){(s==null||s>y.length)&&(s=y.length);for(var _=0,f=new Array(s);_<s;_++)f[_]=y[_];return f}function nr(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var nt=typeof window!="undefined"&&typeof window.document!="undefined",Ee=nt?window:{},_t=nt&&Ee.document.documentElement?"ontouchstart"in Ee.document.documentElement:!1,pt=nt?"PointerEvent"in Ee:!1,q="cropper",mt="all",Ht="crop",Xt="move",Yt="zoom",Ce="e",Te="w",Ne="s",we="n",He="ne",Xe="nw",Ye="se",$e="sw",vt="".concat(q,"-crop"),$t="".concat(q,"-disabled"),le="".concat(q,"-hidden"),Qt="".concat(q,"-hide"),sr="".concat(q,"-invisible"),st="".concat(q,"-modal"),gt="".concat(q,"-move"),Qe="".concat(q,"Action"),at="".concat(q,"Preview"),xt="crop",Zt="move",Jt="none",Et="crop",yt="cropend",bt="cropmove",St="cropstart",qt="dblclick",ar=_t?"touchstart":"mousedown",or=_t?"touchmove":"mousemove",lr=_t?"touchend touchcancel":"mouseup",ei=pt?"pointerdown":ar,ti=pt?"pointermove":or,ii=pt?"pointerup pointercancel":lr,ri="ready",ni="resize",si="wheel",Lt="zoom",ai="image/jpeg",ur=/^e|w|s|n|se|sw|ne|nw|all|crop|move|zoom$/,hr=/^data:/,dr=/^data:image\/jpeg;base64,/,fr=/^img|canvas$/i,oi=200,li=100,ui={viewMode:0,dragMode:xt,initialAspectRatio:NaN,aspectRatio:NaN,data:null,preview:"",responsive:!0,restore:!0,checkCrossOrigin:!0,checkOrientation:!0,modal:!0,guides:!0,center:!0,highlight:!0,background:!0,autoCrop:!0,autoCropArea:.8,movable:!0,rotatable:!0,scalable:!0,zoomable:!0,zoomOnTouch:!0,zoomOnWheel:!0,wheelZoomRatio:.1,cropBoxMovable:!0,cropBoxResizable:!0,toggleDragModeOnDblclick:!0,minCanvasWidth:0,minCanvasHeight:0,minCropBoxWidth:0,minCropBoxHeight:0,minContainerWidth:oi,minContainerHeight:li,ready:null,cropstart:null,cropmove:null,cropend:null,crop:null,zoom:null},cr='<div class="cropper-container" touch-action="none"><div class="cropper-wrap-box"><div class="cropper-canvas"></div></div><div class="cropper-drag-box"></div><div class="cropper-crop-box"><span class="cropper-view-box"></span><span class="cropper-dashed dashed-h"></span><span class="cropper-dashed dashed-v"></span><span class="cropper-center"></span><span class="cropper-face"></span><span class="cropper-line line-e" data-cropper-action="e"></span><span class="cropper-line line-n" data-cropper-action="n"></span><span class="cropper-line line-w" data-cropper-action="w"></span><span class="cropper-line line-s" data-cropper-action="s"></span><span class="cropper-point point-e" data-cropper-action="e"></span><span class="cropper-point point-n" data-cropper-action="n"></span><span class="cropper-point point-w" data-cropper-action="w"></span><span class="cropper-point point-s" data-cropper-action="s"></span><span class="cropper-point point-ne" data-cropper-action="ne"></span><span class="cropper-point point-nw" data-cropper-action="nw"></span><span class="cropper-point point-sw" data-cropper-action="sw"></span><span class="cropper-point point-se" data-cropper-action="se"></span></div></div>',_r=Number.isNaN||Ee.isNaN;function X(y){return typeof y=="number"&&!_r(y)}var hi=function(s){return s>0&&s<1/0};function At(y){return typeof y=="undefined"}function Me(y){return rt(y)==="object"&&y!==null}var pr=Object.prototype.hasOwnProperty;function We(y){if(!Me(y))return!1;try{var s=y.constructor,_=s.prototype;return s&&_&&pr.call(_,"isPrototypeOf")}catch{return!1}}function ue(y){return typeof y=="function"}var mr=Array.prototype.slice;function di(y){return Array.from?Array.from(y):mr.call(y)}function te(y,s){return y&&ue(s)&&(Array.isArray(y)||X(y.length)?di(y).forEach(function(_,f){s.call(y,_,f,y)}):Me(y)&&Object.keys(y).forEach(function(_){s.call(y,y[_],_,y)})),y}var ee=Object.assign||function(s){for(var _=arguments.length,f=new Array(_>1?_-1:0),A=1;A<_;A++)f[A-1]=arguments[A];return Me(s)&&f.length>0&&f.forEach(function(S){Me(S)&&Object.keys(S).forEach(function(x){s[x]=S[x]})}),s},vr=/\.\d*(?:0|9){12}\d*$/;function Ve(y){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1e11;return vr.test(y)?Math.round(y*s)/s:y}var gr=/^width|height|left|top|marginLeft|marginTop$/;function Re(y,s){var _=y.style;te(s,function(f,A){gr.test(A)&&X(f)&&(f="".concat(f,"px")),_[A]=f})}function xr(y,s){return y.classList?y.classList.contains(s):y.className.indexOf(s)>-1}function ne(y,s){if(!!s){if(X(y.length)){te(y,function(f){ne(f,s)});return}if(y.classList){y.classList.add(s);return}var _=y.className.trim();_?_.indexOf(s)<0&&(y.className="".concat(_," ").concat(s)):y.className=s}}function ye(y,s){if(!!s){if(X(y.length)){te(y,function(_){ye(_,s)});return}if(y.classList){y.classList.remove(s);return}y.className.indexOf(s)>=0&&(y.className=y.className.replace(s,""))}}function Ge(y,s,_){if(!!s){if(X(y.length)){te(y,function(f){Ge(f,s,_)});return}_?ne(y,s):ye(y,s)}}var Er=/([a-z\d])([A-Z])/g;function wt(y){return y.replace(Er,"$1-$2").toLowerCase()}function Rt(y,s){return Me(y[s])?y[s]:y.dataset?y.dataset[s]:y.getAttribute("data-".concat(wt(s)))}function Ze(y,s,_){Me(_)?y[s]=_:y.dataset?y.dataset[s]=_:y.setAttribute("data-".concat(wt(s)),_)}function yr(y,s){if(Me(y[s]))try{delete y[s]}catch{y[s]=void 0}else if(y.dataset)try{delete y.dataset[s]}catch{y.dataset[s]=void 0}else y.removeAttribute("data-".concat(wt(s)))}var fi=/\s\s*/,ci=function(){var y=!1;if(nt){var s=!1,_=function(){},f=Object.defineProperty({},"once",{get:function(){return y=!0,s},set:function(S){s=S}});Ee.addEventListener("test",_,f),Ee.removeEventListener("test",_,f)}return y}();function ve(y,s,_){var f=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{},A=_;s.trim().split(fi).forEach(function(S){if(!ci){var x=y.listeners;x&&x[S]&&x[S][_]&&(A=x[S][_],delete x[S][_],Object.keys(x[S]).length===0&&delete x[S],Object.keys(x).length===0&&delete y.listeners)}y.removeEventListener(S,A,f)})}function me(y,s,_){var f=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{},A=_;s.trim().split(fi).forEach(function(S){if(f.once&&!ci){var x=y.listeners,g=x===void 0?{}:x;A=function(){delete g[S][_],y.removeEventListener(S,A,f);for(var E=arguments.length,l=new Array(E),e=0;e<E;e++)l[e]=arguments[e];_.apply(y,l)},g[S]||(g[S]={}),g[S][_]&&y.removeEventListener(S,g[S][_],f),g[S][_]=A,y.listeners=g}y.addEventListener(S,A,f)})}function Ke(y,s,_){var f;return ue(Event)&&ue(CustomEvent)?f=new CustomEvent(s,{detail:_,bubbles:!0,cancelable:!0}):(f=document.createEvent("CustomEvent"),f.initCustomEvent(s,!0,!0,_)),y.dispatchEvent(f)}function _i(y){var s=y.getBoundingClientRect();return{left:s.left+(window.pageXOffset-document.documentElement.clientLeft),top:s.top+(window.pageYOffset-document.documentElement.clientTop)}}var Ot=Ee.location,br=/^(\w+:)\/\/([^:/?#]*):?(\d*)/i;function pi(y){var s=y.match(br);return s!==null&&(s[1]!==Ot.protocol||s[2]!==Ot.hostname||s[3]!==Ot.port)}function mi(y){var s="timestamp=".concat(new Date().getTime());return y+(y.indexOf("?")===-1?"?":"&")+s}function Je(y){var s=y.rotate,_=y.scaleX,f=y.scaleY,A=y.translateX,S=y.translateY,x=[];X(A)&&A!==0&&x.push("translateX(".concat(A,"px)")),X(S)&&S!==0&&x.push("translateY(".concat(S,"px)")),X(s)&&s!==0&&x.push("rotate(".concat(s,"deg)")),X(_)&&_!==1&&x.push("scaleX(".concat(_,")")),X(f)&&f!==1&&x.push("scaleY(".concat(f,")"));var g=x.length?x.join(" "):"none";return{WebkitTransform:g,msTransform:g,transform:g}}function Sr(y){var s=Gt({},y),_=0;return te(y,function(f,A){delete s[A],te(s,function(S){var x=Math.abs(f.startX-S.startX),g=Math.abs(f.startY-S.startY),m=Math.abs(f.endX-S.endX),E=Math.abs(f.endY-S.endY),l=Math.sqrt(x*x+g*g),e=Math.sqrt(m*m+E*E),t=(e-l)/l;Math.abs(t)>Math.abs(_)&&(_=t)})}),_}function ot(y,s){var _=y.pageX,f=y.pageY,A={endX:_,endY:f};return s?A:Gt({startX:_,startY:f},A)}function Lr(y){var s=0,_=0,f=0;return te(y,function(A){var S=A.startX,x=A.startY;s+=S,_+=x,f+=1}),s/=f,_/=f,{pageX:s,pageY:_}}function Oe(y){var s=y.aspectRatio,_=y.height,f=y.width,A=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"contain",S=hi(f),x=hi(_);if(S&&x){var g=_*s;A==="contain"&&g>f||A==="cover"&&g<f?_=f/s:f=_*s}else S?_=f/s:x&&(f=_*s);return{width:f,height:_}}function Ar(y){var s=y.width,_=y.height,f=y.degree;if(f=Math.abs(f)%180,f===90)return{width:_,height:s};var A=f%90*Math.PI/180,S=Math.sin(A),x=Math.cos(A),g=s*x+_*S,m=s*S+_*x;return f>90?{width:m,height:g}:{width:g,height:m}}function wr(y,s,_,f){var A=s.aspectRatio,S=s.naturalWidth,x=s.naturalHeight,g=s.rotate,m=g===void 0?0:g,E=s.scaleX,l=E===void 0?1:E,e=s.scaleY,t=e===void 0?1:e,p=_.aspectRatio,n=_.naturalWidth,d=_.naturalHeight,c=f.fillColor,a=c===void 0?"transparent":c,r=f.imageSmoothingEnabled,h=r===void 0?!0:r,u=f.imageSmoothingQuality,i=u===void 0?"low":u,o=f.maxWidth,v=o===void 0?1/0:o,b=f.maxHeight,w=b===void 0?1/0:b,D=f.minWidth,O=D===void 0?0:D,L=f.minHeight,R=L===void 0?0:L,C=document.createElement("canvas"),I=C.getContext("2d"),M=Oe({aspectRatio:p,width:v,height:w}),k=Oe({aspectRatio:p,width:O,height:R},"cover"),V=Math.min(M.width,Math.max(k.width,n)),G=Math.min(M.height,Math.max(k.height,d)),N=Oe({aspectRatio:A,width:v,height:w}),H=Oe({aspectRatio:A,width:O,height:R},"cover"),$=Math.min(N.width,Math.max(H.width,S)),j=Math.min(N.height,Math.max(H.height,x)),Y=[-$/2,-j/2,$,j];return C.width=Ve(V),C.height=Ve(G),I.fillStyle=a,I.fillRect(0,0,V,G),I.save(),I.translate(V/2,G/2),I.rotate(m*Math.PI/180),I.scale(l,t),I.imageSmoothingEnabled=h,I.imageSmoothingQuality=i,I.drawImage.apply(I,[y].concat(zt(Y.map(function(fe){return Math.floor(Ve(fe))})))),I.restore(),C}var vi=String.fromCharCode;function Rr(y,s,_){var f="";_+=s;for(var A=s;A<_;A+=1)f+=vi(y.getUint8(A));return f}var Or=/^data:.*,/;function Dr(y){var s=y.replace(Or,""),_=atob(s),f=new ArrayBuffer(_.length),A=new Uint8Array(f);return te(A,function(S,x){A[x]=_.charCodeAt(x)}),f}function Cr(y,s){for(var _=[],f=8192,A=new Uint8Array(y);A.length>0;)_.push(vi.apply(null,di(A.subarray(0,f)))),A=A.subarray(f);return"data:".concat(s,";base64,").concat(btoa(_.join("")))}function Tr(y){var s=new DataView(y),_;try{var f,A,S;if(s.getUint8(0)===255&&s.getUint8(1)===216)for(var x=s.byteLength,g=2;g+1<x;){if(s.getUint8(g)===255&&s.getUint8(g+1)===225){A=g;break}g+=1}if(A){var m=A+4,E=A+10;if(Rr(s,m,4)==="Exif"){var l=s.getUint16(E);if(f=l===18761,(f||l===19789)&&s.getUint16(E+2,f)===42){var e=s.getUint32(E+4,f);e>=8&&(S=E+e)}}}if(S){var t=s.getUint16(S,f),p,n;for(n=0;n<t;n+=1)if(p=S+n*12+2,s.getUint16(p,f)===274){p+=8,_=s.getUint16(p,f),s.setUint16(p,1,f);break}}}catch{_=1}return _}function Mr(y){var s=0,_=1,f=1;switch(y){case 2:_=-1;break;case 3:s=-180;break;case 4:f=-1;break;case 5:s=90,f=-1;break;case 6:s=90;break;case 7:s=90,_=-1;break;case 8:s=-90;break}return{rotate:s,scaleX:_,scaleY:f}}var Ir={render:function(){this.initContainer(),this.initCanvas(),this.initCropBox(),this.renderCanvas(),this.cropped&&this.renderCropBox()},initContainer:function(){var s=this.element,_=this.options,f=this.container,A=this.cropper,S=Number(_.minContainerWidth),x=Number(_.minContainerHeight);ne(A,le),ye(s,le);var g={width:Math.max(f.offsetWidth,S>=0?S:oi),height:Math.max(f.offsetHeight,x>=0?x:li)};this.containerData=g,Re(A,{width:g.width,height:g.height}),ne(s,le),ye(A,le)},initCanvas:function(){var s=this.containerData,_=this.imageData,f=this.options.viewMode,A=Math.abs(_.rotate)%180==90,S=A?_.naturalHeight:_.naturalWidth,x=A?_.naturalWidth:_.naturalHeight,g=S/x,m=s.width,E=s.height;s.height*g>s.width?f===3?m=s.height*g:E=s.width/g:f===3?E=s.width/g:m=s.height*g;var l={aspectRatio:g,naturalWidth:S,naturalHeight:x,width:m,height:E};this.canvasData=l,this.limited=f===1||f===2,this.limitCanvas(!0,!0),l.width=Math.min(Math.max(l.width,l.minWidth),l.maxWidth),l.height=Math.min(Math.max(l.height,l.minHeight),l.maxHeight),l.left=(s.width-l.width)/2,l.top=(s.height-l.height)/2,l.oldLeft=l.left,l.oldTop=l.top,this.initialCanvasData=ee({},l)},limitCanvas:function(s,_){var f=this.options,A=this.containerData,S=this.canvasData,x=this.cropBoxData,g=f.viewMode,m=S.aspectRatio,E=this.cropped&&x;if(s){var l=Number(f.minCanvasWidth)||0,e=Number(f.minCanvasHeight)||0;g>1?(l=Math.max(l,A.width),e=Math.max(e,A.height),g===3&&(e*m>l?l=e*m:e=l/m)):g>0&&(l?l=Math.max(l,E?x.width:0):e?e=Math.max(e,E?x.height:0):E&&(l=x.width,e=x.height,e*m>l?l=e*m:e=l/m));var t=Oe({aspectRatio:m,width:l,height:e});l=t.width,e=t.height,S.minWidth=l,S.minHeight=e,S.maxWidth=1/0,S.maxHeight=1/0}if(_)if(g>(E?0:1)){var p=A.width-S.width,n=A.height-S.height;S.minLeft=Math.min(0,p),S.minTop=Math.min(0,n),S.maxLeft=Math.max(0,p),S.maxTop=Math.max(0,n),E&&this.limited&&(S.minLeft=Math.min(x.left,x.left+(x.width-S.width)),S.minTop=Math.min(x.top,x.top+(x.height-S.height)),S.maxLeft=x.left,S.maxTop=x.top,g===2&&(S.width>=A.width&&(S.minLeft=Math.min(0,p),S.maxLeft=Math.max(0,p)),S.height>=A.height&&(S.minTop=Math.min(0,n),S.maxTop=Math.max(0,n))))}else S.minLeft=-S.width,S.minTop=-S.height,S.maxLeft=A.width,S.maxTop=A.height},renderCanvas:function(s,_){var f=this.canvasData,A=this.imageData;if(_){var S=Ar({width:A.naturalWidth*Math.abs(A.scaleX||1),height:A.naturalHeight*Math.abs(A.scaleY||1),degree:A.rotate||0}),x=S.width,g=S.height,m=f.width*(x/f.naturalWidth),E=f.height*(g/f.naturalHeight);f.left-=(m-f.width)/2,f.top-=(E-f.height)/2,f.width=m,f.height=E,f.aspectRatio=x/g,f.naturalWidth=x,f.naturalHeight=g,this.limitCanvas(!0,!1)}(f.width>f.maxWidth||f.width<f.minWidth)&&(f.left=f.oldLeft),(f.height>f.maxHeight||f.height<f.minHeight)&&(f.top=f.oldTop),f.width=Math.min(Math.max(f.width,f.minWidth),f.maxWidth),f.height=Math.min(Math.max(f.height,f.minHeight),f.maxHeight),this.limitCanvas(!1,!0),f.left=Math.min(Math.max(f.left,f.minLeft),f.maxLeft),f.top=Math.min(Math.max(f.top,f.minTop),f.maxTop),f.oldLeft=f.left,f.oldTop=f.top,Re(this.canvas,ee({width:f.width,height:f.height},Je({translateX:f.left,translateY:f.top}))),this.renderImage(s),this.cropped&&this.limited&&this.limitCropBox(!0,!0)},renderImage:function(s){var _=this.canvasData,f=this.imageData,A=f.naturalWidth*(_.width/_.naturalWidth),S=f.naturalHeight*(_.height/_.naturalHeight);ee(f,{width:A,height:S,left:(_.width-A)/2,top:(_.height-S)/2}),Re(this.image,ee({width:f.width,height:f.height},Je(ee({translateX:f.left,translateY:f.top},f)))),s&&this.output()},initCropBox:function(){var s=this.options,_=this.canvasData,f=s.aspectRatio||s.initialAspectRatio,A=Number(s.autoCropArea)||.8,S={width:_.width,height:_.height};f&&(_.height*f>_.width?S.height=S.width/f:S.width=S.height*f),this.cropBoxData=S,this.limitCropBox(!0,!0),S.width=Math.min(Math.max(S.width,S.minWidth),S.maxWidth),S.height=Math.min(Math.max(S.height,S.minHeight),S.maxHeight),S.width=Math.max(S.minWidth,S.width*A),S.height=Math.max(S.minHeight,S.height*A),S.left=_.left+(_.width-S.width)/2,S.top=_.top+(_.height-S.height)/2,S.oldLeft=S.left,S.oldTop=S.top,this.initialCropBoxData=ee({},S)},limitCropBox:function(s,_){var f=this.options,A=this.containerData,S=this.canvasData,x=this.cropBoxData,g=this.limited,m=f.aspectRatio;if(s){var E=Number(f.minCropBoxWidth)||0,l=Number(f.minCropBoxHeight)||0,e=g?Math.min(A.width,S.width,S.width+S.left,A.width-S.left):A.width,t=g?Math.min(A.height,S.height,S.height+S.top,A.height-S.top):A.height;E=Math.min(E,A.width),l=Math.min(l,A.height),m&&(E&&l?l*m>E?l=E/m:E=l*m:E?l=E/m:l&&(E=l*m),t*m>e?t=e/m:e=t*m),x.minWidth=Math.min(E,e),x.minHeight=Math.min(l,t),x.maxWidth=e,x.maxHeight=t}_&&(g?(x.minLeft=Math.max(0,S.left),x.minTop=Math.max(0,S.top),x.maxLeft=Math.min(A.width,S.left+S.width)-x.width,x.maxTop=Math.min(A.height,S.top+S.height)-x.height):(x.minLeft=0,x.minTop=0,x.maxLeft=A.width-x.width,x.maxTop=A.height-x.height))},renderCropBox:function(){var s=this.options,_=this.containerData,f=this.cropBoxData;(f.width>f.maxWidth||f.width<f.minWidth)&&(f.left=f.oldLeft),(f.height>f.maxHeight||f.height<f.minHeight)&&(f.top=f.oldTop),f.width=Math.min(Math.max(f.width,f.minWidth),f.maxWidth),f.height=Math.min(Math.max(f.height,f.minHeight),f.maxHeight),this.limitCropBox(!1,!0),f.left=Math.min(Math.max(f.left,f.minLeft),f.maxLeft),f.top=Math.min(Math.max(f.top,f.minTop),f.maxTop),f.oldLeft=f.left,f.oldTop=f.top,s.movable&&s.cropBoxMovable&&Ze(this.face,Qe,f.width>=_.width&&f.height>=_.height?Xt:mt),Re(this.cropBox,ee({width:f.width,height:f.height},Je({translateX:f.left,translateY:f.top}))),this.cropped&&this.limited&&this.limitCanvas(!0,!0),this.disabled||this.output()},output:function(){this.preview(),Ke(this.element,Et,this.getData())}},Pr={initPreview:function(){var s=this.element,_=this.crossOrigin,f=this.options.preview,A=_?this.crossOriginUrl:this.url,S=s.alt||"The image to preview",x=document.createElement("img");if(_&&(x.crossOrigin=_),x.src=A,x.alt=S,this.viewBox.appendChild(x),this.viewBoxImage=x,!!f){var g=f;typeof f=="string"?g=s.ownerDocument.querySelectorAll(f):f.querySelector&&(g=[f]),this.previews=g,te(g,function(m){var E=document.createElement("img");Ze(m,at,{width:m.offsetWidth,height:m.offsetHeight,html:m.innerHTML}),_&&(E.crossOrigin=_),E.src=A,E.alt=S,E.style.cssText='display:block;width:100%;height:auto;min-width:0!important;min-height:0!important;max-width:none!important;max-height:none!important;image-orientation:0deg!important;"',m.innerHTML="",m.appendChild(E)})}},resetPreview:function(){te(this.previews,function(s){var _=Rt(s,at);Re(s,{width:_.width,height:_.height}),s.innerHTML=_.html,yr(s,at)})},preview:function(){var s=this.imageData,_=this.canvasData,f=this.cropBoxData,A=f.width,S=f.height,x=s.width,g=s.height,m=f.left-_.left-s.left,E=f.top-_.top-s.top;!this.cropped||this.disabled||(Re(this.viewBoxImage,ee({width:x,height:g},Je(ee({translateX:-m,translateY:-E},s)))),te(this.previews,function(l){var e=Rt(l,at),t=e.width,p=e.height,n=t,d=p,c=1;A&&(c=t/A,d=S*c),S&&d>p&&(c=p/S,n=A*c,d=p),Re(l,{width:n,height:d}),Re(l.getElementsByTagName("img")[0],ee({width:x*c,height:g*c},Je(ee({translateX:-m*c,translateY:-E*c},s))))}))}},Br={bind:function(){var s=this.element,_=this.options,f=this.cropper;ue(_.cropstart)&&me(s,St,_.cropstart),ue(_.cropmove)&&me(s,bt,_.cropmove),ue(_.cropend)&&me(s,yt,_.cropend),ue(_.crop)&&me(s,Et,_.crop),ue(_.zoom)&&me(s,Lt,_.zoom),me(f,ei,this.onCropStart=this.cropStart.bind(this)),_.zoomable&&_.zoomOnWheel&&me(f,si,this.onWheel=this.wheel.bind(this),{passive:!1,capture:!0}),_.toggleDragModeOnDblclick&&me(f,qt,this.onDblclick=this.dblclick.bind(this)),me(s.ownerDocument,ti,this.onCropMove=this.cropMove.bind(this)),me(s.ownerDocument,ii,this.onCropEnd=this.cropEnd.bind(this)),_.responsive&&me(window,ni,this.onResize=this.resize.bind(this))},unbind:function(){var s=this.element,_=this.options,f=this.cropper;ue(_.cropstart)&&ve(s,St,_.cropstart),ue(_.cropmove)&&ve(s,bt,_.cropmove),ue(_.cropend)&&ve(s,yt,_.cropend),ue(_.crop)&&ve(s,Et,_.crop),ue(_.zoom)&&ve(s,Lt,_.zoom),ve(f,ei,this.onCropStart),_.zoomable&&_.zoomOnWheel&&ve(f,si,this.onWheel,{passive:!1,capture:!0}),_.toggleDragModeOnDblclick&&ve(f,qt,this.onDblclick),ve(s.ownerDocument,ti,this.onCropMove),ve(s.ownerDocument,ii,this.onCropEnd),_.responsive&&ve(window,ni,this.onResize)}},Fr={resize:function(){if(!this.disabled){var s=this.options,_=this.container,f=this.containerData,A=_.offsetWidth/f.width,S=_.offsetHeight/f.height,x=Math.abs(A-1)>Math.abs(S-1)?A:S;if(x!==1){var g,m;s.restore&&(g=this.getCanvasData(),m=this.getCropBoxData()),this.render(),s.restore&&(this.setCanvasData(te(g,function(E,l){g[l]=E*x})),this.setCropBoxData(te(m,function(E,l){m[l]=E*x})))}}},dblclick:function(){this.disabled||this.options.dragMode===Jt||this.setDragMode(xr(this.dragBox,vt)?Zt:xt)},wheel:function(s){var _=this,f=Number(this.options.wheelZoomRatio)||.1,A=1;this.disabled||(s.preventDefault(),!this.wheeling&&(this.wheeling=!0,setTimeout(function(){_.wheeling=!1},50),s.deltaY?A=s.deltaY>0?1:-1:s.wheelDelta?A=-s.wheelDelta/120:s.detail&&(A=s.detail>0?1:-1),this.zoom(-A*f,s)))},cropStart:function(s){var _=s.buttons,f=s.button;if(!(this.disabled||(s.type==="mousedown"||s.type==="pointerdown"&&s.pointerType==="mouse")&&(X(_)&&_!==1||X(f)&&f!==0||s.ctrlKey))){var A=this.options,S=this.pointers,x;s.changedTouches?te(s.changedTouches,function(g){S[g.identifier]=ot(g)}):S[s.pointerId||0]=ot(s),Object.keys(S).length>1&&A.zoomable&&A.zoomOnTouch?x=Yt:x=Rt(s.target,Qe),!!ur.test(x)&&Ke(this.element,St,{originalEvent:s,action:x})!==!1&&(s.preventDefault(),this.action=x,this.cropping=!1,x===Ht&&(this.cropping=!0,ne(this.dragBox,st)))}},cropMove:function(s){var _=this.action;if(!(this.disabled||!_)){var f=this.pointers;s.preventDefault(),Ke(this.element,bt,{originalEvent:s,action:_})!==!1&&(s.changedTouches?te(s.changedTouches,function(A){ee(f[A.identifier]||{},ot(A,!0))}):ee(f[s.pointerId||0]||{},ot(s,!0)),this.change(s))}},cropEnd:function(s){if(!this.disabled){var _=this.action,f=this.pointers;s.changedTouches?te(s.changedTouches,function(A){delete f[A.identifier]}):delete f[s.pointerId||0],!!_&&(s.preventDefault(),Object.keys(f).length||(this.action=""),this.cropping&&(this.cropping=!1,Ge(this.dragBox,st,this.cropped&&this.options.modal)),Ke(this.element,yt,{originalEvent:s,action:_}))}}},kr={change:function(s){var _=this.options,f=this.canvasData,A=this.containerData,S=this.cropBoxData,x=this.pointers,g=this.action,m=_.aspectRatio,E=S.left,l=S.top,e=S.width,t=S.height,p=E+e,n=l+t,d=0,c=0,a=A.width,r=A.height,h=!0,u;!m&&s.shiftKey&&(m=e&&t?e/t:1),this.limited&&(d=S.minLeft,c=S.minTop,a=d+Math.min(A.width,f.width,f.left+f.width),r=c+Math.min(A.height,f.height,f.top+f.height));var i=x[Object.keys(x)[0]],o={x:i.endX-i.startX,y:i.endY-i.startY},v=function(w){switch(w){case Ce:p+o.x>a&&(o.x=a-p);break;case Te:E+o.x<d&&(o.x=d-E);break;case we:l+o.y<c&&(o.y=c-l);break;case Ne:n+o.y>r&&(o.y=r-n);break}};switch(g){case mt:E+=o.x,l+=o.y;break;case Ce:if(o.x>=0&&(p>=a||m&&(l<=c||n>=r))){h=!1;break}v(Ce),e+=o.x,e<0&&(g=Te,e=-e,E-=e),m&&(t=e/m,l+=(S.height-t)/2);break;case we:if(o.y<=0&&(l<=c||m&&(E<=d||p>=a))){h=!1;break}v(we),t-=o.y,l+=o.y,t<0&&(g=Ne,t=-t,l-=t),m&&(e=t*m,E+=(S.width-e)/2);break;case Te:if(o.x<=0&&(E<=d||m&&(l<=c||n>=r))){h=!1;break}v(Te),e-=o.x,E+=o.x,e<0&&(g=Ce,e=-e,E-=e),m&&(t=e/m,l+=(S.height-t)/2);break;case Ne:if(o.y>=0&&(n>=r||m&&(E<=d||p>=a))){h=!1;break}v(Ne),t+=o.y,t<0&&(g=we,t=-t,l-=t),m&&(e=t*m,E+=(S.width-e)/2);break;case He:if(m){if(o.y<=0&&(l<=c||p>=a)){h=!1;break}v(we),t-=o.y,l+=o.y,e=t*m}else v(we),v(Ce),o.x>=0?p<a?e+=o.x:o.y<=0&&l<=c&&(h=!1):e+=o.x,o.y<=0?l>c&&(t-=o.y,l+=o.y):(t-=o.y,l+=o.y);e<0&&t<0?(g=$e,t=-t,e=-e,l-=t,E-=e):e<0?(g=Xe,e=-e,E-=e):t<0&&(g=Ye,t=-t,l-=t);break;case Xe:if(m){if(o.y<=0&&(l<=c||E<=d)){h=!1;break}v(we),t-=o.y,l+=o.y,e=t*m,E+=S.width-e}else v(we),v(Te),o.x<=0?E>d?(e-=o.x,E+=o.x):o.y<=0&&l<=c&&(h=!1):(e-=o.x,E+=o.x),o.y<=0?l>c&&(t-=o.y,l+=o.y):(t-=o.y,l+=o.y);e<0&&t<0?(g=Ye,t=-t,e=-e,l-=t,E-=e):e<0?(g=He,e=-e,E-=e):t<0&&(g=$e,t=-t,l-=t);break;case $e:if(m){if(o.x<=0&&(E<=d||n>=r)){h=!1;break}v(Te),e-=o.x,E+=o.x,t=e/m}else v(Ne),v(Te),o.x<=0?E>d?(e-=o.x,E+=o.x):o.y>=0&&n>=r&&(h=!1):(e-=o.x,E+=o.x),o.y>=0?n<r&&(t+=o.y):t+=o.y;e<0&&t<0?(g=He,t=-t,e=-e,l-=t,E-=e):e<0?(g=Ye,e=-e,E-=e):t<0&&(g=Xe,t=-t,l-=t);break;case Ye:if(m){if(o.x>=0&&(p>=a||n>=r)){h=!1;break}v(Ce),e+=o.x,t=e/m}else v(Ne),v(Ce),o.x>=0?p<a?e+=o.x:o.y>=0&&n>=r&&(h=!1):e+=o.x,o.y>=0?n<r&&(t+=o.y):t+=o.y;e<0&&t<0?(g=Xe,t=-t,e=-e,l-=t,E-=e):e<0?(g=$e,e=-e,E-=e):t<0&&(g=He,t=-t,l-=t);break;case Xt:this.move(o.x,o.y),h=!1;break;case Yt:this.zoom(Sr(x),s),h=!1;break;case Ht:if(!o.x||!o.y){h=!1;break}u=_i(this.cropper),E=i.startX-u.left,l=i.startY-u.top,e=S.minWidth,t=S.minHeight,o.x>0?g=o.y>0?Ye:He:o.x<0&&(E-=e,g=o.y>0?$e:Xe),o.y<0&&(l-=t),this.cropped||(ye(this.cropBox,le),this.cropped=!0,this.limited&&this.limitCropBox(!0,!0));break}h&&(S.width=e,S.height=t,S.left=E,S.top=l,this.action=g,this.renderCropBox()),te(x,function(b){b.startX=b.endX,b.startY=b.endY})}},Ur={crop:function(){return this.ready&&!this.cropped&&!this.disabled&&(this.cropped=!0,this.limitCropBox(!0,!0),this.options.modal&&ne(this.dragBox,st),ye(this.cropBox,le),this.setCropBoxData(this.initialCropBoxData)),this},reset:function(){return this.ready&&!this.disabled&&(this.imageData=ee({},this.initialImageData),this.canvasData=ee({},this.initialCanvasData),this.cropBoxData=ee({},this.initialCropBoxData),this.renderCanvas(),this.cropped&&this.renderCropBox()),this},clear:function(){return this.cropped&&!this.disabled&&(ee(this.cropBoxData,{left:0,top:0,width:0,height:0}),this.cropped=!1,this.renderCropBox(),this.limitCanvas(!0,!0),this.renderCanvas(),ye(this.dragBox,st),ne(this.cropBox,le)),this},replace:function(s){var _=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return!this.disabled&&s&&(this.isImg&&(this.element.src=s),_?(this.url=s,this.image.src=s,this.ready&&(this.viewBoxImage.src=s,te(this.previews,function(f){f.getElementsByTagName("img")[0].src=s}))):(this.isImg&&(this.replaced=!0),this.options.data=null,this.uncreate(),this.load(s))),this},enable:function(){return this.ready&&this.disabled&&(this.disabled=!1,ye(this.cropper,$t)),this},disable:function(){return this.ready&&!this.disabled&&(this.disabled=!0,ne(this.cropper,$t)),this},destroy:function(){var s=this.element;return s[q]?(s[q]=void 0,this.isImg&&this.replaced&&(s.src=this.originalUrl),this.uncreate(),this):this},move:function(s){var _=arguments.length>1&&arguments[1]!==void 0?arguments[1]:s,f=this.canvasData,A=f.left,S=f.top;return this.moveTo(At(s)?s:A+Number(s),At(_)?_:S+Number(_))},moveTo:function(s){var _=arguments.length>1&&arguments[1]!==void 0?arguments[1]:s,f=this.canvasData,A=!1;return s=Number(s),_=Number(_),this.ready&&!this.disabled&&this.options.movable&&(X(s)&&(f.left=s,A=!0),X(_)&&(f.top=_,A=!0),A&&this.renderCanvas(!0)),this},zoom:function(s,_){var f=this.canvasData;return s=Number(s),s<0?s=1/(1-s):s=1+s,this.zoomTo(f.width*s/f.naturalWidth,null,_)},zoomTo:function(s,_,f){var A=this.options,S=this.canvasData,x=S.width,g=S.height,m=S.naturalWidth,E=S.naturalHeight;if(s=Number(s),s>=0&&this.ready&&!this.disabled&&A.zoomable){var l=m*s,e=E*s;if(Ke(this.element,Lt,{ratio:s,oldRatio:x/m,originalEvent:f})===!1)return this;if(f){var t=this.pointers,p=_i(this.cropper),n=t&&Object.keys(t).length?Lr(t):{pageX:f.pageX,pageY:f.pageY};S.left-=(l-x)*((n.pageX-p.left-S.left)/x),S.top-=(e-g)*((n.pageY-p.top-S.top)/g)}else We(_)&&X(_.x)&&X(_.y)?(S.left-=(l-x)*((_.x-S.left)/x),S.top-=(e-g)*((_.y-S.top)/g)):(S.left-=(l-x)/2,S.top-=(e-g)/2);S.width=l,S.height=e,this.renderCanvas(!0)}return this},rotate:function(s){return this.rotateTo((this.imageData.rotate||0)+Number(s))},rotateTo:function(s){return s=Number(s),X(s)&&this.ready&&!this.disabled&&this.options.rotatable&&(this.imageData.rotate=s%360,this.renderCanvas(!0,!0)),this},scaleX:function(s){var _=this.imageData.scaleY;return this.scale(s,X(_)?_:1)},scaleY:function(s){var _=this.imageData.scaleX;return this.scale(X(_)?_:1,s)},scale:function(s){var _=arguments.length>1&&arguments[1]!==void 0?arguments[1]:s,f=this.imageData,A=!1;return s=Number(s),_=Number(_),this.ready&&!this.disabled&&this.options.scalable&&(X(s)&&(f.scaleX=s,A=!0),X(_)&&(f.scaleY=_,A=!0),A&&this.renderCanvas(!0,!0)),this},getData:function(){var s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,_=this.options,f=this.imageData,A=this.canvasData,S=this.cropBoxData,x;if(this.ready&&this.cropped){x={x:S.left-A.left,y:S.top-A.top,width:S.width,height:S.height};var g=f.width/f.naturalWidth;if(te(x,function(l,e){x[e]=l/g}),s){var m=Math.round(x.y+x.height),E=Math.round(x.x+x.width);x.x=Math.round(x.x),x.y=Math.round(x.y),x.width=E-x.x,x.height=m-x.y}}else x={x:0,y:0,width:0,height:0};return _.rotatable&&(x.rotate=f.rotate||0),_.scalable&&(x.scaleX=f.scaleX||1,x.scaleY=f.scaleY||1),x},setData:function(s){var _=this.options,f=this.imageData,A=this.canvasData,S={};if(this.ready&&!this.disabled&&We(s)){var x=!1;_.rotatable&&X(s.rotate)&&s.rotate!==f.rotate&&(f.rotate=s.rotate,x=!0),_.scalable&&(X(s.scaleX)&&s.scaleX!==f.scaleX&&(f.scaleX=s.scaleX,x=!0),X(s.scaleY)&&s.scaleY!==f.scaleY&&(f.scaleY=s.scaleY,x=!0)),x&&this.renderCanvas(!0,!0);var g=f.width/f.naturalWidth;X(s.x)&&(S.left=s.x*g+A.left),X(s.y)&&(S.top=s.y*g+A.top),X(s.width)&&(S.width=s.width*g),X(s.height)&&(S.height=s.height*g),this.setCropBoxData(S)}return this},getContainerData:function(){return this.ready?ee({},this.containerData):{}},getImageData:function(){return this.sized?ee({},this.imageData):{}},getCanvasData:function(){var s=this.canvasData,_={};return this.ready&&te(["left","top","width","height","naturalWidth","naturalHeight"],function(f){_[f]=s[f]}),_},setCanvasData:function(s){var _=this.canvasData,f=_.aspectRatio;return this.ready&&!this.disabled&&We(s)&&(X(s.left)&&(_.left=s.left),X(s.top)&&(_.top=s.top),X(s.width)?(_.width=s.width,_.height=s.width/f):X(s.height)&&(_.height=s.height,_.width=s.height*f),this.renderCanvas(!0)),this},getCropBoxData:function(){var s=this.cropBoxData,_;return this.ready&&this.cropped&&(_={left:s.left,top:s.top,width:s.width,height:s.height}),_||{}},setCropBoxData:function(s){var _=this.cropBoxData,f=this.options.aspectRatio,A,S;return this.ready&&this.cropped&&!this.disabled&&We(s)&&(X(s.left)&&(_.left=s.left),X(s.top)&&(_.top=s.top),X(s.width)&&s.width!==_.width&&(A=!0,_.width=s.width),X(s.height)&&s.height!==_.height&&(S=!0,_.height=s.height),f&&(A?_.height=_.width/f:S&&(_.width=_.height*f)),this.renderCropBox()),this},getCroppedCanvas:function(){var s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!this.ready||!window.HTMLCanvasElement)return null;var _=this.canvasData,f=wr(this.image,this.imageData,_,s);if(!this.cropped)return f;var A=this.getData(),S=A.x,x=A.y,g=A.width,m=A.height,E=f.width/Math.floor(_.naturalWidth);E!==1&&(S*=E,x*=E,g*=E,m*=E);var l=g/m,e=Oe({aspectRatio:l,width:s.maxWidth||1/0,height:s.maxHeight||1/0}),t=Oe({aspectRatio:l,width:s.minWidth||0,height:s.minHeight||0},"cover"),p=Oe({aspectRatio:l,width:s.width||(E!==1?f.width:g),height:s.height||(E!==1?f.height:m)}),n=p.width,d=p.height;n=Math.min(e.width,Math.max(t.width,n)),d=Math.min(e.height,Math.max(t.height,d));var c=document.createElement("canvas"),a=c.getContext("2d");c.width=Ve(n),c.height=Ve(d),a.fillStyle=s.fillColor||"transparent",a.fillRect(0,0,n,d);var r=s.imageSmoothingEnabled,h=r===void 0?!0:r,u=s.imageSmoothingQuality;a.imageSmoothingEnabled=h,u&&(a.imageSmoothingQuality=u);var i=f.width,o=f.height,v=S,b=x,w,D,O,L,R,C;v<=-g||v>i?(v=0,w=0,O=0,R=0):v<=0?(O=-v,v=0,w=Math.min(i,g+v),R=w):v<=i&&(O=0,w=Math.min(g,i-v),R=w),w<=0||b<=-m||b>o?(b=0,D=0,L=0,C=0):b<=0?(L=-b,b=0,D=Math.min(o,m+b),C=D):b<=o&&(L=0,D=Math.min(m,o-b),C=D);var I=[v,b,w,D];if(R>0&&C>0){var M=n/g;I.push(O*M,L*M,R*M,C*M)}return a.drawImage.apply(a,[f].concat(zt(I.map(function(k){return Math.floor(Ve(k))})))),c},setAspectRatio:function(s){var _=this.options;return!this.disabled&&!At(s)&&(_.aspectRatio=Math.max(0,s)||NaN,this.ready&&(this.initCropBox(),this.cropped&&this.renderCropBox())),this},setDragMode:function(s){var _=this.options,f=this.dragBox,A=this.face;if(this.ready&&!this.disabled){var S=s===xt,x=_.movable&&s===Zt;s=S||x?s:Jt,_.dragMode=s,Ze(f,Qe,s),Ge(f,vt,S),Ge(f,gt,x),_.cropBoxMovable||(Ze(A,Qe,s),Ge(A,vt,S),Ge(A,gt,x))}return this}},jr=Ee.Cropper,gi=function(){function y(s){var _=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(Ji(this,y),!s||!fr.test(s.tagName))throw new Error("The first argument is required and must be an <img> or <canvas> element.");this.element=s,this.options=ee({},ui,We(_)&&_),this.cropped=!1,this.disabled=!1,this.pointers={},this.ready=!1,this.reloading=!1,this.replaced=!1,this.sized=!1,this.sizing=!1,this.init()}return qi(y,[{key:"init",value:function(){var _=this.element,f=_.tagName.toLowerCase(),A;if(!_[q]){if(_[q]=this,f==="img"){if(this.isImg=!0,A=_.getAttribute("src")||"",this.originalUrl=A,!A)return;A=_.src}else f==="canvas"&&window.HTMLCanvasElement&&(A=_.toDataURL());this.load(A)}}},{key:"load",value:function(_){var f=this;if(!!_){this.url=_,this.imageData={};var A=this.element,S=this.options;if(!S.rotatable&&!S.scalable&&(S.checkOrientation=!1),!S.checkOrientation||!window.ArrayBuffer){this.clone();return}if(hr.test(_)){dr.test(_)?this.read(Dr(_)):this.clone();return}var x=new XMLHttpRequest,g=this.clone.bind(this);this.reloading=!0,this.xhr=x,x.onabort=g,x.onerror=g,x.ontimeout=g,x.onprogress=function(){x.getResponseHeader("content-type")!==ai&&x.abort()},x.onload=function(){f.read(x.response)},x.onloadend=function(){f.reloading=!1,f.xhr=null},S.checkCrossOrigin&&pi(_)&&A.crossOrigin&&(_=mi(_)),x.open("GET",_,!0),x.responseType="arraybuffer",x.withCredentials=A.crossOrigin==="use-credentials",x.send()}}},{key:"read",value:function(_){var f=this.options,A=this.imageData,S=Tr(_),x=0,g=1,m=1;if(S>1){this.url=Cr(_,ai);var E=Mr(S);x=E.rotate,g=E.scaleX,m=E.scaleY}f.rotatable&&(A.rotate=x),f.scalable&&(A.scaleX=g,A.scaleY=m),this.clone()}},{key:"clone",value:function(){var _=this.element,f=this.url,A=_.crossOrigin,S=f;this.options.checkCrossOrigin&&pi(f)&&(A||(A="anonymous"),S=mi(f)),this.crossOrigin=A,this.crossOriginUrl=S;var x=document.createElement("img");A&&(x.crossOrigin=A),x.src=S||f,x.alt=_.alt||"The image to crop",this.image=x,x.onload=this.start.bind(this),x.onerror=this.stop.bind(this),ne(x,Qt),_.parentNode.insertBefore(x,_.nextSibling)}},{key:"start",value:function(){var _=this,f=this.image;f.onload=null,f.onerror=null,this.sizing=!0;var A=Ee.navigator&&/(?:iPad|iPhone|iPod).*?AppleWebKit/i.test(Ee.navigator.userAgent),S=function(E,l){ee(_.imageData,{naturalWidth:E,naturalHeight:l,aspectRatio:E/l}),_.initialImageData=ee({},_.imageData),_.sizing=!1,_.sized=!0,_.build()};if(f.naturalWidth&&!A){S(f.naturalWidth,f.naturalHeight);return}var x=document.createElement("img"),g=document.body||document.documentElement;this.sizingImage=x,x.onload=function(){S(x.width,x.height),A||g.removeChild(x)},x.src=f.src,A||(x.style.cssText="left:0;max-height:none!important;max-width:none!important;min-height:0!important;min-width:0!important;opacity:0;position:absolute;top:0;z-index:-1;",g.appendChild(x))}},{key:"stop",value:function(){var _=this.image;_.onload=null,_.onerror=null,_.parentNode.removeChild(_),this.image=null}},{key:"build",value:function(){if(!(!this.sized||this.ready)){var _=this.element,f=this.options,A=this.image,S=_.parentNode,x=document.createElement("div");x.innerHTML=cr;var g=x.querySelector(".".concat(q,"-container")),m=g.querySelector(".".concat(q,"-canvas")),E=g.querySelector(".".concat(q,"-drag-box")),l=g.querySelector(".".concat(q,"-crop-box")),e=l.querySelector(".".concat(q,"-face"));this.container=S,this.cropper=g,this.canvas=m,this.dragBox=E,this.cropBox=l,this.viewBox=g.querySelector(".".concat(q,"-view-box")),this.face=e,m.appendChild(A),ne(_,le),S.insertBefore(g,_.nextSibling),this.isImg||ye(A,Qt),this.initPreview(),this.bind(),f.initialAspectRatio=Math.max(0,f.initialAspectRatio)||NaN,f.aspectRatio=Math.max(0,f.aspectRatio)||NaN,f.viewMode=Math.max(0,Math.min(3,Math.round(f.viewMode)))||0,ne(l,le),f.guides||ne(l.getElementsByClassName("".concat(q,"-dashed")),le),f.center||ne(l.getElementsByClassName("".concat(q,"-center")),le),f.background&&ne(g,"".concat(q,"-bg")),f.highlight||ne(e,sr),f.cropBoxMovable&&(ne(e,gt),Ze(e,Qe,mt)),f.cropBoxResizable||(ne(l.getElementsByClassName("".concat(q,"-line")),le),ne(l.getElementsByClassName("".concat(q,"-point")),le)),this.render(),this.ready=!0,this.setDragMode(f.dragMode),f.autoCrop&&this.crop(),this.setData(f.data),ue(f.ready)&&me(_,ri,f.ready,{once:!0}),Ke(_,ri)}}},{key:"unbuild",value:function(){!this.ready||(this.ready=!1,this.unbind(),this.resetPreview(),this.cropper.parentNode.removeChild(this.cropper),ye(this.element,le))}},{key:"uncreate",value:function(){this.ready?(this.unbuild(),this.ready=!1,this.cropped=!1):this.sizing?(this.sizingImage.onload=null,this.sizing=!1,this.sized=!1):this.reloading?(this.xhr.onabort=null,this.xhr.abort()):this.image&&this.stop()}}],[{key:"noConflict",value:function(){return window.Cropper=jr,y}},{key:"setDefaults",value:function(_){ee(ui,We(_)&&_)}}]),y}();ee(gi.prototype,Ir,Pr,Br,Fr,kr,Ur);const xi=y=>(Mt("data-v-2a78477e"),y=y(),It(),y),Nr={class:"modal-dialog"},Wr={class:"modal-content"},Vr={class:"modal-header"},Gr=xi(()=>P("div",{class:"modal-title"},"\u4E0A\u4F20\u4F60\u7684\u5934\u50CF",-1)),Kr=xi(()=>P("span",{"aria-hidden":"true"},"\xD7",-1)),zr=[Kr],Hr={class:"modal-body d-flex flex-column justify-content-center"},Xr={class:"custom-file"},Yr={class:"custom-file-label",for:"customFileLangHTML","data-browse":"\u9009\u62E9"},$r={class:"image-container mt-2"},Qr={class:"modal-footer"},Zr=ke({emits:["cancelEvent"],setup(y,{emit:s}){const _=ie("\u5BFC\u5165\u56FE\u7247\u4EE5\u8FDB\u884C\u7F16\u8F91\u3002"),f=Ae("errorModal"),A=Ae("userStore"),S=ie();ie(),ie(270),ie(480);const x=ie();let g;const m=ie();let E,l;function e(d){tt(()=>{E.drawImage(l,d.detail.x,d.detail.y,d.detail.width,d.detail.height,0,0,64,64)})}const t=ie(!1);function p(){if(S.value.files.length==0){t.value=!1;return}t.value=!0,_.value=S.value.files[0].name;var d=new FileReader;d.onload=c=>{x.value.src=c.target.result,l=new Image,l.style.display="none",l.src=c.target.result,m.value.appendChild(l),g!=null&&(g.destroy(),g=null),tt(()=>{g=new gi(x.value,{viewMode:1,dragMode:"none",initialAspectRatio:1,aspectRatio:1,preview:".before",background:!1,autoCropArea:.6,zoomOnWheel:!0,crop:e}),E=m.value.getContext("2d")})},d.readAsDataURL(S.value.files[0])}function n(){g!==void 0&&g.getCroppedCanvas({imageSmoothingQuality:"high"}).toBlob(d=>{var c=d.type.split("/");new Ut().updateUserImage(0,c[1],{data:d,fileName:S.value.files[0].name}).catch(()=>{f.value.show()}).then(()=>{A.update()})})}return Ct(()=>{tt(()=>{})}),(d,c)=>(ae(),pe("div",Nr,[P("div",Wr,[P("div",Vr,[Gr,P("button",{type:"button",class:"close",onClick:c[0]||(c[0]=a=>d.$emit("cancelEvent"))},zr)]),P("div",Hr,[P("div",Xr,[P("input",{type:"file",class:"custom-file-input",id:"customFileLangHTML",accept:"image/*",ref:(a,r)=>{r.fileInputElement=a,S.value=a},onChange:p},null,544),P("label",Yr,Ue(_.value),1)]),P("div",$r,[P("img",{ref:(a,r)=>{r.srcImgElement=a,x.value=a},class:"image"},null,512)]),t.value?(ae(),pe("canvas",{key:0,class:"rounded-circle mt-3",width:"64",height:"64",ref:(a,r)=>{r.imgDemo=a,m.value=a},style:{width:"64px",height:"64px"}},null,512)):Dt("",!0)]),P("div",Qr,[P("button",{type:"button",class:"btn btn-primary",onClick:n}," \u4E0A\u4F20 "),P("button",{type:"button",class:"btn btn-secondary",onClick:c[1]||(c[1]=a=>d.$emit("cancelEvent"))}," \u53D6\u6D88 ")])])]))}});var Jr=jt(Zr,[["__scopeId","data-v-2a78477e"]]);const Ie=y=>(Mt("data-v-78a76e02"),y=y(),It(),y),qr={class:"px-4 py-3"},en={class:"d-flex flex-column justify-content-center"},tn={class:"d-flex align-self-center rounded-circle overflow-hidden bg-dark",style:{height:"4em",width:"4em"}},rn=["src"],nn={class:"position-absolute",style:{height:"4em",width:"4em","z-index":"2","background-color":"transparent"}},sn={class:"w-100 h-100 rounded-circle d-flex flex-column justify-content-end image-box small text-center"},an=Ie(()=>P("button",{type:"button",class:"btn text-light btn-sm","data-toggle":"modal","data-target":"#imageUploadModal"}," \u7F16\u8F91 ",-1)),on={class:"modal fade",tabindex:"-1","aria-hidden":"true",id:"imageUploadModal"},ln={class:"align-self-center"},un={class:"table table-borderless table-sm mt-3"},hn=Ie(()=>P("td",{align:"right"},"id:",-1)),dn=Ie(()=>P("td",{align:"right"},"email:",-1)),fn=Ie(()=>P("div",{class:"dropdown-divider"},null,-1)),cn=Ie(()=>P("button",{class:"btn dropdown-item text-center","data-toggle":"modal","data-target":"#logoutConfirmModal"}," \u767B\u51FA ",-1)),_n={class:"modal fade",tabindex:"-1","aria-hidden":"true",id:"logoutConfirmModal"},pn={class:"modal-dialog"},mn={class:"modal-content"},vn={class:"modal-header"},gn=Ie(()=>P("span",{"aria-hidden":"true"},"\xD7",-1)),xn=[gn],En=Ie(()=>P("div",{class:"modal-body"},"\u9000\u51FA\u767B\u5F55\u5C06\u65E0\u6CD5\u4EAB\u53D7\u67D0\u4E9B\u529F\u80FD\uFF0C\u786E\u5B9A\u9000\u51FA\uFF1F",-1)),yn={class:"modal-footer"},bn=ke({setup(y){let s=Ae("userStore");function _(){Ft("#imageUploadModal").modal("hide")}function f(S){Ft("#logoutConfirmModal").modal(S)}function A(){f("hide"),s.logout()}return(S,x)=>(ae(),pe("div",null,[P("div",qr,[P("div",en,[P("div",tn,[P("img",{alt:"",class:"align-self-center img-fluid",style:{width:"4em",height:"4em"},src:je(s).image!=null?je(s).image:"./src/assets/user.png"},null,8,rn),P("div",nn,[P("div",sn,[an,(ae(),it(Bt,{to:"body"},[P("div",on,[Pt(Jr,{onCancelEvent:_})])]))])])]),P("span",ln,Ue(je(s).name),1),P("table",un,[P("tbody",null,[P("tr",null,[hn,P("td",null,Ue(je(s).id),1)]),P("tr",null,[dn,P("td",null,Ue(je(s).email),1)])])])])]),fn,cn,(ae(),it(Bt,{to:"body"},[P("div",_n,[P("div",pn,[P("div",mn,[P("div",vn,[P("button",{type:"button",class:"close",onClick:x[0]||(x[0]=g=>f("hide"))},xn)]),En,P("div",yn,[P("button",{type:"button",class:"btn btn-secondary",onClick:x[1]||(x[1]=g=>f("hide"))}," \u53D6\u6D88 "),P("button",{type:"button",class:"btn btn-primary",onClick:A}," \u786E\u5B9A ")])])])])]))]))}});var Sn=jt(bn,[["__scopeId","data-v-78a76e02"]]);const Ln=kt('<div class="h5">\u5F00\u59CB\u4F60\u7684Live</div><div class="dropdown-divider mt-4 mb-3"></div><div class="text-secondary mb-2">\u4ECE\u4E13\u5C5E\u4E8E Link TV \u7684\u63A8\u6D41\u5668\u5F00\u59CB\u3002</div><button class="btn btn-primary btn-sm">\u4E0B\u8F7DLinkme</button><div class="my-2"><br></div><div class="text-secondary">\u4ECE\u5176\u4ED6\u63A8\u6D41\u8F6F\u4EF6\uFF0C\u5982OBS\u5F00\u59CB\u3002</div>',6),An={key:0,class:"text-danger"},wn={key:1},Rn=P("div",{class:"text-secondary mb-2"},"\u590D\u5236\u4EE5\u4E0B\u63A8\u6D41\u5730\u5740\u5230\u63A8\u6D41\u8F6F\u4EF6:",-1),On={class:"input-group"},Dn=P("div",{class:"small text-secondary"},"\u8BE5\u5730\u5740\u4EC524\u5C0F\u65F6\u5185\u6709\u6548\u3002",-1),Cn=ke({setup(y){const s=Ae("userStore"),_=ie(""),f=Ae("errorModal");ht(()=>s.logined,()=>{s.logined?new Di().pushAddress(0).catch(()=>{f.value.show()}).then(g=>{_.value=g}):_.value=""});const A=ie(null);function S(){A.value.select(),document.execCommand("Copy"),console.log("\u590D\u5236\u6210\u529F")}return(x,g)=>(ae(),pe(Ri,null,[Ln,_.value==""?(ae(),pe("div",An,"\u767B\u5F55\u4EE5\u83B7\u53D6\u63A8\u6D41\u5730\u5740")):(ae(),pe("div",wn,[Rn,P("div",On,[dt(P("input",{type:"text",readonly:"true","onUpdate:modelValue":g[0]||(g[0]=m=>_.value=m),class:"form-control",ref:(m,E)=>{E.pushUrlElement=m,A.value=m}},null,512),[[ft,_.value]]),P("span",{class:"input-group-append"},[P("button",{type:"button",class:"btn btn-outline-secondary btn-sm",onClick:S}," \u590D\u5236 ")])]),Dn]))],64))}}),Tn={class:"navbar navbar-expand-sm navbar-light"},Mn=P("a",{class:"navbar-brand",href:"javascript:;"},[P("strong",null,"Link TV")],-1),In=P("button",{class:"navbar-toggler",type:"button","data-toggle":"collapse","data-target":"#navbarToggle","aria-controls":"navbarToggle","aria-expanded":"false","aria-label":"Toggle navigation"},[P("span",{class:"navbar-toggler-icon"})],-1),Pn={id:"navbarToggle",class:"collapse navbar-collapse"},Bn=kt('<ul class="navbar-nav mr-auto"><li class="nav-item"><form class="form-inline"><input class="form-control"><button class="btn">\u67E5\u627E</button></form></li></ul>',1),Fn=P("button",{type:"button",class:"btn"},[P("svg",{t:"1634997811697",class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"6372",width:"1.5em",height:"1.5em"},[P("path",{d:"M511.73808594 93.19941406c-140.67070313 0-264.92695313 69.1453125-341.01035156 175.08955078v-70.47597656c0-21.66767578-17.61679688-39.22998047-39.346875-39.22998047s-39.346875 17.56318359-39.346875 39.22998047v156.91992188c0 21.66240234 17.61679688 39.22998047 39.346875 39.22998047h170.50341796c21.73007813 0 39.346875-17.56669922 39.346875-39.22998047 0-21.66767578-17.61679688-39.22998047-39.346875-39.22998047h-68.4421875c61.73085937-86.98798828 163.28496094-143.84267578 278.296875-143.84267578 188.32851562 0 341.00507812 152.22128906 341.00507813 339.99345703 0 187.76865234-152.6765625 339.99345703-341.00507813 339.99345703-158.73574219 0-291.74589844-108.29179688-329.75771484-254.70439453l-0.68291016 0.21269531c-5.3015625-15.41162109-19.54248047-26.65986328-36.8024414-26.65986328-21.73007813 0-39.346875 17.56318359-39.346875 39.22558594 0 3.86630859 1.16367187 7.36875 2.20605469 10.89316406l-0.40957032 0.12919922c0.25839844 0.95009766 0.73212891 1.8 0.99580078 2.74482422 0.28916016 0.76201172 0.48164063 1.52314453 0.81650391 2.2640625 49.92539062 175.47011719 210.98935547 304.35380859 402.98378906 304.35380859 231.79394531 0 419.69970703-187.35029297 419.69970703-418.45341797-0.00175781-231.10751953-187.90839844-418.45429688-419.70322265-418.45429687z m0 176.53183594c-21.73007813 0-39.346875 17.56318359-39.346875 39.22998047v235.37988281c0 21.66767578 17.61679688 39.22998047 39.346875 39.22998047h170.50253906c21.73007813 0 39.346875-17.56318359 39.346875-39.22558594 0-21.67119141-17.61679688-39.22998047-39.346875-39.22998047H551.08496094v-196.15429687c0-21.66767578-17.61767578-39.22998047-39.34775391-39.22998047z","p-id":"6373"})])],-1),kn={class:"dropdown"},Un=P("button",{type:"button",class:"btn",role:"button","data-toggle":"dropdown","aria-expanded":"false"},[P("svg",{t:"1634997536655",class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"4087",width:"1.5em",height:"1.5em"},[P("path",{d:"M800 330.9V256c0-35.3-28.7-64-64-64H64c-35.3 0-64 28.7-64 64v512c0 35.3 28.7 64 64 64h672c35.3 0 64-28.7 64-64v-74.9c0-11.6 11.9-19.3 22.5-14.6L934 728c42.3 18.8 90-12.2 90-58.5v-315c0-46.3-47.7-77.3-90-58.5l-111.5 49.6c-10.6 4.7-22.5-3.1-22.5-14.7zM720 768H80c-8.8 0-16-7.2-16-16V272c0-8.8 7.2-16 16-16h640c8.8 0 16 7.2 16 16v480c0 8.8-7.2 16-16 16z m217.5-108.5l-128-56.9c-5.8-2.6-9.5-8.3-9.5-14.6V436c0-6.3 3.7-12.1 9.5-14.6l128-56.9c10.6-4.7 22.5 3 22.5 14.6v265.8c0 11.6-11.9 19.3-22.5 14.6z","p-id":"4088"}),P("path",{d:"M332.4 445.4L447.9 512l-115.4 66.6V445.4m-16-75.8c-25.1 0-48.1 20-48.1 48.1v188.7c0 28 23 48.1 48.1 48.1 8 0 16.2-2 23.9-6.5l163.4-94.4c32-18.5 32-64.7 0-83.1l-163.4-94.4c-7.7-4.5-15.9-6.5-23.9-6.5z","p-id":"4089"})])],-1),jn={class:"dropdown-menu dropdown-menu-right p-4",style:{"min-width":"20em"}},Nn={class:"dropdown"},Wn=P("button",{class:"btn",id:"userDropdown",role:"button","data-toggle":"dropdown","aria-expanded":"false"},[P("svg",{t:"1634873118556",class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"2728",width:"1.5em",height:"1.5em"},[P("path",{d:"M500 128.8c-95.2 5.6-173.6 83.2-180 178.4-7.2 112 80.8 205.6 191.2 205.6 106.4 0 192-86.4 192-192 0.8-110.4-92-198.4-203.2-192zM512 575.2c-128 0-383.2 64-383.2 192v96c0 17.6 14.4 32 32 32h702.4c17.6 0 32-14.4 32-32V766.4c0-127.2-255.2-191.2-383.2-191.2z","p-id":"2729"})])],-1),Vn={class:"dropdown-menu dropdown-menu-right"},Gn=P("div",null,null,-1),Xn=ke({setup(y){const s=Ae("userStore");return(_,f)=>(ae(),pe("nav",Tn,[Mn,In,P("div",Pn,[Bn,Fn,P("div",kn,[Un,P("div",jn,[Pt(Cn)])]),P("div",Nn,[Wn,P("div",Vn,[je(s).logined?(ae(),it(Sn,{key:1})):(ae(),it(Zi,{key:0}))])])]),Gn]))}});export{Hn as _,Xn as a};
